tests\test_ui_theme_fonts.py:27: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_pick_font_family_prefers_first_available(monkeypatch) -> None...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_theme_fonts.py:32: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_pick_font_family_falls_back_when_none_available(monkeypatch) ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_ui_theme_fonts.py:37: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_public_font_resolvers_use_candidates(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_typecheck_strict_gate.py:5: error: Function is missing a return type
annotation  [no-untyped-def]
    def _load_typecheck_strict_gate_module():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_typecheck_gate.py:5: error: Function is missing a return type
annotation  [no-untyped-def]
    def _load_typecheck_gate_module():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_typecheck_gate.py:42: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_main_accepts_existing_empty_baseline(tmp_path: Path, monkeypa...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_typecheck_gate.py:58: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_run_mypy_batches_and_aggregates(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_typecheck_gate.py:64: error: Function is missing a type annotation 
[no-untyped-def]
        def _fake_once(targets, _flags):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_typecheck_gate.py:85: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_run_mypy_stops_on_fatal_batch_error(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_typecheck_gate.py:91: error: Function is missing a type annotation 
[no-untyped-def]
        def _fake_once(targets, _flags):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_release_preflight.py:5: error: Function is missing a return type
annotation  [no-untyped-def]
    def _load_release_preflight_module():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_release_preflight.py:15: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_release_preflight_default_includes_lint_and_pytest(monkeypatc...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_release_preflight.py:19: error: Function is missing a return type
annotation  [no-untyped-def]
        def fake_run_step(name: str, cmd: list[str]):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_release_preflight.py:49: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_release_preflight_allow_test_warnings(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_release_preflight.py:53: error: Function is missing a return type
annotation  [no-untyped-def]
        def fake_run_step(name: str, cmd: list[str]):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_release_preflight.py:86: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_release_preflight_returns_failure_when_any_step_fails(monkeyp...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_release_preflight.py:89: error: Function is missing a return type
annotation  [no-untyped-def]
        def fake_run_step(name: str, cmd: list[str]):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_release_preflight.py:118: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_release_preflight_includes_policy_gates_when_typecheck_enable...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_release_preflight.py:122: error: Function is missing a return type
annotation  [no-untyped-def]
        def fake_run_step(name: str, cmd: list[str]):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_release_preflight.py:169: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_release_preflight_quick_profile_skips_slow_steps(monkeypatch)...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_release_preflight.py:173: error: Function is missing a return type
annotation  [no-untyped-def]
        def fake_run_step(name: str, cmd: list[str]):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_module_size_gate.py:5: error: Function is missing a return type
annotation  [no-untyped-def]
    def _load_module_size_gate_module():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ha_dr_drill.py:5: error: Function is missing a return type
annotation  [no-untyped-def]
    def _load_ha_dr_module():
    ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_exception_policy_gate.py:5: error: Function is missing a return type
annotation  [no-untyped-def]
    def _load_exception_policy_gate_module():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learn_workers.py:6: error: Function is missing a return type
annotation  [no-untyped-def]
    def _load_auto_learn_workers_module():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learn_workers.py:23: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_targeted_worker_passes_requested_interval(monkeypatch) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learn_workers.py:33: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def add_callback(self, cb) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learn_workers.py:36: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def start_targeted(self, **kwargs) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learn_workers.py:39: error: Statement is unreachable 
[unreachable]
                    self._cb(
                    ^~~~~~~~~
tests\test_auto_learn_workers.py:71: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(captured["prediction_horizon"]) == 40
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learn_workers.py:71: note: Possible overload variants:
tests\test_auto_learn_workers.py:71: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_auto_learn_workers.py:71: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_auto_learn_workers.py:75: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_auto_worker_passes_requested_interval(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learn_workers.py:85: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def add_callback(self, cb) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learn_workers.py:88: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def start(self, **kwargs) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learn_workers.py:91: error: Statement is unreachable 
[unreachable]
                    self._cb(
                    ^~~~~~~~~
tests\test_auto_learn_workers.py:123: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(captured["prediction_horizon"]) == 25
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learn_workers.py:123: note: Possible overload variants:
tests\test_auto_learn_workers.py:123: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_auto_learn_workers.py:123: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
utils\lazy_imports.py:52: error: Returning Any from function declared to return
"T"  [no-any-return]
            return self._import()(*args, **kwargs)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\lazy_imports.py:81: error: Returning Any from function declared to return
"Callable[..., T]"  [no-any-return]
            return getattr(self._module, self._attr_name)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\lazy_imports.py:108: error: Need type annotation for "lazy" 
[var-annotated]
            lazy = CachedLazyImport(module, name, ttl=ttl)
                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\lazy_imports.py:110: error: Incompatible types in assignment (expression
has type "LazyImport[Never]", variable has type "CachedLazyImport[Any]") 
[assignment]
            lazy = LazyImport(module, name)
                   ^~~~~~~~~~~~~~~~~~~~~~~~
utils\serialization.py:56: error: Statement is unreachable  [unreachable]
            return [f"Expected dict, got {type(data).__name__}"]
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\serialization.py:92: error: Argument 1 to "time" has incompatible type
"*list[int]"; expected "tzinfo | None"  [arg-type]
                    setattr(dc_instance, key, time(*parts))
                                                    ^~~~~
config\settings_utils.py:44: error: Statement is unreachable  [unreachable]
            return [f"Expected dict, got {type(data).__name__}"]
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
config\settings_utils.py:77: error: Argument 1 to "time" has incompatible type
"*list[int]"; expected "tzinfo | None"  [arg-type]
                    setattr(dc_instance, key, time(*parts))
                                                    ^~~~~
utils\cancellation.py:152: error: Function is missing a return type annotation 
[no-untyped-def]
    def cancellable_operation(token: CancellationToken | None = None):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\logger.py:28: error: Statement is unreachable  [unreachable]
                return _colorama_available
                ^~~~~~~~~~~~~~~~~~~~~~~~~~
utils\debug.py:114: error: "Stats" has no attribute "stats"  [attr-defined]
    ...               for func_key, stats_tuple in list(stats.stats.items())[...
                                                        ^~~~~~~~~~~
utils\debug.py:135: error: "Stats" has no attribute "stats"  [attr-defined]
    ...              for _func_key, stats_tuple in list(stats.stats.items())[...
                                                        ^~~~~~~~~~~
utils\debug.py:163: error: Function is missing a return type annotation 
[no-untyped-def]
    def profile_context(
    ^~~~~~~~~~~~~~~~~~~~
utils\debug.py:249: error: Function is missing a return type annotation 
[no-untyped-def]
    def memory_tracker(label: str = "block"):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\debug.py:314: error: Function is missing a return type annotation 
[no-untyped-def]
    def trace_execution(
    ^~~~~~~~~~~~~~~~~~~~
utils\debug.py:336: error: "Logger" has no attribute "FileHandler" 
[attr-defined]
            handler = log.FileHandler(log_file)
                      ^~~~~~~~~~~~~~~
utils\debug.py:337: error: "Logger" has no attribute "getLogger" 
[attr-defined]
            log.getLogger().addHandler(handler)
            ^~~~~~~~~~~~~
utils\debug.py:347: error: "Logger" has no attribute "getLogger" 
[attr-defined]
                for handler in log.getLogger().handlers[:]:
                               ^~~~~~~~~~~~~
utils\debug.py:348: error: "Logger" has no attribute "FileHandler" 
[attr-defined]
                    if isinstance(handler, log.FileHandler):
                                           ^~~~~~~~~~~~~~~
utils\debug.py:350: error: "Logger" has no attribute "getLogger" 
[attr-defined]
                        log.getLogger().removeHandler(handler)
                        ^~~~~~~~~~~~~
trading\circuit_breaker.py:104: error: Incompatible default for argument
"config" (default has type "None", argument has type "CircuitBreakerConfig") 
[assignment]
        def __init__(self, config: CircuitBreakerConfig = None) -> None:
                                                          ^~~~
trading\circuit_breaker.py:104: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:104: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:155: error: Incompatible default for argument
"daily_pnl_pct" (default has type "None", argument has type "float") 
[assignment]
            daily_pnl_pct: float = None,
                                   ^~~~
trading\circuit_breaker.py:155: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:155: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:156: error: Incompatible default for argument
"weekly_pnl_pct" (default has type "None", argument has type "float") 
[assignment]
            weekly_pnl_pct: float = None,
                                    ^~~~
trading\circuit_breaker.py:156: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:156: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:157: error: Incompatible default for argument
"monthly_pnl_pct" (default has type "None", argument has type "float") 
[assignment]
            monthly_pnl_pct: float = None,
                                     ^~~~
trading\circuit_breaker.py:157: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:157: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:158: error: Incompatible default for argument
"drawdown_pct" (default has type "None", argument has type "float") 
[assignment]
            drawdown_pct: float = None,
                                  ^~~~
trading\circuit_breaker.py:158: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:158: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:159: error: Incompatible default for argument
"volatility" (default has type "None", argument has type "float")  [assignment]
            volatility: float = None,
                                ^~~~
trading\circuit_breaker.py:159: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:159: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:160: error: Incompatible default for argument
"var_95" (default has type "None", argument has type "float")  [assignment]
            var_95: float = None,
                            ^~~~
trading\circuit_breaker.py:160: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:160: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:161: error: Incompatible default for argument
"data_latency_ms" (default has type "None", argument has type "float") 
[assignment]
            data_latency_ms: float = None,
                                     ^~~~
trading\circuit_breaker.py:161: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:161: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:162: error: Incompatible default for argument
"total_exposure_pct" (default has type "None", argument has type "float") 
[assignment]
            total_exposure_pct: float = None,
                                        ^~~~
trading\circuit_breaker.py:162: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:162: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:163: error: Incompatible default for argument
"largest_position_pct" (default has type "None", argument has type "float") 
[assignment]
            largest_position_pct: float = None,
                                          ^~~~
trading\circuit_breaker.py:163: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:163: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:379: error: Statement is unreachable  [unreachable]
                new_state = TradingState.HALTED
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\circuit_breaker.py:433: error: Incompatible default for argument
"since" (default has type "None", argument has type "datetime")  [assignment]
            since: datetime = None,
                              ^~~~
trading\circuit_breaker.py:433: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:433: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\circuit_breaker.py:627: error: Incompatible default for argument
"config" (default has type "None", argument has type "ComplianceConfig") 
[assignment]
        def __init__(self, config: ComplianceConfig = None) -> None:
                                                      ^~~~
trading\circuit_breaker.py:627: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\circuit_breaker.py:627: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
core\events.py:132: error: Cannot determine type of "_initialized"  [has-type]
                        cls._instance._initialized = False
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~
core\events.py:136: error: Cannot determine type of "_initialized"  [has-type]
            if self._initialized:
               ^~~~~~~~~~~~~~~~~
tests\test_replay.py:6: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def test_replay_csv_load_and_order(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\china_diagnostics.py:31: error: Incompatible types in assignment
(expression has type "None", variable has type "dict[str, Any]")  [assignment]
        details: dict[str, Any] = None
                                  ^~~~
utils\china_diagnostics.py:35: error: Statement is unreachable  [unreachable]
                self.details = {}
                ^~~~~~~~~~~~~~~~~
core\china_network.py:182: error: Cannot determine type of "_initialized" 
[has-type]
                        cls._instance._initialized = False
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~
core\china_network.py:186: error: Cannot determine type of "_initialized" 
[has-type]
            if self._initialized:
               ^~~~~~~~~~~~~~~~~
core\china_network.py:324: error: Incompatible types in assignment (expression
has type "dict[str, EndpointQuality]", variable has type "list[str]") 
[assignment]
                endpoints = self._endpoint_quality[provider]
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
core\china_network.py:326: error: "list[str]" has no attribute "items" 
[attr-defined]
                    (url, q) for url, q in endpoints.items()
                                           ^~~~~~~~~~~~~~~
core\china_network.py:337: error: Returning Any from function declared to
return "str"  [no-any-return]
                return available[0][0]
                ^~~~~~~~~~~~~~~~~~~~~~
core\china_network.py:380: error: Argument "key" to "sort" of "list" has
incompatible type "Callable[[dict[str, object]], object]"; expected
"Callable[[dict[str, object]], SupportsDunderLT[Any] | SupportsDunderGT[Any]]" 
[arg-type]
                    endpoints_data.sort(key=lambda x: x["quality_score"], ...
                                            ^
core\china_network.py:380: error: Incompatible return value type (got "object",
expected "SupportsDunderLT[Any] | SupportsDunderGT[Any]")  [return-value]
    ...               endpoints_data.sort(key=lambda x: x["quality_score"], r...
                                                        ^~~~~~~~~~~~~~~~~~
core\china_network.py:486: error: Unsupported target for indexed assignment
("object")  [index]
                    status["providers"][provider] = {
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
core\china_network.py:592: error: Function is missing a return type annotation 
[no-untyped-def]
    def china_optimized(provider: str):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_network_detector.py:23: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_network_detector_get_env_uses_fresh_cache(monkeypatch) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_network_detector.py:42: error: Function is missing a return type
annotation  [no-untyped-def]
            def _fake_detect():
            ^~~~~~~~~~~~~~~~~~~
tests\test_network_detector.py:57: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_network_detector_force_refresh_bypasses_cache(monkeypatch) ->...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_network_detector.py:76: error: Function is missing a return type
annotation  [no-untyped-def]
            def _fake_detect():
            ^~~~~~~~~~~~~~~~~~~
tests\test_network_detector.py:106: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_network_detector_detect_does_not_depend_on_requests_session(m...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_network_detector.py:123: error: Function is missing a type
annotation  [no-untyped-def]
            def _fake_get(url, timeout=0, headers=None):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\helpers.py:11: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def to_float(x, default: float = 0.0) -> float:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\helpers.py:27: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def to_int(x, default: int = 0) -> int:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\helpers.py:183: error: Unsupported operand types for - ("Sequence[float]"
and "float")  [operator]
        excess = returns - rf_per_period
                 ^
utils\helpers.py:183: note: Left operand is of type "ndarray[Any, Any] | Sequence[float]"
utils\helpers.py:212: error: Unsupported operand types for >= ("int" and
"Sequence[float]")  [operator]
        if np.any(equity <= 0):
                  ^
utils\helpers.py:212: note: Left operand is of type "ndarray[Any, Any] | Sequence[float]"
ui\charts.py:34: error: Need type annotation for "data" (hint:
"data: list[<type>] = ...")  [var-annotated]
                self.data = []
                ^~~~~~~~~
ui\charts.py:37: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
            def setData(self, data) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:112: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
            def paint(self, p, *args) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:117: error: Statement is unreachable  [unreachable]
                    p.drawPicture(0, 0, self._picture)
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:119: error: Function is missing a return type annotation 
[no-untyped-def]
            def boundingRect(self):
            ^~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:142: error: Incompatible types in assignment (expression has type
"None", variable has type "type[CandlestickItem]")  [assignment]
        CandlestickItem = None
                          ^~~~
ui\charts.py:157: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def __init__(self, parent=None) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:205: error: Function is missing a type annotation 
[no-untyped-def]
        def _coerce_list(values):
        ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:240: error: Statement is unreachable  [unreachable]
                return ""
                ^~~~~~~~~
ui\charts.py:282: error: Returning Any from function declared to return "str" 
[no-any-return]
                    return ts_obj.strftime("%Y-%m-%d")
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:283: error: Returning Any from function declared to return "str" 
[no-any-return]
                return ts_obj.strftime("%Y-%m-%d %H:%M")
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:289: error: Argument 1 to "float" has incompatible type "object";
expected "str | Buffer | SupportsFloat | SupportsIndex"  [arg-type]
                v = float(value)
                          ^~~~~
ui\charts.py:299: error: Argument 1 to "float" has incompatible type "object";
expected "str | Buffer | SupportsFloat | SupportsIndex"  [arg-type]
                v = float(value)
                          ^~~~~
ui\charts.py:346: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def _on_plot_mouse_moved(self, evt) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:349: error: Statement is unreachable  [unreachable]
            if not self._candle_meta:
            ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:418: error: "None" has no attribute "setLabel"  [attr-defined]
            self.plot_widget.setLabel(
            ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:424: error: "None" has no attribute "setLabel"  [attr-defined]
            self.plot_widget.setLabel(
            ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:430: error: "None" has no attribute "showGrid"  [attr-defined]
            self.plot_widget.showGrid(x=True, y=True, alpha=0.15)
            ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:431: error: "None" has no attribute "setBackground" 
[attr-defined]
            self.plot_widget.setBackground(ModernColors.BG_PRIMARY)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:432: error: "None" has no attribute "setContextMenuPolicy" 
[attr-defined]
            self.plot_widget.setContextMenuPolicy(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:435: error: "None" has no attribute "customContextMenuRequested" 
[attr-defined]
            self.plot_widget.customContextMenuRequested.connect(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:440: error: "None" has no attribute "plot"  [attr-defined]
            self.predicted_line = self.plot_widget.plot(
                                  ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:448: error: "None" has no attribute "plot"  [attr-defined]
            self.predicted_low_line = self.plot_widget.plot(
                                      ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:456: error: "None" has no attribute "plot"  [attr-defined]
            self.predicted_high_line = self.plot_widget.plot(
                                       ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:466: error: "None" has no attribute "plot"  [attr-defined]
            self.actual_line = self.plot_widget.plot(
                               ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:472: error: Incompatible types in assignment (expression has type
"CandlestickItem", variable has type "None")  [assignment]
            self.candles = CandlestickItem()
                           ^~~~~~~~~~~~~~~~~
ui\charts.py:473: error: "None" has no attribute "addItem"  [attr-defined]
            self.plot_widget.addItem(self.candles)
            ^~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:477: error: "None" has no attribute "plot"  [attr-defined]
                "sma20": self.plot_widget.plot(
                         ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:481: error: "None" has no attribute "plot"  [attr-defined]
                "sma50": self.plot_widget.plot(
                         ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:485: error: "None" has no attribute "plot"  [attr-defined]
                "sma200": self.plot_widget.plot(
                          ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:493: error: "None" has no attribute "plot"  [attr-defined]
                "ema21": self.plot_widget.plot(
                         ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:497: error: "None" has no attribute "plot"  [attr-defined]
                "ema55": self.plot_widget.plot(
                         ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:501: error: "None" has no attribute "plot"  [attr-defined]
                "bb_upper": self.plot_widget.plot(
                            ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:505: error: "None" has no attribute "plot"  [attr-defined]
                "bb_lower": self.plot_widget.plot(
                            ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:509: error: "None" has no attribute "plot"  [attr-defined]
                "vwap20": self.plot_widget.plot(
                          ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:519: error: "None" has no attribute "addLegend"  [attr-defined]
            self.plot_widget.addLegend()
            ^~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:522: error: "None" has no attribute "scene"  [attr-defined]
                    self.plot_widget.scene().sigMouseMoved,
                    ^~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:530: error: Item "None" of "QLayout | None" has no attribute
"addWidget"  [union-attr]
            self.layout().addWidget(self.plot_widget)
            ^~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:551: error: Item "None" of "QLayout | None" has no attribute
"addWidget"  [union-attr]
            self.layout().addWidget(self.fallback_label)
            ^~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:560: error: Incompatible default for argument "predicted_prices"
(default has type "None", argument has type "list[float]")  [assignment]
            predicted_prices: list[float] = None,
                                            ^~~~
ui\charts.py:560: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:560: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:561: error: Incompatible default for argument
"predicted_prices_low" (default has type "None", argument has type
"list[float]")  [assignment]
            predicted_prices_low: list[float] = None,
                                                ^~~~
ui\charts.py:561: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:561: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:562: error: Incompatible default for argument
"predicted_prices_high" (default has type "None", argument has type
"list[float]")  [assignment]
            predicted_prices_high: list[float] = None,
                                                 ^~~~
ui\charts.py:562: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:562: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:563: error: Incompatible default for argument "levels" (default
has type "None", argument has type "dict[str, float]")  [assignment]
            levels: dict[str, float] = None,
                                       ^~~~
ui\charts.py:563: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:563: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:617: error: Statement is unreachable  [unreachable]
                            continue
                            ^~~~~~~~
ui\charts.py:801: error: Statement is unreachable  [unreachable]
                    self.candles.setData(ohlc)
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:805: error: Statement is unreachable  [unreachable]
                    x_actual = np.arange(len(closes))
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:811: error: Statement is unreachable  [unreachable]
                    if closes and self._predicted_prices:
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:975: error: Right operand of "and" is never evaluated 
[unreachable]
                if self.plot_widget is not None and not self._manual_zoom:
                                                    ^~~~~~~~~~~~~~~~~~~~~
ui\charts.py:976: error: Statement is unreachable  [unreachable]
                    n_candles = len(closes)
                    ^~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1015: error: Incompatible default for argument "predicted_prices"
(default has type "None", argument has type "list[float]")  [assignment]
            predicted_prices: list[float] = None,
                                            ^~~~
ui\charts.py:1015: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:1015: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:1016: error: Incompatible default for argument
"predicted_prices_low" (default has type "None", argument has type
"list[float]")  [assignment]
            predicted_prices_low: list[float] = None,
                                                ^~~~
ui\charts.py:1016: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:1016: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:1017: error: Incompatible default for argument
"predicted_prices_high" (default has type "None", argument has type
"list[float]")  [assignment]
            predicted_prices_high: list[float] = None,
                                                 ^~~~
ui\charts.py:1017: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:1017: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:1018: error: Incompatible default for argument "levels" (default
has type "None", argument has type "dict[str, float]")  [assignment]
            levels: dict[str, float] = None,
                                       ^~~~
ui\charts.py:1018: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:1018: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:1036: error: Incompatible default for argument "predicted_prices"
(default has type "None", argument has type "list[float]")  [assignment]
            predicted_prices: list[float] = None,
                                            ^~~~
ui\charts.py:1036: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:1036: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:1037: error: Incompatible default for argument
"predicted_prices_low" (default has type "None", argument has type
"list[float]")  [assignment]
            predicted_prices_low: list[float] = None,
                                                ^~~~
ui\charts.py:1037: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:1037: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:1038: error: Incompatible default for argument
"predicted_prices_high" (default has type "None", argument has type
"list[float]")  [assignment]
            predicted_prices_high: list[float] = None,
                                                 ^~~~
ui\charts.py:1038: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:1038: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:1039: error: Incompatible default for argument "levels" (default
has type "None", argument has type "dict[str, float]")  [assignment]
            levels: dict[str, float] = None
                                       ^~~~
ui\charts.py:1039: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\charts.py:1039: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\charts.py:1077: error: Statement is unreachable  [unreachable]
                    self.candles.setData([])
                    ^~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1079: error: Statement is unreachable  [unreachable]
                    self.actual_line.clear()
                    ^~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1081: error: Statement is unreachable  [unreachable]
                    self.predicted_line.clear()
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1083: error: Statement is unreachable  [unreachable]
                    self.predicted_low_line.clear()
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1085: error: Statement is unreachable  [unreachable]
                    self.predicted_high_line.clear()
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1088: error: "object" has no attribute "clear"  [attr-defined]
                        line.clear()
                        ^~~~~~~~~~
ui\charts.py:1118: error: "object" has no attribute "clear"  [attr-defined]
                line.clear()
                ^~~~~~~~~~
ui\charts.py:1121: error: "object" has no attribute "clear"  [attr-defined]
                line.clear()
                ^~~~~~~~~~
ui\charts.py:1126: error: "object" has no attribute "clear"  [attr-defined]
                line.clear()
                ^~~~~~~~~~
ui\charts.py:1128: error: "object" has no attribute "setData"  [attr-defined]
            line.setData(x[mask], y[mask])
            ^~~~~~~~~~~~
ui\charts.py:1165: error: Incompatible types in assignment (expression has type
"ndarray[tuple[int, ...], dtype[Any]]", variable has type "float")  [assignment]
                v = np.array(vols[:n], dtype=float)
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1169: error: Value of type "float" is not indexable  [index]
                        vv = v[i - 19:i + 1]
                             ^~~~~~~~~~~~~~~
ui\charts.py:1177: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def _on_context_menu(self, pos) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1180: error: Statement is unreachable  [unreachable]
            if not self._actual_prices:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1258: error: Statement is unreachable  [unreachable]
            for line in self.level_lines.values():
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1313: error: Statement is unreachable  [unreachable]
            try:
            ^~~~
ui\charts.py:1324: error: Statement is unreachable  [unreachable]
            try:
            ^~~~
ui\charts.py:1335: error: Statement is unreachable  [unreachable]
            try:
            ^~~~
ui\charts.py:1375: error: Statement is unreachable  [unreachable]
                try:
                ^~~~
ui\charts.py:1413: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def __init__(self, parent=None) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\charts.py:1446: error: Statement is unreachable  [unreachable]
                self._prices = []
                ^~~~~~~~~~~~~~~~~
trading\production_health.py:290: error: Incompatible default for argument
"hosts" (default has type "None", argument has type "list[str]")  [assignment]
        hosts: list[str] = None,
                           ^~~~
trading\production_health.py:290: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\production_health.py:290: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\production_health.py:297: error: Statement is unreachable 
[unreachable]
            hosts = [
            ^~~~~~~~~
trading\production_health.py:339: error: Incompatible default for argument
"data_sources" (default has type "None", argument has type "list[str]") 
[assignment]
        data_sources: list[str] = None,
                                  ^~~~
trading\production_health.py:339: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\production_health.py:339: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\production_health.py:348: error: Statement is unreachable 
[unreachable]
            data_sources = ["tencent", "akshare", "sina"]
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\production_health.py:374: error: Incompatible default for argument
"model_dir" (default has type "None", argument has type "str")  [assignment]
        model_dir: str = None,
                         ^~~~
trading\production_health.py:374: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\production_health.py:374: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\production_health.py:381: error: Statement is unreachable 
[unreachable]
            model_dir = "models_saved"
            ^~~~~~~~~~~~~~~~~~~~~~~~~~
trading\production_health.py:461: error: Incompatible default for argument
"db_paths" (default has type "None", argument has type "list[str]") 
[assignment]
        db_paths: list[str] = None,
                              ^~~~
trading\production_health.py:461: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\production_health.py:461: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\production_health.py:467: error: Statement is unreachable 
[unreachable]
            db_paths = ["data_storage/orders.db", "data_storage/cache.db"]
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\production_health.py:559: error: Incompatible default for argument
"broker_endpoint" (default has type "None", argument has type "str") 
[assignment]
        broker_endpoint: str = None,
                               ^~~~
trading\production_health.py:559: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\production_health.py:559: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\production_health.py:567: error: Statement is unreachable 
[unreachable]
            return HealthCheckResult(
            ^~~~~~~~~~~~~~~~~~~~~~~~~
trading\production_health.py:576: error: Incompatible types in assignment
(expression has type "int", variable has type "str")  [assignment]
            port = int(port)
                   ^~~~~~~~~
trading\production_health.py:632: error: Incompatible default for argument
"required_checks" (default has type "None", argument has type "list[str]") 
[assignment]
            required_checks: list[str] = None,
                                         ^~~~
trading\production_health.py:632: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\production_health.py:632: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\execution_risk.py:223: error: Incompatible default for argument
"max_participation" (default has type "None", argument has type "float") 
[assignment]
            max_participation: float = None,
                                       ^~~~
trading\execution_risk.py:223: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\execution_risk.py:223: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\execution_risk.py:237: error: Statement is unreachable  [unreachable]
                max_participation = self.max_participation_rate
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\execution_risk.py:256: error: Unexpected keyword argument
"parent_order_id" for "Order"  [call-arg]
                child = Order(
                        ^~~~~~
trading\execution_risk.py:312: error: Argument "order_id" to "ExecutionReport"
has incompatible type "str"; expected "int"  [arg-type]
                order_id=order.id,
                         ^~~~~~~~
trading\execution_risk.py:344: error: Incompatible default for argument
"symbol" (default has type "None", argument has type "str")  [assignment]
            symbol: str = None,
                          ^~~~
trading\execution_risk.py:344: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\execution_risk.py:344: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\execution_risk.py:345: error: Incompatible default for argument "since"
(default has type "None", argument has type "datetime")  [assignment]
            since: datetime = None,
                              ^~~~
trading\execution_risk.py:345: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\execution_risk.py:345: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\execution_risk.py:364: error: Need type annotation for "quality_counts"
(hint: "quality_counts: dict[<type>, <type>] = ...")  [var-annotated]
            quality_counts = {}
            ^~~~~~~~~~~~~~
trading\execution_risk.py:383: error: Incompatible default for argument
"latency_ms" (default has type "None", argument has type "float")  [assignment]
            latency_ms: float = None,
                                ^~~~
trading\execution_risk.py:383: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\execution_risk.py:383: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\execution_risk.py:511: error: Incompatible default for argument
"config" (default has type "None", argument has type "ExecutionConfig") 
[assignment]
    ...ate_execution_pipeline(config: ExecutionConfig = None) -> tuple[SmartO...
                                                        ^~~~
trading\execution_risk.py:511: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\execution_risk.py:511: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\execution_risk.py:514: error: Statement is unreachable  [unreachable]
            config = ExecutionConfig()
            ^~~~~~~~~~~~~~~~~~~~~~~~~~
strategies\trend_following.py:25: error: Statement is unreachable 
[unreachable]
                return None
                ^~~~~~~~~~~
strategies\mean_reversion.py:43: error: Statement is unreachable  [unreachable]
                return None
                ^~~~~~~~~~~
models\regime_detection.py:233: error: Returning Any from function declared to
return "float"  [no-any-return]
            return np.clip(trend * 10, -1.0, 1.0)  # Scale to -1 to 1
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\regime_detection.py:246: error: Returning Any from function declared to
return "float"  [no-any-return]
            return annualized_vol
            ^~~~~~~~~~~~~~~~~~~~~
models\regime_detection.py:259: error: Returning Any from function declared to
return "float"  [no-any-return]
            return np.clip(roc * 5, -1.0, 1.0)  # Scale to -1 to 1
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\regime_detection.py:274: error: Returning Any from function declared to
return "float"  [no-any-return]
            return np.clip(trend * 2, -1.0, 1.0)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\regime_detection.py:289: error: Returning Any from function declared to
return "float"  [no-any-return]
            return 0.5 * stress_from_moves + 0.5 * stress_from_vol
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\regime_detection.py:344: error: Incompatible default for argument
"since" (default has type "None", argument has type "datetime")  [assignment]
            since: datetime = None,
                              ^~~~
models\regime_detection.py:344: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\regime_detection.py:344: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\regime_detection.py:517: error: Incompatible default for argument
"symbol" (default has type "None", argument has type "str")  [assignment]
        def trigger_black_swan_retrain(self, symbol: str = None) -> None:
                                                           ^~~~
models\regime_detection.py:517: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\regime_detection.py:517: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\regime_detection.py:534: error: Incompatible default for argument
"model_id" (default has type "None", argument has type "str")  [assignment]
    ... def get_model_performance(self, model_id: str = None, symbol: str = N...
                                                        ^~~~
models\regime_detection.py:534: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\regime_detection.py:534: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\regime_detection.py:534: error: Incompatible default for argument
"symbol" (default has type "None", argument has type "str")  [assignment]
    ...l_performance(self, model_id: str = None, symbol: str = None) -> dict:
                                                               ^~~~
models\explainability.py:245: error: Returning Any from function declared to
return "ndarray[Any, Any]"  [no-any-return]
                return self.model.predict_proba(X)
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\explainability.py:246: error: Returning Any from function declared to
return "ndarray[Any, Any]"  [no-any-return]
            return self.model.predict(X)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\confidence_calibration.py:168: error: Invalid index type "float" for
"dict[str, float]"; expected type "str"  [index]
                    self._calibration_map[midpoint] = bucket.empirical_acc...
                                          ^~~~~~~~
models\confidence_calibration.py:170: error: Incompatible default for argument
"symbol" (default has type "None", argument has type "str")  [assignment]
    ...f calibrate(self, raw_confidence: float, symbol: str = None) -> float:
                                                              ^~~~
models\confidence_calibration.py:170: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\confidence_calibration.py:170: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\confidence_calibration.py:192: error: Unsupported operand types for <=
("float" and "str")  [operator]
                if raw_confidence <= sorted_points[0]:
                                     ^~~~~~~~~~~~~~~~
models\confidence_calibration.py:194: error: Unsupported operand types for >=
("float" and "str")  [operator]
                if raw_confidence >= sorted_points[-1]:
                                     ^~~~~~~~~~~~~~~~~
models\confidence_calibration.py:201: error: Unsupported operand types for <=
("str" and "float")  [operator]
                    if low <= raw_confidence < high:
                              ^~~~~~~~~~~~~~
models\confidence_calibration.py:201: error: Unsupported operand types for <
("float" and "str")  [operator]
                    if low <= raw_confidence < high:
                                               ^~~~
models\confidence_calibration.py:203: error: Unsupported operand types for -
("float" and "str")  [operator]
                        t = (raw_confidence - low) / (high - low)
                                              ^~~
models\confidence_calibration.py:203: error: Unsupported left operand type for
- ("str")  [operator]
                        t = (raw_confidence - low) / (high - low)
                                                      ^~~~~~~~~~
models\confidence_calibration.py:206: error: Returning Any from function
declared to return "float"  [no-any-return]
                        return cal_low + t * (cal_high - cal_low)
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\confidence_calibration.py:281: error: Argument 1 to "append" of "list"
has incompatible type "floating[Any]"; expected "float"  [arg-type]
                    self._ensemble_disagreements.append(disagreement)
                                                        ^~~~~~~~~~~~
models\confidence_calibration.py:295: error: Argument 1 to "append" of "list"
has incompatible type "floating[Any]"; expected "float"  [arg-type]
                        self._historical_errors[symbol].append(error)
                                                               ^~~~~
models\confidence_calibration.py:306: error: Incompatible default for argument
"regime" (default has type "None", argument has type "str")  [assignment]
            regime: str = None,
                          ^~~~
models\confidence_calibration.py:306: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\confidence_calibration.py:306: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\confidence_calibration.py:331: error: Incompatible types in assignment
(expression has type "float", variable has type "floating[Any]")  [assignment]
                    disagreement_pct = 1.0
                                       ^~~
models\confidence_calibration.py:337: error: Incompatible types in assignment
(expression has type "floating[Any]", variable has type "float")  [assignment]
                    historical_error = np.percentile(errors, self.confiden...
                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\confidence_calibration.py:350: error: Unsupported operand types for *
("SupportsDunderLT[Any]" and "float")  [operator]
                uncertainty *= regime_multiplier
                ^
models\confidence_calibration.py:350: error: Unsupported operand types for *
("SupportsDunderGT[Any]" and "float")  [operator]
                uncertainty *= regime_multiplier
                ^
models\confidence_calibration.py:350: note: Left operand is of type "SupportsDunderLT[Any] | SupportsDunderGT[Any]"
models\confidence_calibration.py:463: error: Incompatible default for argument
"symbol" (default has type "None", argument has type "str")  [assignment]
            symbol: str = None,
                          ^~~~
models\confidence_calibration.py:463: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\confidence_calibration.py:463: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\confidence_calibration.py:464: error: Incompatible default for argument
"regime" (default has type "None", argument has type "str")  [assignment]
            regime: str = None,
                          ^~~~
models\confidence_calibration.py:464: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\confidence_calibration.py:464: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\confidence_calibration.py:465: error: Incompatible default for argument
"uncertainty" (default has type "None", argument has type "float")  [assignment]
            uncertainty: float = None,
                                 ^~~~
models\confidence_calibration.py:465: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\confidence_calibration.py:465: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\confidence_calibration.py:489: error: Returning Any from function
declared to return "float"  [no-any-return]
                return threshold
                ^~~~~~~~~~~~~~~~
models\confidence_calibration.py:494: error: Incompatible default for argument
"symbol" (default has type "None", argument has type "str")  [assignment]
            symbol: str = None,
                          ^~~~
models\confidence_calibration.py:494: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\confidence_calibration.py:494: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\confidence_calibration.py:495: error: Incompatible default for argument
"regime" (default has type "None", argument has type "str")  [assignment]
            regime: str = None,
                          ^~~~
models\confidence_calibration.py:495: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\confidence_calibration.py:495: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\confidence_calibration.py:496: error: Incompatible default for argument
"uncertainty" (default has type "None", argument has type "float")  [assignment]
            uncertainty: float = None,
                                 ^~~~
models\confidence_calibration.py:496: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\confidence_calibration.py:496: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\confidence_calibration.py:520: error: Incompatible default for argument
"calibrator" (default has type "None", argument has type "ConfidenceCalibrator")
 [assignment]
        calibrator: ConfidenceCalibrator = None,
                                           ^~~~
models\confidence_calibration.py:520: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\confidence_calibration.py:520: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\confidence_calibration.py:521: error: Incompatible default for argument
"uncertainty_estimator" (default has type "None", argument has type
"UncertaintyEstimator")  [assignment]
        uncertainty_estimator: UncertaintyEstimator = None,
                                                      ^~~~
models\confidence_calibration.py:521: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\confidence_calibration.py:521: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\confidence_calibration.py:558: error: Incompatible types in assignment
(expression has type "float", variable has type "floating[Any]")  [assignment]
            disagreement = 0.0
                           ^~~
models\confidence_calibration.py:577: error: Argument "ensemble_disagreement"
to "CalibratedPrediction" has incompatible type "floating[Any]"; expected
"float"  [arg-type]
            ensemble_disagreement=disagreement,
                                  ^~~~~~~~~~~~
models\confidence_calibration.py:579: error: Argument "is_reliable" to
"CalibratedPrediction" has incompatible type
"Literal[False] | numpy.bool[builtins.bool]"; expected "builtins.bool" 
[arg-type]
            is_reliable=is_reliable,
                        ^~~~~~~~~~~
data\quality_monitor.py:124: error: Incompatible default for argument
"fetch_timestamp" (default has type "None", argument has type "datetime") 
[assignment]
            fetch_timestamp: datetime = None,
                                        ^~~~
data\quality_monitor.py:124: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\quality_monitor.py:124: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\quality_monitor.py:141: error: Statement is unreachable  [unreachable]
                fetch_timestamp = datetime.now()
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\quality_monitor.py:258: error: Incompatible default for argument
"max_age_seconds" (default has type "None", argument has type "float") 
[assignment]
    ..._data_fresh(self, symbol: str, max_age_seconds: float = None) -> bool:
                                                               ^~~~
data\quality_monitor.py:258: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\quality_monitor.py:258: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\quality_monitor.py:261: error: Statement is unreachable  [unreachable]
                max_age_seconds = self.stale_threshold
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\quality_monitor.py:274: error: Incompatible default for argument "symbol"
(default has type "None", argument has type "str")  [assignment]
            symbol: str = None,
                          ^~~~
data\quality_monitor.py:274: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\quality_monitor.py:274: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\quality_monitor.py:275: error: Incompatible default for argument "source"
(default has type "None", argument has type "str")  [assignment]
            source: str = None,
                          ^~~~
data\quality_monitor.py:275: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\quality_monitor.py:275: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\quality_monitor.py:276: error: Incompatible default for argument "since"
(default has type "None", argument has type "datetime")  [assignment]
            since: datetime = None,
                              ^~~~
data\quality_monitor.py:276: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\quality_monitor.py:276: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\quality_monitor.py:292: error: Need type annotation for "quality_counts"
(hint: "quality_counts: dict[<type>, <type>] = ...")  [var-annotated]
            quality_counts = {}
            ^~~~~~~~~~~~~~
data\quality_monitor.py:404: error: Function is missing a type annotation 
[no-untyped-def]
            def score(item):
            ^~~~~~~~~~~~~~~~
data\quality_monitor.py:566: error: Incompatible default for argument "config"
(default has type "None", argument has type "DataQualityConfig")  [assignment]
        config: DataQualityConfig = None,
                                    ^~~~
data\quality_monitor.py:566: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\quality_monitor.py:566: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\quality_monitor.py:570: error: Statement is unreachable  [unreachable]
            config = DataQualityConfig()
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\news.py:482: error: Incompatible default for argument "params" (default
has type "None", argument has type "dict[Any, Any]")  [assignment]
            params: dict = None,
                           ^~~~
data\news.py:482: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\news.py:482: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\news.py:483: error: Incompatible default for argument "timeout" (default
has type "None", argument has type "int")  [assignment]
            timeout: int = None,
                           ^~~~
data\news.py:483: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\news.py:483: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\news.py:484: error: Incompatible default for argument "retries" (default
has type "None", argument has type "int")  [assignment]
            retries: int = None,
                           ^~~~
data\news.py:484: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\news.py:484: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\news.py:626: error: Returning Any from function declared to return
"object | None"  [no-any-return]
                    return json.loads(chunk)
                    ^~~~~~~~~~~~~~~~~~~~~~~~
data\news.py:634: error: Returning Any from function declared to return
"object | None"  [no-any-return]
                return response.json()  # type: ignore[attr-defined]
                ^~~~~~~~~~~~~~~~~~~~~~
data\news.py:634: note: Error code "no-any-return" not covered by "type: ignore" comment
data\news.py:1105: error: Statement is unreachable  [unreachable]
            time_part = ""
            ^~~~~~~~~~~~~~
data\news.py:1110: error: Function is missing a return type annotation 
[no-untyped-def]
    def __getattr__(name: str):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
data\news_aggregator.py:102: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                    state["ok_calls"] = int(state.get("ok_calls", 0)) + 1
                                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\news_aggregator.py:102: note: Possible overload variants:
data\news_aggregator.py:102: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\news_aggregator.py:102: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\news_aggregator.py:107: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                    state["failed_calls"] = int(state.get("failed_calls", ...
                                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\news_aggregator.py:107: note: Possible overload variants:
data\news_aggregator.py:107: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\news_aggregator.py:107: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\news_aggregator.py:116: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                ok_calls = int(state.get("ok_calls", 0))
                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\news_aggregator.py:116: note: Possible overload variants:
data\news_aggregator.py:116: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\news_aggregator.py:116: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\news_aggregator.py:117: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                failed_calls = int(state.get("failed_calls", 0))
                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\news_aggregator.py:117: note: Possible overload variants:
data\news_aggregator.py:117: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\news_aggregator.py:117: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\news_aggregator.py:765: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                    ok_calls = int(state.get("ok_calls", 0))
                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\news_aggregator.py:765: note: Possible overload variants:
data\news_aggregator.py:765: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\news_aggregator.py:765: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\news_aggregator.py:766: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                    failed_calls = int(state.get("failed_calls", 0))
                                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\news_aggregator.py:766: note: Possible overload variants:
data\news_aggregator.py:766: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\news_aggregator.py:766: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\news_aggregator.py:769: error: Argument 1 to "float" has incompatible type
"object"; expected "str | Buffer | SupportsFloat | SupportsIndex"  [arg-type]
                    last_success_ts = float(state.get("last_success_ts", 0...
                                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
data\news_aggregator.py:778: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                        "last_items": int(state.get("last_items", 0)),
                                      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\news_aggregator.py:778: note: Possible overload variants:
data\news_aggregator.py:778: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\news_aggregator.py:778: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
analysis\realistic_backtest.py:84: error: Returning Any from function declared
to return "float"  [no-any-return]
            return min(impact, 0.10)
            ^~~~~~~~~~~~~~~~~~~~~~~~
analysis\realistic_backtest.py:92: error: Incompatible default for argument
"bid_ask_spread" (default has type "None", argument has type "float") 
[assignment]
            bid_ask_spread: float = None,
                                    ^~~~
analysis\realistic_backtest.py:92: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
analysis\realistic_backtest.py:92: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
analysis\realistic_backtest.py:108: error: Statement is unreachable 
[unreachable]
                bid_ask_spread = self.base_spread_bps / 10000
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\realistic_backtest.py:246: error: Incompatible default for argument
"impact_model" (default has type "None", argument has type "MarketImpactModel") 
[assignment]
            impact_model: MarketImpactModel = None,
                                              ^~~~
analysis\realistic_backtest.py:246: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
analysis\realistic_backtest.py:246: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
analysis\realistic_backtest.py:247: error: Incompatible default for argument
"cost_model" (default has type "None", argument has type "TransactionCostModel")
 [assignment]
            cost_model: TransactionCostModel = None,
                                               ^~~~
analysis\realistic_backtest.py:247: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
analysis\realistic_backtest.py:247: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
analysis\realistic_backtest.py:248: error: Incompatible default for argument
"liquidity" (default has type "None", argument has type "LiquidityConstraint") 
[assignment]
            liquidity: LiquidityConstraint = None,
                                             ^~~~
analysis\realistic_backtest.py:248: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
analysis\realistic_backtest.py:248: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
analysis\realistic_backtest.py:277: error: Incompatible default for argument
"daily_volume" (default has type "None", argument has type "float") 
[assignment]
            daily_volume: float = None,
                                  ^~~~
analysis\realistic_backtest.py:277: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
analysis\realistic_backtest.py:277: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
analysis\realistic_backtest.py:278: error: Incompatible default for argument
"bid_ask_spread" (default has type "None", argument has type "float") 
[assignment]
            bid_ask_spread: float = None,
                                    ^~~~
analysis\realistic_backtest.py:278: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
analysis\realistic_backtest.py:278: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
analysis\realistic_backtest.py:279: error: Incompatible default for argument
"timestamp" (default has type "None", argument has type "datetime") 
[assignment]
            timestamp: datetime = None,
                                  ^~~~
analysis\realistic_backtest.py:279: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
analysis\realistic_backtest.py:279: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
analysis\realistic_backtest.py:299: error: Statement is unreachable 
[unreachable]
                timestamp = datetime.now()
                ^~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\realistic_backtest.py:302: error: Statement is unreachable 
[unreachable]
                daily_volume = self.get_daily_volume(symbol)
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\realistic_backtest.py:483: error: Incompatible default for argument
"config" (default has type "None", argument has type "BacktestConfig") 
[assignment]
        config: BacktestConfig = None,
                                 ^~~~
analysis\realistic_backtest.py:483: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
analysis\realistic_backtest.py:483: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
analysis\realistic_backtest.py:487: error: Statement is unreachable 
[unreachable]
            config = BacktestConfig()
            ^~~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:60: error: "DualMovingAverageStrategy" has no
attribute "_calculate_strength"  [attr-defined]
                        strength=self._calculate_strength(abs(fast_ma - sl...
                                 ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:76: error: "DualMovingAverageStrategy" has no
attribute "_calculate_strength"  [attr-defined]
                        strength=self._calculate_strength(abs(fast_ma - sl...
                                 ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:252: error: "ZScoreMeanReversionStrategy" has
no attribute "_calculate_strength"  [attr-defined]
                    strength=self._calculate_strength(abs(zscore) / self.p...
                             ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:267: error: "ZScoreMeanReversionStrategy" has
no attribute "_calculate_strength"  [attr-defined]
                    strength=self._calculate_strength(abs(zscore) / self.p...
                             ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:420: error: "RateOfChangeMomentumStrategy"
has no attribute "_calculate_strength"  [attr-defined]
                    strength=self._calculate_strength(roc / self.params["t...
                             ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:434: error: "RateOfChangeMomentumStrategy"
has no attribute "_calculate_strength"  [attr-defined]
                    strength=self._calculate_strength(abs(roc) / self.para...
                             ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:833: error: Returning Any from function
declared to return "bool"  [no-any-return]
            return (lower_shadow > body * 2 and 
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:842: error: Returning Any from function
declared to return "bool"  [no-any-return]
            return (upper_shadow > body * 2 and 
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:849: error: Returning Any from function
declared to return "bool"  [no-any-return]
            return (prev_body > 0 and curr_body > 0 and
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:897: error: "MultiFactorAlphaStrategy" has no
attribute "_calculate_strength"  [attr-defined]
                    strength=self._calculate_strength(composite),
                             ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:915: error: "MultiFactorAlphaStrategy" has no
attribute "_calculate_strength"  [attr-defined]
                    strength=self._calculate_strength(1 - composite),
                             ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:974: error: "EarningsAnnouncementStrategy"
has no attribute "_calculate_strength"  [attr-defined]
                    strength=self._calculate_strength(abs(combined_score) ...
                             ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:988: error: "EarningsAnnouncementStrategy"
has no attribute "_calculate_strength"  [attr-defined]
                    strength=self._calculate_strength(abs(combined_score) ...
                             ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:1158: error: "MLClassifierStrategy" has no
attribute "_calculate_strength"  [attr-defined]
                    strength=self._calculate_strength(probability),
                             ^~~~~~~~~~~~~~~~~~~~~~~~
strategies\strategy_collection.py:1171: error: "MLClassifierStrategy" has no
attribute "_calculate_strength"  [attr-defined]
                    strength=self._calculate_strength(probability),
                             ^~~~~~~~~~~~~~~~~~~~~~~~
ui\news_widget.py:45: error: Incompatible default for argument "stock_code"
(default has type "None", argument has type "str")  [assignment]
        def __init__(self, stock_code: str = None, fetch_type: str = "mark...
                                             ^~~~
ui\news_widget.py:45: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\news_widget.py:45: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\news_widget.py:207: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def __init__(self, parent=None) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\news_widget.py:256: error: Item "None" of "QHeaderView | None" has no
attribute "setSectionResizeMode"  [union-attr]
            self.table.horizontalHeader().setSectionResizeMode(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\news_widget.py:259: error: Item "None" of "QHeaderView | None" has no
attribute "setSectionResizeMode"  [union-attr]
            self.table.horizontalHeader().setSectionResizeMode(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\news_widget.py:262: error: Item "None" of "QHeaderView | None" has no
attribute "setSectionResizeMode"  [union-attr]
            self.table.horizontalHeader().setSectionResizeMode(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\news_widget.py:265: error: Item "None" of "QHeaderView | None" has no
attribute "setSectionResizeMode"  [union-attr]
            self.table.horizontalHeader().setSectionResizeMode(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\news_widget.py:278: error: Item "None" of "QHeaderView | None" has no
attribute "setVisible"  [union-attr]
            self.table.verticalHeader().setVisible(False)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\news_widget.py:350: error: Argument 1 to "NewsFetchThread" has incompatible
type "str | None"; expected "str"  [arg-type]
            thread = NewsFetchThread(self._current_stock, fetch_type)
                                     ^~~~~~~~~~~~~~~~~~~
ui\news_widget.py:420: error: Statement is unreachable  [unreachable]
                news_items = []
                ^~~~~~~~~~~~~~~
ui\news_widget.py:426: error: Argument 3 to "safe_str_attr" has incompatible
type "None"; expected "str"  [arg-type]
                publish_time = safe_str_attr(item, 'publish_time', None)
                                                                   ^~~~
tests\test_news_weighted_sentiment.py:16: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_sentiment_summary_uses_weighted_mode(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_news_weighted_sentiment.py:48: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_news_fusion_diagnostics_and_features(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_news_weighted_sentiment.py:104: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_sentiment_entropy_zero_for_single_source(monkeypatch) -> None...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_news_weighted_sentiment.py:132: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_base_news_fetcher_uses_existing_ca_bundle(tmp_path, monkeypat...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_news_weighted_sentiment.py:151: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_base_news_fetcher_keeps_verify_enabled_when_all_ca_paths_inva...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_news_weighted_sentiment.py:168: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_base_news_fetcher_allows_insecure_tls_only_with_env(monkeypat...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_news_weighted_sentiment.py:185: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_sentiment_summary_handles_mixed_timezone_publish_times(monkey...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_news_weighted_sentiment.py:216: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_news_features_supports_zero_lookback_and_mixed_timezone(monke...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_news_weighted_sentiment.py:247: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_market_news_sort_accepts_mixed_timezone_publish_times(monkeyp...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_news_weighted_sentiment.py:286: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_news_features_invalid_lookback_value_does_not_crash(monkeypat...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_news_weighted_sentiment.py:305: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_sentiment_summary_tolerates_non_numeric_fields(monkeypatch) -...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_news_weighted_sentiment.py:341: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_sina_stock_news_parses_jsonp_payload_without_html_h2(monkeypa...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_news_weighted_sentiment.py:369: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_eastmoney_stock_news_parses_plain_json_without_jsonp_wrapper(...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_news_weighted_sentiment.py:392: error: Function is missing a return
type annotation  [no-untyped-def]
            def json():
            ^~~~~~~~~~~
tests\test_strategies.py:52: error: Cannot instantiate abstract class
"BaseStrategy" with abstract attribute "generate_signal"  [abstract]
            BaseStrategy()
            ^~~~~~~~~~~~~~
tests\test_strategies.py:217: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
            def generate_signal(self, data) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_deployment_snapshot.py:7: error: Function is missing a return type
annotation  [no-untyped-def]
    def _load_snapshot_module():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_deployment_snapshot.py:54: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_post_restore_verification_runs_preflight(monkeypatch, tmp_pat...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_deployment_snapshot.py:58: error: Function is missing a return type
annotation  [no-untyped-def]
        def fake_run_step(name: str, cmd: list[str], cwd: Path):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\atomic_io.py:24: error: Incompatible types in assignment (expression has
type "None", variable has type Module)  [assignment]
        torch = None
                ^~~~
utils\atomic_io.py:63: error: Incompatible return value type (got "LockType",
expected "RLock")  [return-value]
                return _lock_cache[key]
                       ^~~~~~~~~~~~~~~~
utils\atomic_io.py:66: error: Incompatible types in assignment (expression has
type "RLock", target has type "LockType")  [assignment]
            _lock_cache[key] = lock
                               ^~~~
models\uncertainty_quantification.py:159: error: Returning Any from function
declared to return "float"  [no-any-return]
            return abs(prediction[0]) * 0.05  # 5% of prediction
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\uncertainty_quantification.py:268: error: Incompatible types in
assignment (expression has type "ndarray[tuple[int, ...], dtype[Any]]", variable
has type "list[float]")  [assignment]
                weights = np.array(weights)
                          ^~~~~~~~~~~~~~~~~
models\networks.py:82: error: Value of type "Tensor | Module" is not indexable 
[index]
            x = x + self.pe[:, :seq_len, :]
                    ^~~~~~~~~~~~~~~~~~~~~~~
models\networks.py:83: error: Returning Any from function declared to return
"Tensor"  [no-any-return]
            return self.dropout(x)
            ^~~~~~~~~~~~~~~~~~~~~~
models\networks.py:206: error: Returning Any from function declared to return
"Tensor"  [no-any-return]
            return self.dropout(output)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\networks.py:246: error: Incompatible types in assignment (expression has
type "None", variable has type "Conv1d")  [assignment]
                self.residual_proj = None
                                     ^~~~
models\networks.py:276: error: Returning Any from function declared to return
"Tensor"  [no-any-return]
            return out
            ^~~~~~~~~~
models\networks.py:367: error: Returning Any from function declared to return
"tuple[Tensor, Tensor]"  [no-any-return]
            return self.head(pooled)
            ^~~~~~~~~~~~~~~~~~~~~~~~
models\networks.py:417: error: Returning Any from function declared to return
"tuple[Tensor, Tensor]"  [no-any-return]
            return self.head(pooled)
            ^~~~~~~~~~~~~~~~~~~~~~~~
models\networks.py:463: error: Returning Any from function declared to return
"tuple[Tensor, Tensor]"  [no-any-return]
            return self.head(pooled)
            ^~~~~~~~~~~~~~~~~~~~~~~~
models\networks.py:513: error: Returning Any from function declared to return
"tuple[Tensor, Tensor]"  [no-any-return]
            return self.head(pooled)
            ^~~~~~~~~~~~~~~~~~~~~~~~
models\networks.py:588: error: Returning Any from function declared to return
"tuple[Tensor, Tensor]"  [no-any-return]
            return self.head(pooled)
            ^~~~~~~~~~~~~~~~~~~~~~~~
models\layers.py:36: error: Value of type "Tensor | Module" is not indexable 
[index]
            x = x + self.pe[:, : x.size(1)]
                    ^~~~~~~~~~~~~~~~~~~~~~~
models\layers.py:37: error: Returning Any from function declared to return
"Tensor"  [no-any-return]
            return self.dropout(x)
            ^~~~~~~~~~~~~~~~~~~~~~
models\layers.py:150: error: Returning Any from function declared to return
"Tensor"  [no-any-return]
            return self.net(x)
            ^~~~~~~~~~~~~~~~~~
models\layers.py:161: error: Returning Any from function declared to return
"Tensor"  [no-any-return]
            return F.silu(self.w1(x)) * self.w2(x)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\layers.py:228: error: Returning Any from function declared to return
"Tensor"  [no-any-return]
            return output
            ^~~~~~~~~~~~~
models\layers.py:283: error: Returning Any from function declared to return
"Tensor"  [no-any-return]
            return self.activation(out + residual)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\runtime_lease.py:84: error: Function is missing a return type
annotation  [no-untyped-def]
        def _file_guard(self):
        ^~~~~~~~~~~~~~~~~~~~~~
trading\runtime_lease.py:284: error: Statement is unreachable  [unreachable]
                    return
                    ^~~~~~
models\auto_learner_lifecycle_ops.py:18: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def start(
    ^~~~~~~~~~
models\auto_learner_lifecycle_ops.py:77: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def start_targeted(
    ^~~~~~~~~~~~~~~~~~~
models\auto_learner_lifecycle_ops.py:154: error: Function is missing a type
annotation  [no-untyped-def]
    def run_targeted(self, **kwargs):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_lifecycle_ops.py:164: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _targeted_loop(
    ^~~~~~~~~~~~~~~~~~~
models\auto_learner_lifecycle_ops.py:234: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _interruptible_sleep(self, seconds: int) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_lifecycle_ops.py:244: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _save_state(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_lifecycle_ops.py:292: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _load_state(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
config\settings.py:595: error: Returning Any from function declared to return
"Path"  [no-any-return]
            return self._data_dir_cached
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
config\settings.py:609: error: Returning Any from function declared to return
"Path"  [no-any-return]
            return self._model_dir_cached
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
config\settings.py:615: error: Returning Any from function declared to return
"Path"  [no-any-return]
            return self._log_dir_cached
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~
config\settings.py:621: error: Returning Any from function declared to return
"Path"  [no-any-return]
            return self._cache_dir_cached
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
config\settings.py:627: error: Returning Any from function declared to return
"Path"  [no-any-return]
            return self._audit_dir_cached
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
config\settings.py:734: error: "object" not callable  [operator]
                        self._set_nested(attr_path, converter(value.strip(...
                                                    ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_uncertainty_quantification.py:241: error: Item "None" of
"DeepEnsemble | None" has no attribute "add_model"  [union-attr]
            uq.ensemble.add_model(MockModel())
            ^~~~~~~~~~~~~~~~~~~~~
utils\security.py:41: error: Incompatible types in assignment (expression has
type "None", variable has type "type[Fernet]")  [assignment]
        Fernet = None
                 ^~~~
ui\app_model_chart_ops.py:16: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _sync_ui_to_loaded_model(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:109: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _loaded_model_ui_meta(self) -> tuple[str, int]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:135: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _has_exact_model_artifacts(self, interval: str, horizon: int) -> b...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
ui\app_model_chart_ops.py:147: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _log_model_alignment_debug(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:175: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _debug_chart_state(
    ^~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:240: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _debug_candle_quality(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:373: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _debug_forecast_quality(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:522: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _chart_prediction_caps(self, interval: str) -> tuple[float, float]...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:537: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _prepare_chart_predicted_prices(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:729: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _chart_prediction_uncertainty_profile(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:761: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _build_chart_prediction_bands(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:823: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _resolve_chart_prediction_series(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:855: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _render_chart_state(
    ^~~~~~~~~~~~~~~~~~~~~~~~
ui\app_model_chart_ops.py:1001: error: Returning Any from function declared to
return "list[dict[str, Any]]"  [no-any-return]
            return arr
            ^~~~~~~~~~
ui\app_model_chart_ops.py:1002: error: Returning Any from function declared to
return "list[dict[str, Any]]"  [no-any-return]
        return arr
        ^~~~~~~~~~
ui\app_chart_history_load_ops.py:427: error: Returning Any from function
declared to return "list[dict[str, Any]]"  [no-any-return]
                    return self._load_chart_history_bars(symbol, norm_iv, ...
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
trading\oms_db.py:20: error: Incompatible default for argument "db_path"
(default has type "None", argument has type "Path")  [assignment]
        def __init__(self, db_path: Path = None) -> None:
                                           ^~~~
trading\oms_db.py:20: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:20: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms_db.py:42: error: Returning Any from function declared to return
"Connection"  [no-any-return]
            return self._local.conn
            ^~~~~~~~~~~~~~~~~~~~~~~
trading\oms_db.py:54: error: Function is missing a return type annotation 
[no-untyped-def]
        def transaction(self):
        ^~~~~~~~~~~~~~~~~~~~~~
trading\oms_db.py:221: error: Incompatible default for argument "conn" (default
has type "None", argument has type "Connection")  [assignment]
    ...ve_order(self, order: Order, conn: sqlite3.Connection = None) -> None:
                                                               ^~~~
trading\oms_db.py:221: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:221: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms_db.py:313: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def _row_to_order(self, row) -> Order:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\oms_db.py:378: error: Incompatible default for argument "conn" (default
has type "None", argument has type "Connection")  [assignment]
    ... save_fill(self, fill: Fill, conn: sqlite3.Connection = None) -> bool:
                                                               ^~~~
trading\oms_db.py:378: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:378: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms_db.py:439: error: Incompatible default for argument "order_id"
(default has type "None", argument has type "str")  [assignment]
        def load_fills(self, order_id: str = None) -> list[Fill]:
                                             ^~~~
trading\oms_db.py:439: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:439: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms_db.py:480: error: Incompatible default for argument "conn" (default
has type "None", argument has type "Connection")  [assignment]
            conn: sqlite3.Connection = None,
                                       ^~~~
trading\oms_db.py:480: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:480: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms_db.py:548: error: Incompatible default for argument "conn" (default
has type "None", argument has type "Connection")  [assignment]
    ...osition(self, pos: Position, conn: sqlite3.Connection = None) -> None:
                                                               ^~~~
trading\oms_db.py:548: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:548: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms_db.py:606: error: Incompatible default for argument "conn" (default
has type "None", argument has type "Connection")  [assignment]
    ..._position(self, symbol: str, conn: sqlite3.Connection = None) -> None:
                                                               ^~~~
trading\oms_db.py:606: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:606: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms_db.py:625: error: Incompatible default for argument "conn" (default
has type "None", argument has type "Connection")  [assignment]
            self, account: Account, conn: sqlite3.Connection = None
                                                               ^~~~
trading\oms_db.py:625: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:625: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms_db.py:690: error: Incompatible default for argument "conn" (default
has type "None", argument has type "Connection")  [assignment]
            conn: sqlite3.Connection = None
                                       ^~~~
trading\oms_db.py:690: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:690: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms_db.py:728: error: Incompatible default for argument "purchase_date"
(default has type "None", argument has type "date")  [assignment]
            self, symbol: str, purchase_date: date = None,
                                                     ^~~~
trading\oms_db.py:728: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:728: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms_db.py:729: error: Incompatible default for argument "conn" (default
has type "None", argument has type "Connection")  [assignment]
            conn: sqlite3.Connection = None
                                       ^~~~
trading\oms_db.py:729: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms_db.py:729: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
tests\test_config_bool_parsing.py:35: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_load_from_env_runtime_lease_enabled_false(monkeypatch) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_config_bool_parsing.py:45: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_load_from_env_runtime_lease_invalid_does_not_override(monkeyp...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\trainer_eval_ops.py:43: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _walk_forward_validate(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_eval_ops.py:185: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _build_quality_gate(
    ^~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_eval_ops.py:282: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _run_drift_guard(
    ^~~~~~~~~~~~~~~~~~~~~
models\trainer_eval_ops.py:369: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _trade_quality_thresholds(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_eval_ops.py:471: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _build_explainability_samples(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_eval_ops.py:548: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _build_trading_stress_tests(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_eval_ops.py:730: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _evaluate(
    ^~~~~~~~~~~~~~
models\trainer_eval_ops.py:752: error: Function is missing a type annotation 
[no-untyped-def]
            def confusion_matrix(y_true, y_pred, labels):  # type: ignore[...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\trainer_eval_ops.py:752: note: Error code "no-untyped-def" not covered by "type: ignore" comment
models\trainer_eval_ops.py:764: error: Function is missing a type annotation 
[no-untyped-def]
            def precision_recall_fscore_support(  # type: ignore[redef]
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_eval_ops.py:764: note: Error code "no-untyped-def" not covered by "type: ignore" comment
models\trainer_eval_ops.py:960: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _simulate_trading(
    ^~~~~~~~~~~~~~~~~~~~~~
models\trainer_data_ops.py:45: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _assess_raw_data_quality(self, df: pd.DataFrame) -> dict[str, Any]...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_data_ops.py:137: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _split_single_stock(
    ^~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_data_ops.py:249: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _fetch_raw_data(
    ^~~~~~~~~~~~~~~~~~~~
models\trainer_data_ops.py:441: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _create_sequences_from_splits(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_data_ops.py:448: error: Need type annotation for "storage" 
[var-annotated]
        storage = {
                  ^
models\trainer_data_ops.py:477: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _rebalance_train_samples(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_data_ops.py:624: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _effective_confidence_floor(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_data_ops.py:638: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _fallback_temporal_validation_split(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_data_ops.py:713: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def prepare_data(
    ^~~~~~~~~~~~~~~~~
models\trainer_data_ops.py:715: error: Incompatible default for argument
"stock_codes" (default has type "None", argument has type "list[str]") 
[assignment]
        stock_codes: list[str] = None,
                                 ^~~~
models\trainer_data_ops.py:715: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_data_ops.py:715: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_data_ops.py:719: error: Incompatible default for argument
"prediction_horizon" (default has type "None", argument has type "int") 
[assignment]
        prediction_horizon: int = None,
                                  ^~~~
models\trainer_data_ops.py:719: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_data_ops.py:719: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_data_ops.py:720: error: Incompatible default for argument
"lookback_bars" (default has type "None", argument has type "int")  [assignment]
        lookback_bars: int = None,
                             ^~~~
models\trainer_data_ops.py:720: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_data_ops.py:720: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_data_ops.py:799: error: Function is missing a type annotation 
[no-untyped-def]
        def safe(arr, is_X=False):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_precision_ops.py:55: error: Statement is unreachable 
[unreachable]
                continue
                ^~~~~~~~
models\auto_learner_precision_ops.py:285: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def tune_precision_thresholds(self, samples: list[dict[str, Any]]) -> ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\auto_learner_precision_ops.py:354: error: Dict entry 9 has incompatible
type "str": "str"; expected "str": "float"  [dict-item]
                                "regime": str(regime),
                                ^~~~~~~~~~~~~~~~~~~~~
models\auto_learner_precision_ops.py:403: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def validate_and_decide(
    ^~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_cycle_ops.py:13: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _main_loop(
    ^~~~~~~~~~~~~~~
models\auto_learner_cycle_ops.py:178: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _run_cycle(
    ^~~~~~~~~~~~~~~
models\auto_learner_cycle_ops.py:571: error: Returning Any from function
declared to return "bool"  [no-any-return]
            return accepted
            ^~~~~~~~~~~~~~~
models\auto_learner_cycle_ops.py:588: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _run_targeted_cycle(
    ^~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_cycle_ops.py:906: error: Returning Any from function
declared to return "bool"  [no-any-return]
            return accepted
            ^~~~~~~~~~~~~~~
data\validators.py:538: error: Incompatible default for argument "price"
(default has type "None", argument has type "float")  [assignment]
            price: float = None,
                           ^~~~
data\validators.py:538: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\validators.py:538: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\validators.py:799: error: Returning Any from function declared to return
"str"  [no-any-return]
        return result.data
        ^~~~~~~~~~~~~~~~~~
data\validators.py:827: error: Returning Any from function declared to return
"tuple[date, date]"  [no-any-return]
        return result.data
        ^~~~~~~~~~~~~~~~~~
data\universe.py:152: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def _rank_codes_by_liquidity(df) -> list[str]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\universe.py:219: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def _extract_codes_from_df(df) -> list[str]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\universe.py:283: error: Function is missing a return type annotation 
[no-untyped-def]
        def _do_spot_fetch():
        ^~~~~~~~~~~~~~~~~~~~~
data\universe.py:297: error: Function is missing a return type annotation 
[no-untyped-def]
        def _do_fallback_fetch():
        ^~~~~~~~~~~~~~~~~~~~~~~~~
data\universe.py:331: error: Returning Any from function declared to return
"list[str] | None"  [no-any-return]
                    return result
                    ^~~~~~~~~~~~~
data\universe.py:343: error: Returning Any from function declared to return
"list[str] | None"  [no-any-return]
                    return result
                    ^~~~~~~~~~~~~
data\universe.py:460: error: Argument 1 to "float" has incompatible type
"object"; expected "str | Buffer | SupportsFloat | SupportsIndex"  [arg-type]
                cached_ts = float(_new_listings_cache.get("ts", 0.0) or 0....
                                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\universe.py:461: error: No overload variant of "int" matches argument type
"object"  [call-overload]
                cached_days = int(_new_listings_cache.get("days", 0) or 0)
                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\universe.py:461: note: Possible overload variants:
data\universe.py:461: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\universe.py:461: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\universe.py:463: error: No overload variant of "list" matches argument
type "object"  [call-overload]
                    list(_new_listings_cache.get("codes", []) or [])
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\universe.py:463: note: Possible overload variants:
data\universe.py:463: note:     def [_T] __init__(self) -> list[_T]
data\universe.py:463: note:     def [_T] __init__(self, Iterable[_T], /) -> list[_T]
data\session_cache_read_ops.py:19: error: Function is missing a return type
annotation  [no-untyped-def]
    def _shanghai_tz():
    ^~~~~~~~~~~~~~~~~~~
data\processor_stats_ops.py:15: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def prepare_single_sequence(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\processor_stats_ops.py:19: error: Returning Any from function declared to
return "ndarray[Any, Any]"  [no-any-return]
        return self.prepare_inference_sequence(df, feature_cols)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\processor_stats_ops.py:22: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def get_class_distribution(self, y: np.ndarray) -> dict[str, int]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\processor_stats_ops.py:69: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def get_scaler_info(self) -> dict[str, Any]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_tencent_source.py:118: error: Incompatible types in assignment
(expression has type "str | None", variable has type "str")  [assignment]
                                    code6 = vendor_to_code.get(vendor_sym)
                                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_sources.py:194: error: Function is missing a return type
annotation  [no-untyped-def]
    def retry(max_attempts: int = 3, delay: float = 1.0, backoff: float = ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
data\fetcher_sources.py:198: error: Function is missing a type annotation 
[no-untyped-def]
            def wrapper(*args, **kwargs):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_sources.py:241: error: Function is missing a return type
annotation  [no-untyped-def]
        def __post_init__(self):
        ^~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_sources.py:241: note: Use "-> None" if function does not return a value
data\fetcher_sources.py:476: error: Item "None" of "Any | None" has no
attribute "stock_zh_a_spot_em"  [union-attr]
                        lambda: self._ak.stock_zh_a_spot_em(),
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_sources.py:668: error: Item "None" of "Any | None" has no
attribute "stock_zh_a_hist"  [union-attr]
                lambda: self._ak.stock_zh_a_hist(
                        ^~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_sources.py:723: error: Item "None" of "Any | None" has no
attribute "stock_zh_a_hist_min_em"  [union-attr]
                    lambda: self._ak.stock_zh_a_hist_min_em(
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_sources.py:753: error: Item "None" of "Any | None" has no
attribute "stock_zh_a_hist"  [union-attr]
                lambda: self._ak.stock_zh_a_hist(
                        ^~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_sources.py:1039: error: Returning Any from function declared to
return "object | None"  [no-any-return]
                return json.loads(text)
                ^~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_sources.py:1051: error: Returning Any from function declared to
return "object | None"  [no-any-return]
                    return json.loads(frag)
                    ^~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_clean_ops.py:80: error: No overload variant of "list" matches
argument type "object"  [call-overload]
        values = list(idx) if idx is not None else []
                 ^~~~~~~~~
data\fetcher_clean_ops.py:80: note: Possible overload variants:
data\fetcher_clean_ops.py:80: note:     def [_T] __init__(self) -> list[_T]
data\fetcher_clean_ops.py:80: note:     def [_T] __init__(self, Iterable[_T], /) -> list[_T]
data\database.py:39: error: Incompatible default for argument "db_path"
(default has type "None", argument has type "Path")  [assignment]
        def __init__(self, db_path: Path = None) -> None:
                                           ^~~~
data\database.py:39: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\database.py:39: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\database.py:96: error: Returning Any from function declared to return
"Connection"  [no-any-return]
            return self._local.conn
            ^~~~~~~~~~~~~~~~~~~~~~~
data\database.py:121: error: Function is missing a return type annotation 
[no-untyped-def]
        def _transaction(self):
        ^~~~~~~~~~~~~~~~~~~~~~~
data\database.py:297: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def _to_float(x, default: float = 0.0) -> float:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\database.py:301: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def _to_int(x, default: int = 0) -> int:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\database.py:844: error: Incompatible default for argument "name" (default
has type "None", argument has type "str")  [assignment]
            name: str = None,
                        ^~~~
data\database.py:844: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\database.py:844: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\database.py:845: error: Incompatible default for argument "exchange"
(default has type "None", argument has type "str")  [assignment]
            exchange: str = None,
                            ^~~~
data\database.py:845: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\database.py:845: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\database.py:846: error: Incompatible default for argument "sector"
(default has type "None", argument has type "str")  [assignment]
            sector: str = None,
                          ^~~~
data\database.py:846: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\database.py:846: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\database.py:847: error: Incompatible default for argument "market_cap"
(default has type "None", argument has type "float")  [assignment]
            market_cap: float = None,
                                ^~~~
data\database.py:847: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\database.py:847: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\database.py:968: error: Incompatible default for argument "start_date"
(default has type "None", argument has type "date")  [assignment]
            start_date: date = None,
                               ^~~~
data\database.py:968: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\database.py:968: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\database.py:969: error: Incompatible default for argument "end_date"
(default has type "None", argument has type "date")  [assignment]
            end_date: date = None,
                             ^~~~
data\database.py:969: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\database.py:969: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\database.py:970: error: Incompatible default for argument "limit" (default
has type "None", argument has type "int")  [assignment]
            limit: int = None,
                         ^~~~
data\database.py:970: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\database.py:970: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\database.py:1011: error: Statement is unreachable  [unreachable]
                query = (
                ^~~~~~~~~
data\cache.py:121: error: Incompatible default for argument "max_age_hours"
(default has type "None", argument has type "float")  [assignment]
            self, key: str, max_age_hours: float = None
                                                   ^~~~
data\cache.py:121: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\cache.py:121: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\cache.py:280: error: Incompatible default for argument "max_age_hours"
(default has type "None", argument has type "float")  [assignment]
            self, key: str, max_age_hours: float = None
                                                   ^~~~
data\cache.py:280: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\cache.py:280: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\cache.py:416: error: Incompatible default for argument "older_than_hours"
(default has type "None", argument has type "float")  [assignment]
        def clear(self, older_than_hours: float = None) -> None:
                                                  ^~~~
data\cache.py:416: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\cache.py:416: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\cache.py:542: error: Incompatible default for argument "max_age_hours"
(default has type "None", argument has type "float")  [assignment]
        def get(self, key: str, max_age_hours: float = None) -> Any:
                                                       ^~~~
data\cache.py:542: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\cache.py:542: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\cache.py:618: error: Incompatible default for argument "tier" (default has
type "None", argument has type "str")  [assignment]
            tier: str = None,
                        ^~~~
data\cache.py:618: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\cache.py:618: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\cache.py:619: error: Incompatible default for argument "older_than_hours"
(default has type "None", argument has type "float")  [assignment]
            older_than_hours: float = None,
                                      ^~~~
data\cache.py:619: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\cache.py:619: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\cache.py:641: error: Incompatible default for argument "max_age_hours"
(default has type "None", argument has type "float")  [assignment]
            max_age_hours: float = None,
                                   ^~~~
data\cache.py:641: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\cache.py:641: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\cache.py:653: error: Returning Any from function declared to return "T" 
[no-any-return]
                return value
                ^~~~~~~~~~~~
data\cache.py:663: error: Returning Any from function declared to return "T" 
[no-any-return]
                        return value
                        ^~~~~~~~~~~~
data\cache.py:734: error: Function is missing a return type annotation 
[no-untyped-def]
    def cached(
    ^~~~~~~~~~~
data\cache.py:735: error: Incompatible default for argument "key_fn" (default
has type "None", argument has type "Callable[..., str]")  [assignment]
        key_fn: Callable[..., str] = None,
                                     ^~~~
data\cache.py:735: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\cache.py:735: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\cache.py:736: error: Incompatible default for argument "max_age_hours"
(default has type "None", argument has type "float")  [assignment]
        max_age_hours: float = None,
                               ^~~~
data\cache.py:736: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
data\cache.py:736: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
data\cache.py:769: error: Function is missing a type annotation 
[no-untyped-def]
        def decorator(func):
        ^~~~~~~~~~~~~~~~~~~~
data\cache.py:771: error: Function is missing a type annotation 
[no-untyped-def]
            def wrapper(*args, **kwargs):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\cache.py:774: error: Function "key_fn" could always be true in boolean
context  [truthy-function]
                if key_fn:
                   ^~~~~~
data\cache.py:778: error: Statement is unreachable  [unreachable]
                    try:
                    ^~~~
analysis\strategy_marketplace.py:561: error: Returning Any from function
declared to return "dict[str, Any]"  [no-any-return]
                return averages[strategy_id]
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\strategy_marketplace.py:629: error: Need type annotation for "best" 
[var-annotated]
            best = max(performances.items(), key=lambda x: x[1].get("sharp...
                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
analysis\sentiment.py:211: error: Incompatible types in assignment (expression
has type "def get_best_endpoint(name: str) -> str", variable has type
"def get_best_endpoint(provider: str) -> str")  [assignment]
                self._get_best_endpoint = lambda name: ""
                                          ^
analysis\sentiment.py:388: error: Argument "params" to "get" of "Session" has
incompatible type "dict[str, object]"; expected
"SupportsItems[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | Iterable[tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None]] | str | bytes | None"
 [arg-type]
                resp = self.session.get(url, params=params, headers=header...
                                                    ^~~~~~
analysis\sentiment.py:474: error: Argument "params" to "get" of "Session" has
incompatible type "dict[str, object]"; expected
"SupportsItems[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | Iterable[tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None]] | str | bytes | None"
 [arg-type]
                resp = self.session.get(url, params=params, headers=header...
                                                    ^~~~~~
analysis\sentiment.py:596: error: Argument "params" to "get" of "Session" has
incompatible type "dict[str, object]"; expected
"SupportsItems[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | Iterable[tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None]] | str | bytes | None"
 [arg-type]
                resp = self.session.get(url, params=params, timeout=self._...
                                                    ^~~~~~
analysis\sentiment.py:647: error: Name "items" already defined on line 641 
[no-redef]
            items: list[NewsItem] = []
            ^~~~~
analysis\sentiment.py:668: error: Returning Any from function declared to
return "list[NewsItem]"  [no-any-return]
            return items
            ^~~~~~~~~~~~
tests\test_secure_storage_fail_closed.py:6: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_secure_storage_requires_cryptography(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_secure_storage_fail_closed.py:18: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_get_secure_storage_propagates_fail_closed(monkeypatch) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_secure_storage_fail_closed.py:31: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_secure_storage_default_key_path_is_outside_storage_dir(monkey...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_secure_storage_fail_closed.py:57: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_secure_storage_env_master_key_avoids_local_key_file(monkeypat...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_secure_storage_fail_closed.py:86: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_secure_storage_non_object_payload_resets_cache(monkeypatch, t...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_audit_integrity.py:9: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_audit_hash_chain_integrity_ok(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_audit_integrity.py:29: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_audit_hash_chain_detects_tamper(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_audit_integrity.py:65: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_audit_prune_respects_legal_hold(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_policy_engine.py:7: error: Function is missing a type annotation 
[no-untyped-def]
    def _signal(**kwargs):
    ^~~~~~~~~~~~~~~~~~~~~~
tests\test_policy_engine.py:20: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_policy_engine_blocks_symbol(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_policy_engine.py:43: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_policy_engine_enforces_notional_and_approvals(tmp_path) -> No...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_policy_engine.py:70: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_policy_engine_enforces_manual_and_change_ticket(tmp_path) -> ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_policy_engine.py:113: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_policy_engine_enforces_strategy_and_justification(tmp_path) -...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_policy_engine.py:154: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_policy_engine_normalizes_symbol_and_order_sanity(tmp_path) ->...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_policy_engine.py:196: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_policy_engine_rejects_missing_symbol_or_side(tmp_path) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_policy_engine.py:229: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_policy_engine_prevents_market_notional_bypass(tmp_path) -> No...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\oms.py:81: error: Incompatible default for argument "initial_capital"
(default has type "None", argument has type "float")  [assignment]
            initial_capital: float = None,
                                     ^~~~
trading\oms.py:81: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:81: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:82: error: Incompatible default for argument "db_path" (default
has type "None", argument has type "Path")  [assignment]
            db_path: Path = None
                            ^~~~
trading\oms.py:82: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:82: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:97: error: Incompatible default for argument "initial_capital"
(default has type "None", argument has type "float")  [assignment]
    ... def _recover_or_init(self, initial_capital: float = None) -> Account:
                                                            ^~~~
trading\oms.py:97: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:97: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:155: error: Incompatible types in assignment (expression has
type "Position | None", variable has type "Position")  [assignment]
                pos = self._account.positions.get(symbol)
                      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\oms.py:388: error: Incompatible default for argument "broker_id"
(default has type "None", argument has type "str")  [assignment]
            broker_id: str = None,
                             ^~~~
trading\oms.py:388: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:388: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:389: error: Incompatible default for argument "filled_qty"
(default has type "None", argument has type "int")  [assignment]
            filled_qty: int = None,
                              ^~~~
trading\oms.py:389: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:389: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:390: error: Incompatible default for argument "avg_price"
(default has type "None", argument has type "float")  [assignment]
            avg_price: float = None
                               ^~~~
trading\oms.py:390: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:390: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:922: error: Incompatible default for argument "symbol" (default
has type "None", argument has type "str")  [assignment]
        def get_orders(self, symbol: str = None) -> list[Order]:
                                           ^~~~
trading\oms.py:922: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:922: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:927: error: Incompatible default for argument "order_id"
(default has type "None", argument has type "str")  [assignment]
        def get_fills(self, order_id: str = None) -> list[Fill]:
                                            ^~~~
trading\oms.py:927: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:927: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:1021: error: "object" has no attribute "append"  [attr-defined]
                    discrepancies['missing_positions'].append({
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\oms.py:1027: error: "object" has no attribute "append"  [attr-defined]
                    discrepancies['extra_positions'].append({
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\oms.py:1037: error: "object" has no attribute "append"  [attr-defined]
                        discrepancies['position_diffs'].append({
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\oms.py:1045: error: Argument 1 to "abs" has incompatible type "object";
expected "SupportsAbs[Never]"  [arg-type]
                    abs(discrepancies['cash_diff']) > 1,
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~
trading\oms.py:1065: error: Incompatible default for argument
"broker_available" (default has type "None", argument has type "float") 
[assignment]
            broker_available: float = None
                                      ^~~~
trading\oms.py:1065: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:1065: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:1143: error: Incompatible default for argument "initial_capital"
(default has type "None", argument has type "float")  [assignment]
        initial_capital: float = None,
                                 ^~~~
trading\oms.py:1143: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:1143: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:1144: error: Incompatible default for argument "db_path"
(default has type "None", argument has type "Path")  [assignment]
        db_path: Path = None,
                        ^~~~
trading\oms.py:1144: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:1144: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:1153: error: Incompatible default for argument "initial_capital"
(default has type "None", argument has type "float")  [assignment]
        initial_capital: float = None,
                                 ^~~~
trading\oms.py:1153: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:1153: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:1154: error: Incompatible default for argument "db_path"
(default has type "None", argument has type "Path")  [assignment]
        db_path: Path = None,
                        ^~~~
trading\oms.py:1154: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:1154: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:1181: error: Incompatible default for argument "db_path"
(default has type "None", argument has type "Path")  [assignment]
        db_path: Path = None,
                        ^~~~
trading\oms.py:1181: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\oms.py:1181: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\oms.py:1186: error: Statement is unreachable  [unreachable]
                to_close = list(set(_oms_instances.values()))
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\discovery.py:340: error: "object" has no attribute "is_china_direct" 
[attr-defined]
                mode = "China direct" if env.is_china_direct else "VPN / f...
                                         ^~~~~~~~~~~~~~~~~~~
data\discovery.py:371: error: "object" has no attribute "is_china_direct" 
[attr-defined]
            if env.is_china_direct and self._ak:
               ^~~~~~~~~~~~~~~~~~~
data\discovery.py:387: error: "object" has no attribute "tencent_ok" 
[attr-defined]
            if env.tencent_ok:
               ^~~~~~~~~~~~~~
data\discovery.py:410: error: "object" has no attribute "is_china_direct" 
[attr-defined]
            if env.is_china_direct and self._ak and not ak_used_index_fall...
               ^~~~~~~~~~~~~~~~~~~
data\discovery.py:553: error: Item "None" of "Any | None" has no attribute
"stock_zh_a_spot_em"  [union-attr]
                lambda: self._ak.stock_zh_a_spot_em(), "spot data"
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
data\discovery.py:555: error: "object" has no attribute "empty"  [attr-defined]
            spot_ok = spot_df is not None and not spot_df.empty
                                                  ^~~~~~~~~~~~~
data\discovery.py:626: error: Statement is unreachable  [unreachable]
                log.warning("requests library not available for Tencent di...
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
data\processor.py:280: error: Statement is unreachable  [unreachable]
                return None
                ^~~~~~~~~~~
data\processor.py:485: error: Item "None" of "Any | None" has no attribute
"transform"  [union-attr]
                transformed = self.scaler.transform(features_clean)
                              ^~~~~~~~~~~~~~~~~~~~~
data\processor.py:501: error: Returning Any from function declared to return
"ndarray[Any, Any]"  [no-any-return]
                return result
                ^~~~~~~~~~~~~
data\processor.py:1056: error: Returning Any from function declared to return
"ndarray[Any, Any]"  [no-any-return]
            return features[np.newaxis, :, :]
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\processor.py:1434: error: "DataProcessor" has no attribute
"get_class_distribution"  [attr-defined]
                                f"class dist: {self.get_class_distribution...
                                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~
data\processor.py:1465: error: "type[DataProcessor]" has no attribute
"prepare_single_sequence"  [attr-defined]
    DataProcessor.prepare_single_sequence = _prepare_single_sequence_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\processor.py:1466: error: "type[DataProcessor]" has no attribute
"get_class_distribution"  [attr-defined]
    DataProcessor.get_class_distribution = _get_class_distribution_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\processor.py:1467: error: "type[DataProcessor]" has no attribute
"get_scaler_info"  [attr-defined]
    DataProcessor.get_scaler_info = _get_scaler_info_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quality_ops.py:30: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _intraday_frame_quality(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quality_ops.py:129: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _daily_frame_quality(cls, df: pd.DataFrame) -> dict[str, float | b...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
data\fetcher_quality_ops.py:239: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _daily_consensus_quorum_meta(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quality_ops.py:370: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _history_quorum_allows_persist(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quality_ops.py:398: error: No overload variant of "int" matches
argument type "object"  [call-overload]
            int(meta.get("agreeing_points", 0) or 0),
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quality_ops.py:398: note: Possible overload variants:
data\fetcher_quality_ops.py:398: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\fetcher_quality_ops.py:398: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\fetcher_quality_ops.py:399: error: No overload variant of "int" matches
argument type "object"  [call-overload]
            int(meta.get("compared_points", 0) or 0),
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quality_ops.py:399: note: Possible overload variants:
data\fetcher_quality_ops.py:399: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\fetcher_quality_ops.py:399: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\fetcher_quality_ops.py:400: error: Argument 1 to "float" has incompatible
type "object"; expected "str | Buffer | SupportsFloat | SupportsIndex" 
[arg-type]
            float(meta.get("agreeing_ratio", 0.0) or 0.0),
                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quality_ops.py:401: error: No overload variant of "int" matches
argument type "object"  [call-overload]
            int(meta.get("required_sources", 2) or 2),
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quality_ops.py:401: note: Possible overload variants:
data\fetcher_quality_ops.py:401: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\fetcher_quality_ops.py:401: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\fetcher_quality_ops.py:402: error: No overload variant of "list" matches
argument type "object"  [call-overload]
            ",".join(str(x) for x in list(meta.get("sources", []) or [])),
                                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quality_ops.py:402: note: Possible overload variants:
data\fetcher_quality_ops.py:402: note:     def [_T] __init__(self) -> list[_T]
data\fetcher_quality_ops.py:402: note:     def [_T] __init__(self, Iterable[_T], /) -> list[_T]
data\fetcher_quality_ops.py:407: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _merge_daily_by_consensus(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quality_ops.py:547: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _cross_validate_bars(
    ^~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_history_ops.py:22: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _fetch_from_sources_instrument(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\session_cache.py:31: error: Incompatible types in assignment (expression
has type "None", variable has type Module)  [assignment]
        fcntl = None
                ^~~~
data\session_cache.py:36: error: Incompatible types in assignment (expression
has type "None", variable has type Module)  [assignment]
        msvcrt = None
                 ^~~~
data\session_cache.py:95: error: Statement is unreachable  [unreachable]
            return False
            ^~~~~~~~~~~~
data\session_cache.py:152: error: Module has no attribute "flock" 
[attr-defined]
                        fcntl.flock(f.fileno(), fcntl.LOCK_EX | fcntl.LOCK...
                        ^~~~~~~~~~~
data\session_cache.py:152: error: Module has no attribute "LOCK_EX" 
[attr-defined]
                        fcntl.flock(f.fileno(), fcntl.LOCK_EX | fcntl.LOCK...
                                                ^~~~~~~~~~~~~
data\session_cache.py:152: error: Module has no attribute "LOCK_NB" 
[attr-defined]
    ...                fcntl.flock(f.fileno(), fcntl.LOCK_EX | fcntl.LOCK_NB)
                                                               ^~~~~~~~~~~~~
data\session_cache.py:169: error: Module has no attribute "flock" 
[attr-defined]
                        fcntl.flock(f.fileno(), fcntl.LOCK_UN)
                        ^~~~~~~~~~~
data\session_cache.py:169: error: Module has no attribute "LOCK_UN" 
[attr-defined]
                        fcntl.flock(f.fileno(), fcntl.LOCK_UN)
                                                ^~~~~~~~~~~~~
data\session_cache.py:216: error: Statement is unreachable  [unreachable]
                return datetime.now(timezone.utc).isoformat()
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\session_cache.py:1249: error: "type[SessionBarCache]" has no attribute
"read_history"  [attr-defined]
    SessionBarCache.read_history = _read_history_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_cache_delete_guard.py:6: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_disk_cache_clear_blocked_without_manual_override(tmp_path: Pa...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_cache_delete_guard.py:17: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_disk_cache_clear_allowed_with_manual_override(tmp_path: Path,...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
core\symbols.py:74: error: Statement is unreachable  [unreachable]
            return ""
            ^~~~~~~~~
core\symbols.py:122: error: Statement is unreachable  [unreachable]
            return ""
            ^~~~~~~~~
core\symbols.py:163: error: Statement is unreachable  [unreachable]
            return False, "Invalid stock code: None"
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\portfolio.py:225: error: Argument 1 to "float" has incompatible type
"object"; expected "str | Buffer | SupportsFloat | SupportsIndex"  [arg-type]
                key=lambda item: float(item.get("value", 0.0) or 0.0),
                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\health.py:45: error: Incompatible types in assignment (expression has
type "None", variable has type "datetime")  [assignment]
        last_check: datetime = None
                               ^~~~
trading\health.py:46: error: Incompatible types in assignment (expression has
type "None", variable has type "datetime")  [assignment]
        last_success: datetime = None
                                 ^~~~
trading\health.py:52: error: Function is missing a return type annotation 
[no-untyped-def]
        def __post_init__(self):
        ^~~~~~~~~~~~~~~~~~~~~~~~
trading\health.py:52: note: Use "-> None" if function does not return a value
trading\health.py:69: error: Incompatible types in assignment (expression has
type "None", variable has type "datetime")  [assignment]
        last_quote_time: datetime = None
                                    ^~~~
trading\health.py:72: error: Incompatible types in assignment (expression has
type "None", variable has type "datetime")  [assignment]
        start_time: datetime = None
                               ^~~~
trading\health.py:79: error: Incompatible types in assignment (expression has
type "None", variable has type "datetime")  [assignment]
        timestamp: datetime = None
                              ^~~~
trading\health.py:115: error: Returning Any from function declared to return
"float"  [no-any-return]
            return psutil.disk_usage(root).percent
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\health.py:118: error: Returning Any from function declared to return
"float"  [no-any-return]
                return psutil.disk_usage(os.path.abspath(os.sep)).percent
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\health.py:196: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def attach_broker(self, broker) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\health.py:260: error: Statement is unreachable  [unreachable]
            try:
            ^~~~
trading\health.py:388: error: Argument "last_quote_time" to "SystemHealth" has
incompatible type "datetime | None"; expected "datetime"  [arg-type]
                last_quote_time=self._last_quote_time,
                                ^~~~~~~~~~~~~~~~~~~~~
trading\health.py:435: error: Function is missing a return type annotation 
[no-untyped-def]
        def _evaluate_slos(self, health: SystemHealth):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\strategy_marketplace_dialog.py:34: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def __init__(self, parent=None) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\strategy_marketplace_dialog.py:74: error: Item "None" of
"QHeaderView | None" has no attribute "setVisible"  [union-attr]
            self.table.verticalHeader().setVisible(False)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\strategy_marketplace_dialog.py:78: error: Item "None" of
"QHeaderView | None" has no attribute "setStretchLastSection"  [union-attr]
            self.table.horizontalHeader().setStretchLastSection(True)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\strategy_marketplace_dialog.py:120: error: Incompatible types in assignment
(expression has type "list[StrategyEntry]", variable has type
"list[dict[Any, Any]]")  [assignment]
            self._rows = self._marketplace.list_entries()
                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\strategy_engine.py:86: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
        def evaluate(
        ^~~~~~~~~~~~~
analysis\strategy_engine.py:170: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
        def _run_one(
        ^~~~~~~~~~~~~
analysis\strategy_engine.py:230: error: Function is missing a type annotation 
[no-untyped-def]
                def _invoke(fn):
                ^~~~~~~~~~~~~~~~
tests\test_oms_fills.py:1: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
    def test_fill_dedup_with_broker_fill_id_allows_same_second_multi_fills...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_oms_fills.py:34: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_order_timeline_records_submit_and_fill(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_oms_fills.py:72: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_get_order_roundtrip_with_sqlite_row_factory(tmp_path) -> None...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_oms_fills.py:95: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_order_parent_id_roundtrip_persists(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_oms_fills.py:119: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_legacy_orders_table_is_migrated_for_parent_id(tmp_path) -> No...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_oms_fills.py:179: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_get_order_tolerates_malformed_tags_json(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_oms_fills.py:212: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_process_fill_rejects_side_mismatch_without_mutation(tmp_path)...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_oms_fills.py:256: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_process_fill_rejects_overfill(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_oms_fills.py:299: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_partial_fill_publishes_partial_event_type(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_oms_fills.py:337: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_buy_fill_overrun_preserves_negative_cash(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_oms_fills.py:374: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_sell_fill_increases_available_cash(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_oms_fills.py:446: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_buy_overrun_preserves_other_active_buy_reservations(tmp_path)...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_oms_fills.py:496: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_recovery_clears_stale_frozen_qty_when_no_active_sell_orders(t...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
data\fetcher_quote_ops.py:38: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _fill_from_batch_sources(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quote_ops.py:71: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def get_realtime_batch(self, codes: list[str]) -> dict[str, Quote]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quote_ops.py:183: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _fill_from_spot_cache(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quote_ops.py:206: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _fill_from_single_source_quotes(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quote_ops.py:246: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _fallback_last_good(self, codes: list[str]) -> dict[str, Quote]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quote_ops.py:288: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _drop_stale_quotes(
    ^~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_quote_ops.py:306: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _fallback_last_close_from_db(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:10: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_append_and_read(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:30: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=10)
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:39: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_epoch_milliseconds_timestamp(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:57: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history("600519", "1m", bars=10)
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:62: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_epoch_seconds_timestamp(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:80: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history("600519", "1m", bars=10)
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:85: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_skips_immediate_duplicate_rows(tmp_path) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:99: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history("600519", "1m", bars=10)
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:103: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_keeps_same_close_ohlc_refinement(tmp_path) -> N...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_session_cache.py:128: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=10, final_only=Fals...
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:135: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_normalizes_bad_numeric_inputs(tmp_path) -> None...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:153: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history("600519", "1m", bars=10)
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:162: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_read_history_scrubs_outlier_jumps(tmp_path) -> ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_session_cache.py:197: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=10)
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:203: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_prefers_recent_segment_after_scale_regime_jump(...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_session_cache.py:223: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=50, final_only=True...
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:229: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_rejects_outlier_append_write(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:261: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=10)
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:267: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_final_only_salvages_legacy_non_final_rows(tmp_p...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_session_cache.py:302: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=10, final_only=True...
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:308: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_keeps_new_day_opening_gap_rows(tmp_path) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:343: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=10)
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:349: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_describe_and_purge_realtime_rows(tmp_path) -> N...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_session_cache.py:395: error: No overload variant of "int" matches
argument type "object"  [call-overload]
        assert int(info.get("rows", 0)) == 3
               ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:395: note: Possible overload variants:
tests\test_session_cache.py:395: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_session_cache.py:395: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_session_cache.py:403: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=10, final_only=Fals...
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:408: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_purge_realtime_rows_since_anchor(tmp_path) -> N...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_session_cache.py:452: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=10, final_only=Fals...
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:458: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_upsert_history_frame_adds_akshare_rows(tmp_path...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_session_cache.py:505: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=20, final_only=Fals...
             ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:512: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_append_compacts_when_row_cap_exceeded(tmp_path)...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_session_cache.py:546: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
            df = cache.read_history(symbol, interval, bars=50, final_only=...
                 ^~~~~~~~~~~~~~~~~~
tests\test_session_cache.py:556: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_session_cache_upsert_respects_row_limit_retention_policy(tmp_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_session_cache.py:594: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
            df = cache.read_history(symbol, interval, bars=400, final_only...
                 ^~~~~~~~~~~~~~~~~~
tests\test_regression_guards.py:7: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_regression_marketplace_skips_mismatch_hash(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_regression_guards.py:44: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_regression_session_cache_keeps_latest_duplicate_timestamp(tmp...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_regression_guards.py:77: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=10)
             ^~~~~~~~~~~~~~~~~~
tests\test_performance_smoke.py:8: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_performance_session_cache_append_smoke(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_performance_smoke.py:35: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_performance_session_cache_read_smoke(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_performance_smoke.py:56: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=500)
             ^~~~~~~~~~~~~~~~~~
tests\test_chaos_resilience.py:7: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_chaos_marketplace_invalid_json_falls_back(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_chaos_resilience.py:20: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_chaos_session_cache_invalid_rows_are_ignored(tmp_path) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_chaos_resilience.py:38: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        df = cache.read_history(symbol, interval, bars=10)
             ^~~~~~~~~~~~~~~~~~
tests\test_chaos_resilience.py:43: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_chaos_session_cache_rejects_nondict_bar(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_chaos_resilience.py:45: error: Argument 3 to "append_bar" of
"SessionBarCache" has incompatible type "None"; expected "dict[Any, Any]" 
[arg-type]
        assert cache.append_bar("600519", "1m", None) is False
                                                ^~~~
tests\test_chaos_resilience.py:46: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
        assert cache.read_history("600519", "1m", bars=10).empty
               ^~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:146: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
                    report_markers = dict(report.get("cache_markers") or {...
                                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:146: note: Possible overload variants:
data\fetcher_refresh_ops.py:146: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:146: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:146: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:146: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:146: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:146: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:146: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
data\fetcher_refresh_ops.py:146: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
data\fetcher_refresh_ops.py:236: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
                report_days = dict(report.get("fetched_days") or {})
                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:236: note: Possible overload variants:
data\fetcher_refresh_ops.py:236: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:236: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:236: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:236: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:236: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:236: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:236: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
data\fetcher_refresh_ops.py:236: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
data\fetcher_refresh_ops.py:367: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
                            report_anchor = dict(report.get("replacement_a...
                                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
data\fetcher_refresh_ops.py:367: note: Possible overload variants:
data\fetcher_refresh_ops.py:367: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:367: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:367: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:367: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:367: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:367: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:367: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
data\fetcher_refresh_ops.py:367: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
data\fetcher_refresh_ops.py:392: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
                    report_sync = dict(report.get("cache_sync_errors") or ...
                                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:392: note: Possible overload variants:
data\fetcher_refresh_ops.py:392: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:392: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:392: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:392: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:392: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:392: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:392: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
data\fetcher_refresh_ops.py:392: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
data\fetcher_refresh_ops.py:413: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
                report_purged = dict(report.get("purged_realtime_rows") or...
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
data\fetcher_refresh_ops.py:413: note: Possible overload variants:
data\fetcher_refresh_ops.py:413: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:413: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:413: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:413: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:413: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:413: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:413: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
data\fetcher_refresh_ops.py:413: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
data\fetcher_refresh_ops.py:416: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
                report_quorum = dict(report.get("quorum_blocked") or {})
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:416: note: Possible overload variants:
data\fetcher_refresh_ops.py:416: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:416: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:416: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:416: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:416: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:416: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:416: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
data\fetcher_refresh_ops.py:416: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
data\fetcher_refresh_ops.py:473: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
                report_rows = dict(report.get("rows") or {})
                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:473: note: Possible overload variants:
data\fetcher_refresh_ops.py:473: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:473: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:473: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:473: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:473: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:473: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:473: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
data\fetcher_refresh_ops.py:473: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
data\fetcher_refresh_ops.py:477: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
                report_status = dict(report.get("status") or {})
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:477: note: Possible overload variants:
data\fetcher_refresh_ops.py:477: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:477: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:477: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:477: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:477: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:477: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:477: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
data\fetcher_refresh_ops.py:477: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
data\fetcher_refresh_ops.py:480: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                    report["updated"] = int(report.get("updated", 0)) + 1
                                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:480: note: Possible overload variants:
data\fetcher_refresh_ops.py:480: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\fetcher_refresh_ops.py:480: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\fetcher_refresh_ops.py:485: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                    report["cached"] = int(report.get("cached", 0)) + 1
                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:485: note: Possible overload variants:
data\fetcher_refresh_ops.py:485: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\fetcher_refresh_ops.py:485: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\fetcher_refresh_ops.py:491: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
                report_status = dict(report.get("status") or {})
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:491: note: Possible overload variants:
data\fetcher_refresh_ops.py:491: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:491: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:491: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:491: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:491: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:491: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:491: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
data\fetcher_refresh_ops.py:491: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
data\fetcher_refresh_ops.py:494: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
                report_errors = dict(report.get("errors") or {})
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_refresh_ops.py:494: note: Possible overload variants:
data\fetcher_refresh_ops.py:494: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:494: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:494: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:494: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:494: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
data\fetcher_refresh_ops.py:494: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
data\fetcher_refresh_ops.py:494: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
data\fetcher_refresh_ops.py:494: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
data\fetcher_reconcile_ops.py:38: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _get_refresh_reconcile_lock(self) -> threading.RLock:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:41: error: Incompatible return value type (got
"Any | None", expected "RLock")  [return-value]
            return lock
                   ^~~~
data\fetcher_reconcile_ops.py:46: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _get_refresh_reconcile_path(self) -> Path:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:54: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _refresh_reconcile_key(self, code: str, interval: str) -> str:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:59: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _load_refresh_reconcile_queue(self) -> dict[str, dict[str, object]...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:101: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _save_refresh_reconcile_queue(self, queue: dict[str, dict[str, obj...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
data\fetcher_reconcile_ops.py:121: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _mark_refresh_reconcile_pending(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:135: error: No overload variant of "int" matches
argument type "object"  [call-overload]
        attempts = int(prev.get("attempts", 0) or 0) + 1
                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:135: note: Possible overload variants:
data\fetcher_reconcile_ops.py:135: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\fetcher_reconcile_ops.py:135: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\fetcher_reconcile_ops.py:152: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _clear_refresh_reconcile_pending(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:163: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def get_pending_reconcile_entries(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:181: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def get_pending_reconcile_codes(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:197: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def reconcile_pending_cache_sync(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:306: error: Argument "since_ts" to
"purge_realtime_rows" of "SessionBarCache" has incompatible type "object | Any";
expected "datetime | str | float | int | None"  [arg-type]
                                since_ts=rt_anchor,
                                         ^~~~~~~~~
data\fetcher_reconcile_ops.py:313: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                report["reconciled"] = int(report.get("reconciled", 0)) + ...
                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:313: note: Possible overload variants:
data\fetcher_reconcile_ops.py:313: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\fetcher_reconcile_ops.py:313: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\fetcher_reconcile_ops.py:317: error: No overload variant of "int" matches
argument type "object"  [call-overload]
                report["failed"] = int(report.get("failed", 0)) + 1
                                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_reconcile_ops.py:317: note: Possible overload variants:
data\fetcher_reconcile_ops.py:317: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
data\fetcher_reconcile_ops.py:317: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
data\bar_aggregator.py:53: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def _to_shanghai_naive(ts_raw) -> datetime:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\bar_aggregator.py:60: error: Incompatible types in assignment (expression
has type "timezone", variable has type "ZoneInfo")  [assignment]
                sh_tz = timezone.utc
                        ^~~~~~~~~~~~
data\bar_aggregator.py:92: error: Statement is unreachable  [unreachable]
                return False
                ^~~~~~~~~~~~
data\bar_aggregator.py:117: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def on_tick(self, quote) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\bar_aggregator.py:182: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _update_volume(self, bar: dict, quote) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\bar_aggregator.py:207: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _new_bar(self, quote) -> dict:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_health_monitor.py:10: error: Function is missing a return type
annotation  [no-untyped-def]
            def get_account(self):
            ^~~~~~~~~~~~~~~~~~~~~~
tests\test_health_monitor.py:27: error: Function is missing a return type
annotation  [no-untyped-def]
            def get_account(self):
            ^~~~~~~~~~~~~~~~~~~~~~
trading\executor_policy_ops.py:22: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _should_escalate_runtime_exception(self, exc: BaseException) -> bo...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_policy_ops.py:26: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _is_advanced_order_type(self, order_type: OrderType) -> bool:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_policy_ops.py:30: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _allow_order_type_emulation(self, requested: OrderType) -> tuple[b...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
trading\executor_policy_ops.py:50: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _broker_supports_order_type(self, order_type: OrderType) -> bool:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_history_flow_ops.py:20: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def get_history(
    ^~~~~~~~~~~~~~~~
data\fetcher_history_flow_ops.py:164: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _should_refresh_intraday_exact(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_history_flow_ops.py:225: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _fetch_history_with_depth_retry(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_history_flow_ops.py:308: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _accept_online_intraday_snapshot(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_history_flow_ops.py:378: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _get_history_cn_intraday(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_history_flow_ops.py:457: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _get_history_cn_intraday_exact(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher_history_flow_ops.py:523: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _get_history_cn_daily(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~
data\fetcher.py:1096: error: "SessionBarCache" has no attribute "read_history" 
[attr-defined]
                    cache.read_history(
                    ^~~~~~~~~~~~~~~~~~
data\fetcher.py:1193: error: Incompatible types in assignment (expression has
type "Quote | None", variable has type "Quote")  [assignment]
            best = filtered.get("best")
                   ^~~~~~~~~~~~~~~~~~~~
data\fetcher.py:1195: error: Statement is unreachable  [unreachable]
                return None
                ^~~~~~~~~~~
data\fetcher.py:1265: error: "DataSource" has no attribute "get_all_stocks" 
[attr-defined]
                        df = source.get_all_stocks()
                             ^~~~~~~~~~~~~~~~~~~~~
ui\app_common.py:97: error: "MainAppCommonMixin" has no attribute "predictor" 
[attr-defined]
                    if self.predictor is not None:
                       ^~~~~~~~~~~~~~
ui\app_common.py:98: error: "MainAppCommonMixin" has no attribute "predictor" 
[attr-defined]
                        if hasattr(self.predictor, "_trained_stock_last_tr...
                                   ^~~~~~~~~~~~~~
ui\app_common.py:102: error: "MainAppCommonMixin" has no attribute "predictor" 
[attr-defined]
                        ens = getattr(self.predictor, "ensemble", None)
                                      ^~~~~~~~~~~~~~
ui\app_common.py:132: error: "MainAppCommonMixin" has no attribute
"setGeometry"  [attr-defined]
                    self.setGeometry(80, 60, 1360, 780)
                    ^~~~~~~~~~~~~~~~
ui\app_common.py:139: error: "MainAppCommonMixin" has no attribute
"setGeometry"  [attr-defined]
                self.setGeometry(x, y, width, height)
                ^~~~~~~~~~~~~~~~
ui\app_common.py:141: error: "MainAppCommonMixin" has no attribute
"setGeometry"  [attr-defined]
                self.setGeometry(80, 60, 1360, 780)
                ^~~~~~~~~~~~~~~~
ui\app_common.py:145: error: "MainAppCommonMixin" has no attribute
"_active_workers"  [attr-defined]
            self._active_workers.add(worker)
            ^~~~~~~~~~~~~~~~~~~~
ui\app_common.py:148: error: "MainAppCommonMixin" has no attribute
"_active_workers"  [attr-defined]
                self._active_workers.discard(worker)
                ^~~~~~~~~~~~~~~~~~~~
ui\app_common.py:194: error: "MainAppCommonMixin" has no attribute
"_debug_console_last_emit"  [attr-defined]
                prev = float(self._debug_console_last_emit.get(key, 0.0))
                             ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_common.py:197: error: "MainAppCommonMixin" has no attribute
"_debug_console_last_emit"  [attr-defined]
                self._debug_console_last_emit[key] = now
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_chart_pipeline.py:748: error: Statement is unreachable  [unreachable]
                continue
                ^~~~~~~~
ui\app_analysis_ops.py:27: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
    def _quick_trade(self, pred: Any) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:32: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
    def _update_watchlist(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:96: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
    def _on_watchlist_click(
    ^~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:140: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _add_to_watchlist(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:175: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _remove_from_watchlist(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:193: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _analyze_stock(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:335: error: Function is missing a return type annotation
 [no-untyped-def]
        def analyze():
        ^~~~~~~~~~~~~~
ui\app_analysis_ops.py:350: error: "WorkerThread" has no attribute
"_request_seq"  [attr-defined]
        worker._request_seq = current_seq
        ^~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:357: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _on_analysis_done(self, pred: Any) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:646: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _on_analysis_error(self, error: str) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:657: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _update_details(self, pred: Any) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:910: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _add_to_history(self, pred: Any) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:926: error: Item "None" of "Any | None" has no attribute
"value"  [union-attr]
            signal.value if hasattr(signal, 'value') else str(signal)
            ^~~~~~~~~~~~
ui\app_analysis_ops.py:960: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _signal_to_direction(self, signal_text: str) -> str:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:984: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _compute_guess_profit(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:1047: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _refresh_guess_rows_for_symbol(self, code: str, price: float) -> N...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
ui\app_analysis_ops.py:1104: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _calculate_realtime_correct_guess_profit(self) -> dict[str, float]...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:1150: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _update_correct_guess_profit_ui(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:1196: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _scan_stocks(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_analysis_ops.py:1206: error: Function is missing a return type
annotation  [no-untyped-def]
        def scan():
        ^~~~~~~~~~~
ui\app_analysis_ops.py:1225: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _on_scan_done(self, picks: list[Any]) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_bar_ops.py:34: error: Module "data.fetcher" has no attribute
"BARS_PER_DAY"  [attr-defined]
            from data.fetcher import BARS_PER_DAY
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_bar_ops.py:49: error: Module "data.fetcher" has no attribute
"BARS_PER_DAY"  [attr-defined]
            from data.fetcher import BARS_PER_DAY
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_bar_ops.py:528: error: Statement is unreachable  [unreachable]
                continue
                ^~~~~~~~
ui\app_bar_ops.py:537: error: Returning Any from function declared to return
"str"  [no-any-return]
            return self._normalize_interval_token(fallback)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_bar_ops.py:539: error: Returning Any from function declared to return
"str"  [no-any-return]
        return self._normalize_interval_token(best_iv, fallback=fallback)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_bar_ops.py:642: error: Returning Any from function declared to return
"list[dict[str, Any]]"  [no-any-return]
        return out
        ^~~~~~~~~~
ui\app_bar_ops.py:1015: error: Returning Any from function declared to return
"list[dict[str, Any]]"  [no-any-return]
                return recovered
                ^~~~~~~~~~~~~~~~
ui\app_bar_ops.py:1026: error: Returning Any from function declared to return
"list[dict[str, Any]]"  [no-any-return]
        return arr_out
        ^~~~~~~~~~~~~~
ui\app_bar_ops.py:1132: error: Statement is unreachable  [unreachable]
                    continue
                    ^~~~~~~~
ui\app_bar_ops.py:1258: error: Returning Any from function declared to return
"list[dict[str, Any]]"  [no-any-return]
        return out
        ^~~~~~~~~~
tests\test_vpn_data_paths.py:32: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_discovery_tencent_semicolon_response(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_vpn_data_paths.py:42: error: Function is missing a type annotation 
[no-untyped-def]
            def get(url, timeout=10):
            ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_vpn_data_paths.py:84: error: Incompatible types in assignment
(expression has type
"def get(self, url: str | bytes, *, params: SupportsItems[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | Iterable[tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None]] | str | bytes | None = ..., data: Iterable[bytes] | str | bytes | SupportsRead[str | bytes] | list[tuple[Any, Any]] | tuple[tuple[Any, Any], ...] | Mapping[Any, Any] | None = ..., headers: Mapping[str, str | bytes | None] | None = ..., cookies: RequestsCookieJar | MutableMapping[str, str] | None = ..., files: Mapping[str, SupportsRead[str | bytes] | str | bytes | tuple[str | None, SupportsRead[str | bytes] | str | bytes] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str, Mapping[str, str]]] | Iterable[tuple[str, SupportsRead[str | bytes] | str | bytes | tuple[str | None, SupportsRead[str | bytes] | str | bytes] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str, Mapping[str, str]]]] | None = ..., auth: tuple[str, str] | AuthBase | Callable[[PreparedRequest], PreparedRequest] | None = ..., timeout: float | tuple[float | None, float | None] | None = ..., allow_redirects: bool = ..., proxies: MutableMapping[str, str] | None = ..., hooks: Mapping[str, Iterable[Callable[[Response], Any]] | Callable[[Response], Any]] | None = ..., stream: bool | None = ..., verify: bool | str | None = ..., cert: str | tuple[str, str] | None = ..., json: Any | None = ...) -> _Resp",
variable has type
"def get(self, url: str | bytes, *, params: SupportsItems[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | Iterable[tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None]] | str | bytes | None = ..., data: Iterable[bytes] | str | bytes | SupportsRead[str | bytes] | list[tuple[Any, Any]] | tuple[tuple[Any, Any], ...] | Mapping[Any, Any] | None = ..., headers: Mapping[str, str | bytes | None] | None = ..., cookies: RequestsCookieJar | MutableMapping[str, str] | None = ..., files: Mapping[str, SupportsRead[str | bytes] | str | bytes | tuple[str | None, SupportsRead[str | bytes] | str | bytes] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str, Mapping[str, str]]] | Iterable[tuple[str, SupportsRead[str | bytes] | str | bytes | tuple[str | None, SupportsRead[str | bytes] | str | bytes] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str, Mapping[str, str]]]] | None = ..., auth: tuple[str, str] | AuthBase | Callable[[PreparedRequest], PreparedRequest] | None = ..., timeout: float | tuple[float | None, float | None] | None = ..., allow_redirects: bool = ..., proxies: MutableMapping[str, str] | None = ..., hooks: Mapping[str, Iterable[Callable[[Response], Any]] | Callable[[Response], Any]] | None = ..., stream: bool | None = ..., verify: bool | str | None = ..., cert: str | tuple[str, str] | None = ..., json: Any | None = ...) -> Response")
 [assignment]
        src._session.get = lambda *args, **kwargs: _Resp()  # type: ignore...
                           ^
tests\test_vpn_data_paths.py:84: note: Error code "assignment" not covered by "type: ignore" comment
tests\test_vpn_data_paths.py:115: error: Incompatible types in assignment
(expression has type
"def get(self, url: str | bytes, *, params: SupportsItems[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | Iterable[tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None]] | str | bytes | None = ..., data: Iterable[bytes] | str | bytes | SupportsRead[str | bytes] | list[tuple[Any, Any]] | tuple[tuple[Any, Any], ...] | Mapping[Any, Any] | None = ..., headers: Mapping[str, str | bytes | None] | None = ..., cookies: RequestsCookieJar | MutableMapping[str, str] | None = ..., files: Mapping[str, SupportsRead[str | bytes] | str | bytes | tuple[str | None, SupportsRead[str | bytes] | str | bytes] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str, Mapping[str, str]]] | Iterable[tuple[str, SupportsRead[str | bytes] | str | bytes | tuple[str | None, SupportsRead[str | bytes] | str | bytes] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str, Mapping[str, str]]]] | None = ..., auth: tuple[str, str] | AuthBase | Callable[[PreparedRequest], PreparedRequest] | None = ..., timeout: float | tuple[float | None, float | None] | None = ..., allow_redirects: bool = ..., proxies: MutableMapping[str, str] | None = ..., hooks: Mapping[str, Iterable[Callable[[Response], Any]] | Callable[[Response], Any]] | None = ..., stream: bool | None = ..., verify: bool | str | None = ..., cert: str | tuple[str, str] | None = ..., json: Any | None = ...) -> _Resp",
variable has type
"def get(self, url: str | bytes, *, params: SupportsItems[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None] | Iterable[tuple[str | bytes | int | float, str | bytes | int | float | Iterable[str | bytes | int | float] | None]] | str | bytes | None = ..., data: Iterable[bytes] | str | bytes | SupportsRead[str | bytes] | list[tuple[Any, Any]] | tuple[tuple[Any, Any], ...] | Mapping[Any, Any] | None = ..., headers: Mapping[str, str | bytes | None] | None = ..., cookies: RequestsCookieJar | MutableMapping[str, str] | None = ..., files: Mapping[str, SupportsRead[str | bytes] | str | bytes | tuple[str | None, SupportsRead[str | bytes] | str | bytes] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str, Mapping[str, str]]] | Iterable[tuple[str, SupportsRead[str | bytes] | str | bytes | tuple[str | None, SupportsRead[str | bytes] | str | bytes] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str] | tuple[str | None, SupportsRead[str | bytes] | str | bytes, str, Mapping[str, str]]]] | None = ..., auth: tuple[str, str] | AuthBase | Callable[[PreparedRequest], PreparedRequest] | None = ..., timeout: float | tuple[float | None, float | None] | None = ..., allow_redirects: bool = ..., proxies: MutableMapping[str, str] | None = ..., hooks: Mapping[str, Iterable[Callable[[Response], Any]] | Callable[[Response], Any]] | None = ..., stream: bool | None = ..., verify: bool | str | None = ..., cert: str | tuple[str, str] | None = ..., json: Any | None = ...) -> Response")
 [assignment]
        src._session.get = lambda *args, **kwargs: _Resp()  # type: ignore...
                           ^
tests\test_vpn_data_paths.py:115: note: Error code "assignment" not covered by "type: ignore" comment
tests\test_source_selection.py:8: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_universe_tries_akshare_on_direct_china_even_if_probe_is_down(...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_source_selection.py:18: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_universe_skips_akshare_when_probe_is_down_offshore(monkeypatc...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_source_selection.py:28: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_akshare_source_requires_eastmoney_probe(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_source_selection.py:60: error: Argument 1 to "_source_health_score"
of "DataFetcher" has incompatible type "_DummySource"; expected "DataSource" 
[arg-type]
        t_score = fetcher._source_health_score(tencent, env)
                                               ^~~~~~~
tests\test_source_selection.py:61: error: Argument 1 to "_source_health_score"
of "DataFetcher" has incompatible type "_DummySource"; expected "DataSource" 
[arg-type]
        a_score = fetcher._source_health_score(akshare, env)
                                               ^~~~~~~
tests\test_source_selection.py:65: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_get_active_sources_filters_network_unsuitable_source(monkeypa...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_source_selection.py:81: error: Function is missing a return type
annotation  [no-untyped-def]
            def is_suitable_for_network(self):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_source_selection.py:86: error: List item 0 has incompatible type
"_Source"; expected "DataSource"  [list-item]
        fetcher._all_sources = [good, bad]
                                ^~~~
tests\test_source_selection.py:86: error: List item 1 has incompatible type
"_Source"; expected "DataSource"  [list-item]
        fetcher._all_sources = [good, bad]
                                      ^~~
tests\test_intraday_bad_data_guards.py:141: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_database_intraday_sanitizer_filters_bad_rows(tmp_path) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:23: error: Function is missing a return type annotation 
[no-untyped-def]
        def fetcher(self):
        ^~~~~~~~~~~~~~~~~~
tests\test_data.py:26: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_fetcher_initialization(self, fetcher) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:31: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_clean_code(self, fetcher) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:38: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_get_history_returns_dataframe(self, fetcher) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:48: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_cache_functionality(self, fetcher) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:57: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_yahoo_intraday_keeps_bar_count(self, monkeypatch) -> None...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:73: error: Function is missing a type annotation 
[no-untyped-def]
                def history(self, **kwargs):
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:77: error: Function is missing a type annotation 
[no-untyped-def]
                def Ticker(self, _):
                ^~~~~~~~~~~~~~~~~~~~
tests\test_data.py:115: error: Function is missing a return type annotation 
[no-untyped-def]
        def processor(self):
        ^~~~~~~~~~~~~~~~~~~~
tests\test_data.py:119: error: Function is missing a return type annotation 
[no-untyped-def]
        def sample_df(self):
        ^~~~~~~~~~~~~~~~~~~~
tests\test_data.py:137: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_create_labels(self, processor, sample_df) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:155: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_scaler_fitting(self, processor) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:164: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_transform_requires_fit(self, processor) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:171: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_transform_clips_values(self, processor) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:182: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_save_load_scaler(self, processor, tmp_path) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:196: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_load_scaler_prefers_safe_sidecar(self, processor, tmp_pat...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_data.py:206: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
            def _fail_pickle_load(*_args, **_kwargs) -> NoReturn:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:224: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_load_scaler_blocks_pickle_without_safe_sidecar(self, proc...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_data.py:251: error: Function is missing a return type annotation 
[no-untyped-def]
        def engine(self):
        ^~~~~~~~~~~~~~~~~
tests\test_data.py:255: error: Function is missing a return type annotation 
[no-untyped-def]
        def sample_ohlcv(self):
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:270: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_create_features(self, engine, sample_ohlcv) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:279: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_no_nan_in_features(self, engine, sample_ohlcv) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data.py:288: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def test_feature_count(self, engine) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_constants_time_guards.py:33: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_is_trading_day_future_year_uses_dynamic_provider(monkeypatch)...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_constants_time_guards.py:36: error: Function is missing a return
type annotation  [no-untyped-def]
            def country_holidays(country: str, years: list[int]):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_constants_time_guards.py:43: error: Function is missing a return
type annotation  [no-untyped-def]
        def _fake_import_module(name: str):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_constants_time_guards.py:58: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_fetcher_now_shanghai_fallback_keeps_utc_plus_8(monkeypatch) -...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_constants_time_guards.py:61: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_import(name, globals=None, locals=None, fromlist=(), lev...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_constants_time_guards.py:73: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_is_market_open_tolerates_trading_day_runtime_error(monkeypatc...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_constants_time_guards.py:76: error: Function is missing a type
annotation  [no-untyped-def]
            def now(cls, tz=None):
            ^~~~~~~~~~~~~~~~~~~~~~
tests\test_constants_time_guards.py:82: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _boom(_d) -> NoReturn:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_flow_ops.py:19: error: Module "data.fetcher" has no
attribute "BARS_PER_DAY"  [attr-defined]
            from data.fetcher import BARS_PER_DAY, INTERVAL_MAX_DAYS
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_flow_ops.py:19: error: Module "data.fetcher" has no
attribute "INTERVAL_MAX_DAYS"  [attr-defined]
            from data.fetcher import BARS_PER_DAY, INTERVAL_MAX_DAYS
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_flow_ops.py:69: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
            df = cache.read_history(
                 ^~~~~~~~~~~~~~~~~~
data\feeds.py:133: error: Incompatible types in assignment (expression has type
"DataFetcher", variable has type "None")  [assignment]
                self._fetcher = get_fetcher()
                                ^~~~~~~~~~~~~
data\feeds.py:184: error: "object" has no attribute "timestamp"  [attr-defined]
                                    quote.timestamp = now_ts
                                    ^~~~~~~~~~~~~~~
data\feeds.py:194: error: "object" has no attribute "price"  [attr-defined]
                                        price=float(quote.price),
                                                    ^~~~~~~~~~~
data\feeds.py:416: error: Statement is unreachable  [unreachable]
                try:
                ^~~~
data\feeds.py:541: error: Incompatible types in assignment (expression has type
"WebSocketApp", variable has type "None")  [assignment]
                self._ws = websocket.WebSocketApp(
                           ^~~~~~~~~~~~~~~~~~~~~~~
data\feeds.py:555: error: "None" has no attribute "run_forever"  [attr-defined]
                    target=self._ws.run_forever,
                           ^~~~~~~~~~~~~~~~~~~~
data\feeds.py:581: error: Statement is unreachable  [unreachable]
                try:
                ^~~~
data\feeds.py:596: error: Right operand of "and" is never evaluated 
[unreachable]
                if self._ws and self.status == FeedStatus.CONNECTED:
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\feeds.py:597: error: Statement is unreachable  [unreachable]
                    self._send_subscribe(symbol)
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\feeds.py:604: error: Right operand of "and" is never evaluated 
[unreachable]
                if self._ws and self.status == FeedStatus.CONNECTED:
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\feeds.py:605: error: Statement is unreachable  [unreachable]
                    try:
                    ^~~~
data\feeds.py:617: error: "None" has no attribute "send"  [attr-defined]
                self._ws.send(
                ^~~~~~~~~~~~~
data\feeds.py:734: error: Statement is unreachable  [unreachable]
                return
                ^~~~~~
data\feeds.py:809: error: Statement is unreachable  [unreachable]
                        ws.send('{"action":"heartbeat"}')
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\feeds.py:907: error: Cannot determine type of "_initialized"  [has-type]
                        cls._instance._initialized = False
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~
data\feeds.py:911: error: Cannot determine type of "_initialized"  [has-type]
            if self._initialized:
               ^~~~~~~~~~~~~~~~~
data\feeds.py:1016: error: Incompatible types in assignment (expression has
type "DataFeed | None", variable has type "DataFeed")  [assignment]
            feed = self._active_feed
                   ^~~~~~~~~~~~~~~~~
data\feeds.py:1018: error: Statement is unreachable  [unreachable]
                return
                ^~~~~~
data\feeds.py:1322: error: Returning Any from function declared to return
"datetime | None"  [no-any-return]
                return quote.timestamp
                ^~~~~~~~~~~~~~~~~~~~~~
ui\app_monitoring_ops.py:236: error: "object" has no attribute "price" 
[attr-defined]
                self._on_price_updated(code, float(quote.price))
                                                   ^~~~~~~~~~~
ui\app_feed_ops.py:20: error: Function is missing a return type annotation 
[no-untyped-def]
    def _get_feed_manager_cached():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_feed_ops.py:36: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def _ensure_feed_subscription(self, code: str) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_feed_ops.py:64: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def _on_bar_from_feed(self, symbol: str, bar: dict[str, Any]) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_feed_ops.py:82: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def _on_tick_from_feed(self, quote: Any) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_feed_ops.py:111: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def _on_bar_ui(self, symbol: str, bar: dict[str, Any]) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_feed_ops.py:414: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def _render_live_bar_update(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_feed_ops.py:443: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
    def _update_chart_latest_label(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_feed_manager_watchdog.py:7: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _is_watchdog_alive(thread_obj) -> bool:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_feed_manager_watchdog.py:98: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_websocket_feed_can_be_forced_off_with_env(monkeypatch) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_feed_manager_watchdog.py:106: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_websocket_feed_connect_blocked_on_vpn(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_feed_manager_watchdog.py:120: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_websocket_feed_connect_blocked_when_ws_host_dns_fails(monkeyp...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_feed_manager_watchdog.py:135: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_websocket_feed_host_resolves_timeout_returns_unknown_as_true(...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_feed_manager_watchdog.py:149: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_websocket_feed_host_resolves_uses_cache(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_feed_manager_watchdog.py:171: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_polling_feed_batch_invalid_quote_falls_back_to_single_fetch(m...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_feed_manager_watchdog.py:178: error: Function is missing a type
annotation  [no-untyped-def]
            def get_realtime_batch(self, symbols):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_feed_manager_watchdog.py:181: error: Function is missing a type
annotation  [no-untyped-def]
            def get_realtime(self, symbol):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_feed_manager_watchdog.py:187: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def get_quote(symbol) -> None:  # noqa: ARG004
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_bar_aggregator_interval.py:44: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_emit_bar_market_open_writes_session_only(monkeypatch) -> None...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_bar_aggregator_interval.py:51: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def append_bar(self, symbol, interval, bar) -> bool:  # noqa: ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_bar_aggregator_interval.py:59: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_intraday_bars(self, symbol, interval, df) -> None: ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_bar_aggregator_interval.py:75: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_emit_bar_market_closed_persists_to_db(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_bar_aggregator_interval.py:82: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def append_bar(self, symbol, interval, bar) -> bool:  # noqa: ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_bar_aggregator_interval.py:90: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_intraday_bars(self, symbol, interval, df) -> None: ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
data\__init__.py:3: error: Function is missing a return type annotation 
[no-untyped-def]
    def __getattr__(name: str):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:15: error: Need type annotation for "_store"
(hint: "_store: dict[<type>, <type>] = ...")  [var-annotated]
            self._store = {}
            ^~~~~~~~~~~
tests\test_fetcher_resilience.py:17: error: Function is missing a type
annotation  [no-untyped-def]
        def get(self, key, ttl):  # noqa: ARG002
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:20: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def set(self, key, value) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:49: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        f._cache = _DummyCache()
                   ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:53: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_realtime_batch_uses_non_tencent_batch_fallback_when_tencent_p...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:60: error: Function is missing a type
annotation  [no-untyped-def]
            def get_realtime_batch(self, codes):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:68: error: Function is missing a type
annotation  [no-untyped-def]
            def get_realtime_batch(self, codes):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:73: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: [_Tencent(), _Other()]
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:73: error: List item 0 has incompatible type
"_Tencent"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [_Tencent(), _Other()]
                                               ^~~~~~~~~~
tests\test_fetcher_resilience.py:73: error: List item 1 has incompatible type
"_Other"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [_Tencent(), _Other()]
                                                           ^~~~~~~~
tests\test_fetcher_resilience.py:74: error: Cannot assign to a method 
[method-assign]
        fetcher._fill_from_spot_cache = lambda missing, result: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:75: error: Cannot assign to a method 
[method-assign]
        fetcher._fill_from_single_source_quotes = lambda missing, result, ...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:76: error: Cannot assign to a method 
[method-assign]
        fetcher._maybe_force_network_refresh = lambda: False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:77: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_good = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:78: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_close_from_db = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:87: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_realtime_batch_uses_non_tencent_single_quote_for_missing(monk...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:94: error: Function is missing a type
annotation  [no-untyped-def]
            def get_realtime_batch(self, codes):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:101: error: Function is missing a type
annotation  [no-untyped-def]
            def get_realtime(code):
            ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:106: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: [_Tencent(), _Yahoo()]
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:106: error: List item 0 has incompatible type
"_Tencent"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [_Tencent(), _Yahoo()]
                                               ^~~~~~~~~~
tests\test_fetcher_resilience.py:106: error: List item 1 has incompatible type
"_Yahoo"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [_Tencent(), _Yahoo()]
                                                           ^~~~~~~~
tests\test_fetcher_resilience.py:107: error: Cannot assign to a method 
[method-assign]
        fetcher._fill_from_spot_cache = lambda missing, result: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:108: error: Cannot assign to a method 
[method-assign]
        fetcher._maybe_force_network_refresh = lambda: False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:109: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_good = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:110: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_close_from_db = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:118: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_realtime_batch_drops_stale_localdb_last_close_by_default(monk...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:123: error: Function is missing a return type
annotation  [no-untyped-def]
            def get_bars(self, code: str, limit: int = 1):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:139: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = _DB()
                      ^~~~~
tests\test_fetcher_resilience.py:140: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: []
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:141: error: Cannot assign to a method 
[method-assign]
        fetcher._fill_from_spot_cache = lambda missing, result: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:142: error: Cannot assign to a method 
[method-assign]
        fetcher._fill_from_single_source_quotes = lambda missing, result, ...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:143: error: Cannot assign to a method 
[method-assign]
        fetcher._maybe_force_network_refresh = lambda: False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:144: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_good = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:151: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_realtime_batch_partial_missing_keeps_fresh_last_good_only(mon...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:158: error: Function is missing a type
annotation  [no-untyped-def]
            def get_realtime_batch(self, codes):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:164: error: Function is missing a return type
annotation  [no-untyped-def]
            def get_bars(self, code: str, limit: int = 1):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:180: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = _DB()
                      ^~~~~
tests\test_fetcher_resilience.py:181: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: [_S1()]
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:181: error: List item 0 has incompatible type
"_S1"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [_S1()]
                                               ^~~~~
tests\test_fetcher_resilience.py:182: error: Cannot assign to a method 
[method-assign]
        fetcher._fill_from_spot_cache = lambda missing, result: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:183: error: Cannot assign to a method 
[method-assign]
        fetcher._fill_from_single_source_quotes = lambda missing, result, ...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:184: error: Cannot assign to a method 
[method-assign]
        fetcher._maybe_force_network_refresh = lambda: False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:194: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_realtime_batch_allows_stale_localdb_when_explicitly_opted_in(...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:200: error: Function is missing a return type
annotation  [no-untyped-def]
            def get_bars(self, code: str, limit: int = 1):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:216: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = _DB()
                      ^~~~~
tests\test_fetcher_resilience.py:217: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: []
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:218: error: Cannot assign to a method 
[method-assign]
        fetcher._fill_from_spot_cache = lambda missing, result: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:219: error: Cannot assign to a method 
[method-assign]
        fetcher._fill_from_single_source_quotes = lambda missing, result, ...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:220: error: Cannot assign to a method 
[method-assign]
        fetcher._maybe_force_network_refresh = lambda: False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:221: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_good = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:231: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_realtime_batch_uses_spot_cache_when_tencent_missing(monkeypat...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:239: error: Function is missing a type
annotation  [no-untyped-def]
            def get_quote(code):
            ^~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:255: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: []
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:256: error: Cannot assign to a method 
[method-assign]
        fetcher._maybe_force_network_refresh = lambda: False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:257: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_good = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:258: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_close_from_db = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:269: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_realtime_batch_spot_cache_tolerates_malformed_values(monkeypa...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:277: error: Function is missing a type
annotation  [no-untyped-def]
            def get_quote(code):
            ^~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:299: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: []
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:300: error: Cannot assign to a method 
[method-assign]
        fetcher._maybe_force_network_refresh = lambda: False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:301: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_good = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:302: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_close_from_db = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:316: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_realtime_batch_drops_stale_spot_cache_snapshot(monkeypatch) -...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:326: error: Function is missing a type
annotation  [no-untyped-def]
            def get_quote(code):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:340: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: []
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:341: error: Cannot assign to a method 
[method-assign]
        fetcher._maybe_force_network_refresh = lambda: False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:342: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_good = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:343: error: Cannot assign to a method 
[method-assign]
        fetcher._fallback_last_close_from_db = lambda codes: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:366: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_data_source_half_open_probe_during_cooldown(monkeypatch) -> N...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:387: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_fetch(inst, days, interval):  # noqa: ARG001
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:402: error: Cannot assign to a method 
[method-assign]
        fetcher._fetch_from_sources_instrument = _fake_fetch
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:402: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any, Any], Any]", variable has type
"Callable[[dict[str, Any], int, str, bool, bool], Any | tuple[Any, dict[str, Any]]]")
 [assignment]
        fetcher._fetch_from_sources_instrument = _fake_fetch
                                                 ^~~~~~~~~~~
tests\test_fetcher_resilience.py:419: error: Cannot assign to a method 
[method-assign]
        fetcher._rate_limit = lambda source, interval: None  # noqa: ARG00...
        ^~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:419: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any], None]", variable has type
"Callable[[str, str], None]")  [assignment]
        fetcher._rate_limit = lambda source, interval: None  # noqa: ARG00...
                              ^
tests\test_fetcher_resilience.py:441: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history_instrument(self, inst, days, interval="1d"):  ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:452: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history_instrument(self, inst, days, interval="1d"):  ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:463: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history_instrument(self, inst, days, interval="1d"):  ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:472: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: [localdb, tencent, akshare]
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:472: error: List item 0 has incompatible type
"_Local"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [localdb, tencent, akshare]
                                               ^~~~~~~
tests\test_fetcher_resilience.py:472: error: List item 1 has incompatible type
"_Tencent"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [localdb, tencent, akshare]
                                                        ^~~~~~~
tests\test_fetcher_resilience.py:472: error: List item 2 has incompatible type
"_Akshare"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [localdb, tencent, akshare]
                                                                 ^~~~~~~
tests\test_fetcher_resilience.py:473: error: List item 0 has incompatible type
"_Local"; expected "DataSource"  [list-item]
        fetcher._all_sources = [localdb, tencent, akshare]
                                ^~~~~~~
tests\test_fetcher_resilience.py:473: error: List item 1 has incompatible type
"_Tencent"; expected "DataSource"  [list-item]
        fetcher._all_sources = [localdb, tencent, akshare]
                                         ^~~~~~~
tests\test_fetcher_resilience.py:473: error: List item 2 has incompatible type
"_Akshare"; expected "DataSource"  [list-item]
        fetcher._all_sources = [localdb, tencent, akshare]
                                                  ^~~~~~~
tests\test_fetcher_resilience.py:482: error: Item
"tuple[Any | dict[str, Any], ...]" of "Any | tuple[Any, dict[str, Any]]" has no
attribute "empty"  [union-attr]
        assert not out.empty
                   ^~~~~~~~~
tests\test_fetcher_resilience.py:490: error: Cannot assign to a method 
[method-assign]
        fetcher._rate_limit = lambda source, interval: None  # noqa: ARG00...
        ^~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:490: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any], None]", variable has type
"Callable[[str, str], None]")  [assignment]
        fetcher._rate_limit = lambda source, interval: None  # noqa: ARG00...
                              ^
tests\test_fetcher_resilience.py:508: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history_instrument(self, inst, days, interval="1d"):  ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:512: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: [src]
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:512: error: List item 0 has incompatible type
"_Tencent"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [src]
                                               ^~~
tests\test_fetcher_resilience.py:513: error: List item 0 has incompatible type
"_Tencent"; expected "DataSource"  [list-item]
        fetcher._all_sources = [src]
                                ^~~
tests\test_fetcher_resilience.py:521: error: Item
"tuple[Any | dict[str, Any], ...]" of "Any | tuple[Any, dict[str, Any]]" has no
attribute "empty"  [union-attr]
        assert not out.empty
                   ^~~~~~~~~
tests\test_fetcher_resilience.py:527: error: Cannot assign to a method 
[method-assign]
        fetcher._rate_limit = lambda source, interval: None  # noqa: ARG00...
        ^~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:527: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any], None]", variable has type
"Callable[[str, str], None]")  [assignment]
        fetcher._rate_limit = lambda source, interval: None  # noqa: ARG00...
                              ^
tests\test_fetcher_resilience.py:562: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history_instrument(self, inst, days, interval="1d"):  ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:572: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history_instrument(self, inst, days, interval="1d"):  ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:578: error: Cannot assign to a method 
[method-assign]
        fetcher._get_active_sources = lambda: [tencent, sina]
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:578: error: List item 0 has incompatible type
"_Tencent"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [tencent, sina]
                                               ^~~~~~~
tests\test_fetcher_resilience.py:578: error: List item 1 has incompatible type
"_Sina"; expected "DataSource"  [list-item]
        fetcher._get_active_sources = lambda: [tencent, sina]
                                                        ^~~~
tests\test_fetcher_resilience.py:579: error: List item 0 has incompatible type
"_Tencent"; expected "DataSource"  [list-item]
        fetcher._all_sources = [tencent, sina]
                                ^~~~~~~
tests\test_fetcher_resilience.py:579: error: List item 1 has incompatible type
"_Sina"; expected "DataSource"  [list-item]
        fetcher._all_sources = [tencent, sina]
                                         ^~~~
tests\test_fetcher_resilience.py:588: error: Item
"tuple[Any | dict[str, Any], ...]" of "Any | tuple[Any, dict[str, Any]]" has no
attribute "empty"  [union-attr]
        assert not out.empty
                   ^~~~~~~~~
tests\test_fetcher_resilience.py:595: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        fetcher._cache = _DummyCache()
                         ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:615: error: Function is missing a type
annotation  [no-untyped-def]
            def get_bars(code, limit=1000):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:618: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_bars(self, code, df) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:622: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = db
                      ^~
tests\test_fetcher_resilience.py:653: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        fetcher._cache = _DummyCache()
                         ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:673: error: Function is missing a type
annotation  [no-untyped-def]
            def get_bars(code, limit=1000):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:676: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_bars(self, code, df) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:680: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = db
                      ^~
tests\test_fetcher_resilience.py:709: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_sina_source_parses_kline_payload(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:738: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_sina_source_not_available_off_china_direct(monkeypatch) -> No...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:747: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_sina_source_parses_jsonp_wrapper(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:776: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        fetcher._cache = _DummyCache()
                         ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:790: error: Cannot assign to a method 
[method-assign]
        fetcher._get_session_history = lambda symbol, interval, bars: sess...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:793: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_intraday(inst, count, fetch_days, interval, cache_key, o...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:807: error: Cannot assign to a method 
[method-assign]
        fetcher._get_history_cn_intraday = _fake_intraday
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:807: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any, Any, Any, Any, Any, Any], Any]",
variable has type
"def _get_history_cn_intraday(self, inst: dict[str, Any], count: int, fetch_days: int, interval: str, cache_key: str, offline: bool, session_df: Any | None = ..., *, persist_intraday_db: bool = ...) -> Any")
 [assignment]
        fetcher._get_history_cn_intraday = _fake_intraday
                                           ^~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:832: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        fetcher._cache = _DummyCache()
                         ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:846: error: Cannot assign to a method 
[method-assign]
        fetcher._get_session_history = lambda symbol, interval, bars: sess...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:847: error: Cannot assign to a method 
[method-assign]
        fetcher._should_refresh_intraday_exact = lambda **kwargs: True
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:851: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_exact(inst, count, fetch_days, interval, cache_key, offl...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:855: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_intraday(inst, count, fetch_days, interval, cache_key, o...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:859: error: Cannot assign to a method 
[method-assign]
        fetcher._get_history_cn_intraday_exact = _fake_exact
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:860: error: Cannot assign to a method 
[method-assign]
        fetcher._get_history_cn_intraday = _fake_intraday
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:860: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any, Any, Any, Any, Any, Any], Any]",
variable has type
"def _get_history_cn_intraday(self, inst: dict[str, Any], count: int, fetch_days: int, interval: str, cache_key: str, offline: bool, session_df: Any | None = ..., *, persist_intraday_db: bool = ...) -> Any")
 [assignment]
        fetcher._get_history_cn_intraday = _fake_intraday
                                           ^~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:876: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_get_history_intraday_market_open_skips_db_persist(monkeypatch...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:878: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        fetcher._cache = _DummyCache()
                         ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:879: error: Cannot assign to a method 
[method-assign]
        fetcher._get_session_history = lambda symbol, interval, bars: pd.D...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:880: error: Cannot assign to a method 
[method-assign]
        fetcher._should_refresh_intraday_exact = lambda **kwargs: False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:884: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_intraday(
        ^~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:895: error: Incompatible types in assignment
(expression has type "bool", target has type "None")  [assignment]
            captured["persist"] = bool(persist_intraday_db)
                                  ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:908: error: Cannot assign to a method 
[method-assign]
        fetcher._get_history_cn_intraday = _fake_intraday
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:908: error: Incompatible types in assignment
(expression has type
"def _fake_intraday(inst: Any, count: Any, fetch_days: Any, interval: Any, cache_key: Any, offline: Any, session: Any, *, persist_intraday_db: Any = ...) -> Any",
variable has type
"def _get_history_cn_intraday(self, inst: dict[str, Any], count: int, fetch_days: int, interval: str, cache_key: str, offline: bool, session_df: Any | None = ..., *, persist_intraday_db: bool = ...) -> Any")
 [assignment]
        fetcher._get_history_cn_intraday = _fake_intraday
                                           ^~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:923: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_get_history_intraday_market_closed_allows_db_persist(monkeypa...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:925: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        fetcher._cache = _DummyCache()
                         ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:926: error: Cannot assign to a method 
[method-assign]
        fetcher._get_session_history = lambda symbol, interval, bars: pd.D...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:927: error: Cannot assign to a method 
[method-assign]
        fetcher._should_refresh_intraday_exact = lambda **kwargs: False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:931: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_intraday(
        ^~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:942: error: Incompatible types in assignment
(expression has type "bool", target has type "None")  [assignment]
            captured["persist"] = bool(persist_intraday_db)
                                  ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:955: error: Cannot assign to a method 
[method-assign]
        fetcher._get_history_cn_intraday = _fake_intraday
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:955: error: Incompatible types in assignment
(expression has type
"def _fake_intraday(inst: Any, count: Any, fetch_days: Any, interval: Any, cache_key: Any, offline: Any, session: Any, *, persist_intraday_db: Any = ...) -> Any",
variable has type
"def _get_history_cn_intraday(self, inst: dict[str, Any], count: int, fetch_days: int, interval: str, cache_key: str, offline: bool, session_df: Any | None = ..., *, persist_intraday_db: bool = ...) -> Any")
 [assignment]
        fetcher._get_history_cn_intraday = _fake_intraday
                                           ^~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:972: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        fetcher._cache = _DummyCache()
                         ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:990: error: Function is missing a type
annotation  [no-untyped-def]
            def get_intraday_bars(code, interval="1m", limit=1000):  # noq...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:993: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = _DB()
                      ^~~~~
tests\test_fetcher_resilience.py:1012: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        fetcher._cache = _DummyCache()
                         ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1041: error: Function is missing a type
annotation  [no-untyped-def]
            def get_intraday_bars(code, interval="1m", limit=1000):  # noq...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1044: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = _DB()
                      ^~~~~
tests\test_fetcher_resilience.py:1045: error: Cannot assign to a method 
[method-assign]
        fetcher._fetch_history_with_depth_retry = lambda **kwargs: weak_on...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1064: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        fetcher._cache = _DummyCache()
                         ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1065: error: Cannot assign to a method 
[method-assign]
        fetcher._get_session_history = lambda symbol, interval, bars: pd.D...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1069: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_intraday(inst, count, fetch_days, interval, cache_key, o...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1083: error: Cannot assign to a method 
[method-assign]
        fetcher._get_history_cn_intraday = _fake_intraday
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1083: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any, Any, Any, Any, Any, Any], Any]",
variable has type
"def _get_history_cn_intraday(self, inst: dict[str, Any], count: int, fetch_days: int, interval: str, cache_key: str, offline: bool, session_df: Any | None = ..., *, persist_intraday_db: bool = ...) -> Any")
 [assignment]
        fetcher._get_history_cn_intraday = _fake_intraday
                                           ^~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1098: error: Incompatible types in assignment
(expression has type "_DummyCache", variable has type "TieredCache") 
[assignment]
        fetcher._cache = _DummyCache()
                         ^~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1099: error: Cannot assign to a method 
[method-assign]
        fetcher._get_session_history = (
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1105: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_daily(  # noqa: ARG001
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1115: error: Unsupported operand types for +
("object" and "int")  [operator]
            called["daily"] += 1
            ^
tests\test_fetcher_resilience.py:1130: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_intraday(  # noqa: ARG001
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1141: error: Unsupported operand types for +
("object" and "int")  [operator]
            called["intraday"] += 1
            ^
tests\test_fetcher_resilience.py:1144: error: Cannot assign to a method 
[method-assign]
        fetcher._get_history_cn_daily = _fake_daily
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1145: error: Cannot assign to a method 
[method-assign]
        fetcher._get_history_cn_intraday = _fake_intraday
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1145: error: Incompatible types in assignment
(expression has type
"def _fake_intraday(inst: Any, count: Any, fetch_days: Any, interval: Any, cache_key: Any, offline: Any, session: Any, *, persist_intraday_db: Any = ...) -> Any",
variable has type
"def _get_history_cn_intraday(self, inst: dict[str, Any], count: int, fetch_days: int, interval: str, cache_key: str, offline: bool, session_df: Any | None = ..., *, persist_intraday_db: bool = ...) -> Any")
 [assignment]
        fetcher._get_history_cn_intraday = _fake_intraday
                                           ^~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1160: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_network_force_refresh_is_rate_limited(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1167: error: Function is missing a return type
annotation  [no-untyped-def]
        def _fake_get_network_env(force_refresh: bool = False):  # noqa: A...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1265: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_fetch(inst, days, interval, include_localdb=True):  # no...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1293: error: Cannot assign to a method 
[method-assign]
        fetcher._fetch_from_sources_instrument = _fake_fetch
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1293: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any, Any, Any], Any]", variable has type
"Callable[[dict[str, Any], int, str, bool, bool], Any | tuple[Any, dict[str, Any]]]")
 [assignment]
        fetcher._fetch_from_sources_instrument = _fake_fetch
                                                 ^~~~~~~~~~~
tests\test_fetcher_resilience.py:1307: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_refresh_trained_stock_history_uses_last_saved_increment(monke...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1338: error: Function is missing a type
annotation  [no-untyped-def]
            def get_intraday_bars(self, code, interval="1m", limit=1000): ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1341: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_intraday_bars(self, code, interval, df) -> None:  #...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1346: error: Function is missing a type
annotation  [no-untyped-def]
            def get_bars(self, code, limit=1000):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1349: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_bars(self, code, df) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1352: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = _DB(base_df)
                      ^~~~~~~~~~~~
tests\test_fetcher_resilience.py:1355: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_fetch(inst, days, interval="1m", include_localdb=False):...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1370: error: Cannot assign to a method 
[method-assign]
        fetcher._fetch_from_sources_instrument = _fake_fetch
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1370: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any, Any, Any], Any]", variable has type
"Callable[[dict[str, Any], int, str, bool, bool], Any | tuple[Any, dict[str, Any]]]")
 [assignment]
        fetcher._fetch_from_sources_instrument = _fake_fetch
                                                 ^~~~~~~~~~~
tests\test_fetcher_resilience.py:1379: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(out["total"]) == 1
               ^~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1379: note: Possible overload variants:
tests\test_fetcher_resilience.py:1379: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_fetcher_resilience.py:1379: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_fetcher_resilience.py:1380: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(out["updated"]) == 1
               ^~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1380: note: Possible overload variants:
tests\test_fetcher_resilience.py:1380: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_fetcher_resilience.py:1380: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_fetcher_resilience.py:1383: error: No overload variant of "dict"
matches argument type "object"  [call-overload]
        rows = dict(out.get("rows", {}) or {})
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1383: note: Possible overload variants:
tests\test_fetcher_resilience.py:1383: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1383: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1383: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1383: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1383: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1383: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1383: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
tests\test_fetcher_resilience.py:1383: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
tests\test_fetcher_resilience.py:1387: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_refresh_trained_stock_history_replaces_realtime_cache_after_c...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1406: error: Function is missing a type
annotation  [no-untyped-def]
            def get_intraday_bars(self, code, interval="1m", limit=1000): ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1411: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_intraday_bars(self, code, interval, df) -> None:  #...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1416: error: Function is missing a type
annotation  [no-untyped-def]
            def get_bars(self, code, limit=1000):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1419: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_bars(self, code, df) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1422: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = _DB()
                      ^~~~~
tests\test_fetcher_resilience.py:1425: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_fetch(inst, days, interval="1m", include_localdb=False):...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1440: error: Cannot assign to a method 
[method-assign]
        fetcher._fetch_from_sources_instrument = _fake_fetch
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1440: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any, Any, Any], Any]", variable has type
"Callable[[dict[str, Any], int, str, bool, bool], Any | tuple[Any, dict[str, Any]]]")
 [assignment]
        fetcher._fetch_from_sources_instrument = _fake_fetch
                                                 ^~~~~~~~~~~
tests\test_fetcher_resilience.py:1445: error: Need type annotation for
"upsert_calls" (hint: "upsert_calls: list[<type>] = ...")  [var-annotated]
                self.upsert_calls = []
                ^~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1446: error: Need type annotation for
"purge_kwargs" (hint: "purge_kwargs: list[<type>] = ...")  [var-annotated]
                self.purge_kwargs = []
                ^~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1448: error: Function is missing a type
annotation  [no-untyped-def]
            def describe_symbol_interval(self, symbol, interval):  # noqa:...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1458: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def purge_realtime_rows(self, symbol, interval, *, since_ts=No...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1463: error: Function is missing a type
annotation  [no-untyped-def]
            def upsert_history_frame(
            ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1486: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(out["total"]) == 1
               ^~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1486: note: Possible overload variants:
tests\test_fetcher_resilience.py:1486: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_fetcher_resilience.py:1486: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_fetcher_resilience.py:1496: error: No overload variant of "dict"
matches argument type "object"  [call-overload]
        purged = dict(out.get("purged_realtime_rows", {}) or {})
                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1496: note: Possible overload variants:
tests\test_fetcher_resilience.py:1496: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1496: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1496: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1496: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1496: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1496: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1496: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
tests\test_fetcher_resilience.py:1496: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
tests\test_fetcher_resilience.py:1498: error: No overload variant of "dict"
matches argument type "object"  [call-overload]
        used = dict(out.get("replacement_anchor_used", {}) or {})
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1498: note: Possible overload variants:
tests\test_fetcher_resilience.py:1498: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1498: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1498: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1498: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1498: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1498: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1498: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
tests\test_fetcher_resilience.py:1498: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
tests\test_fetcher_resilience.py:1502: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_refresh_trained_stock_history_retries_pending_cache_sync(monk...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1523: error: Function is missing a type
annotation  [no-untyped-def]
            def get_intraday_bars(self, code, interval="1m", limit=1000): ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1528: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_intraday_bars(self, code, interval, df) -> None:  #...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1533: error: Function is missing a type
annotation  [no-untyped-def]
            def get_bars(self, code, limit=1000):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1536: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_bars(self, code, df) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1539: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = _DB()
                      ^~~~~
tests\test_fetcher_resilience.py:1541: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_fetch(inst, days, interval="1m", include_localdb=False):...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1555: error: Cannot assign to a method 
[method-assign]
        fetcher._fetch_from_sources_instrument = _fake_fetch
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1555: error: Incompatible types in assignment
(expression has type "Callable[[Any, Any, Any, Any], Any]", variable has type
"Callable[[dict[str, Any], int, str, bool, bool], Any | tuple[Any, dict[str, Any]]]")
 [assignment]
        fetcher._fetch_from_sources_instrument = _fake_fetch
                                                 ^~~~~~~~~~~
tests\test_fetcher_resilience.py:1558: error: Function is missing a type
annotation  [no-untyped-def]
            def describe_symbol_interval(self, symbol, interval):  # noqa:...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1568: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def upsert_history_frame(
            ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1578: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def purge_realtime_rows(self, symbol, interval, *, since_ts=No...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1590: error: No overload variant of "dict"
matches argument type "object"  [call-overload]
        sync_errors_1 = dict(out1.get("cache_sync_errors", {}) or {})
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1590: note: Possible overload variants:
tests\test_fetcher_resilience.py:1590: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1590: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1590: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1590: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1590: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
tests\test_fetcher_resilience.py:1590: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
tests\test_fetcher_resilience.py:1590: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
tests\test_fetcher_resilience.py:1590: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
tests\test_fetcher_resilience.py:1592: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(out1.get("pending_reconcile_after", 0)) == 1
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1592: note: Possible overload variants:
tests\test_fetcher_resilience.py:1592: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_fetcher_resilience.py:1592: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_fetcher_resilience.py:1599: error: Function is missing a type
annotation  [no-untyped-def]
            def describe_symbol_interval(self, symbol, interval):  # noqa:...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1609: error: Function is missing a type
annotation  [no-untyped-def]
            def upsert_history_frame(
            ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1620: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def purge_realtime_rows(self, symbol, interval, *, since_ts=No...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1634: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(out2.get("pending_reconcile_after", 0)) == 0
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1634: note: Possible overload variants:
tests\test_fetcher_resilience.py:1634: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_fetcher_resilience.py:1634: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_fetcher_resilience.py:1637: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_reconcile_pending_cache_sync_clears_queue_on_success(monkeypa...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1658: error: Function is missing a type
annotation  [no-untyped-def]
            def get_intraday_bars(self, code, interval="1m", limit=1000): ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1661: error: Function is missing a type
annotation  [no-untyped-def]
            def get_bars(self, code, limit=1000):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1664: error: Incompatible types in assignment
(expression has type "_DB", variable has type "MarketDatabase")  [assignment]
        fetcher._db = _DB()
                      ^~~~~
tests\test_fetcher_resilience.py:1683: error: Function is missing a type
annotation  [no-untyped-def]
            def upsert_history_frame(
            ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1697: error: Function is missing a type
annotation  [no-untyped-def]
            def describe_symbol_interval(self, symbol, interval):  # noqa:...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1702: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def purge_realtime_rows(self, symbol, interval, *, since_ts=No...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_fetcher_resilience.py:1711: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(out.get("targeted", 0)) == 1
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1711: note: Possible overload variants:
tests\test_fetcher_resilience.py:1711: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_fetcher_resilience.py:1711: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_fetcher_resilience.py:1712: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(out.get("reconciled", 0)) == 1
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1712: note: Possible overload variants:
tests\test_fetcher_resilience.py:1712: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_fetcher_resilience.py:1712: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_fetcher_resilience.py:1713: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(out.get("failed", 0)) == 0
               ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1713: note: Possible overload variants:
tests\test_fetcher_resilience.py:1713: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_fetcher_resilience.py:1713: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_fetcher_resilience.py:1714: error: No overload variant of "int"
matches argument type "object"  [call-overload]
        assert int(out.get("remaining", 0)) == 0
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_resilience.py:1714: note: Possible overload variants:
tests\test_fetcher_resilience.py:1714: note:     def __new__(cls, str | Buffer | SupportsInt | SupportsIndex | SupportsTrunc = ..., /) -> int
tests\test_fetcher_resilience.py:1714: note:     def __new__(cls, str | bytes | bytearray, /, base: SupportsIndex) -> int
tests\test_fetcher_registry.py:9: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _install_factory(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_registry.py:12: error: Function is missing a return type
annotation  [no-untyped-def]
        def _factory():
        ^~~~~~~~~~~~~~~
tests\test_fetcher_registry.py:19: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_get_fetcher_defaults_to_thread_scope(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_registry.py:39: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_get_fetcher_process_scope_shares_instance(monkeypatch) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_fetcher_registry.py:59: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_use_fetcher_registry_isolates_context(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\conftest.py:11: error: Function is missing a type annotation 
[no-untyped-def]
    def reset_cache(tmp_path):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~
tests\conftest.py:44: error: Function is missing a type annotation 
[no-untyped-def]
    def temp_model_dir(tmp_path):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\conftest.py:52: error: Function is missing a return type annotation 
[no-untyped-def]
    def force_offline_for_tests():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\metrics_http.py:96: error: Argument "key" to "sorted" has incompatible
type "Callable[[Order], datetime | None]"; expected
"Callable[[Order], SupportsDunderLT[Any] | SupportsDunderGT[Any]]"  [arg-type]
            key=lambda o: o.updated_at or o.created_at,
                ^
utils\metrics_http.py:96: error: Incompatible return value type (got
"datetime | None", expected "SupportsDunderLT[Any] | SupportsDunderGT[Any]") 
[return-value]
            key=lambda o: o.updated_at or o.created_at,
                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
utils\metrics_http.py:101: error: Argument "key" to "sorted" has incompatible
type "Callable[[Fill], datetime | None]"; expected
"Callable[[Fill], SupportsDunderLT[Any] | SupportsDunderGT[Any]]"  [arg-type]
            key=lambda f: f.timestamp,
                ^
utils\metrics_http.py:101: error: Incompatible return value type (got
"datetime | None", expected "SupportsDunderLT[Any] | SupportsDunderGT[Any]") 
[return-value]
            key=lambda f: f.timestamp,
                          ^~~~~~~~~~~
trading\risk.py:32: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def log_order(self, *args, **kwargs) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\risk.py:35: error: Function is missing a return type annotation 
[no-untyped-def]
        def __getattr__(self, name: str):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\risk.py:38: error: Function is missing a return type annotation 
[no-untyped-def]
    def _get_audit_log():
    ^~~~~~~~~~~~~~~~~~~~~
trading\risk.py:112: error: Function is missing a return type annotation 
[no-untyped-def]
    def _get_oms():
    ^~~~~~~~~~~~~~~
trading\risk.py:121: error: Right operand of "and" is never evaluated 
[unreachable]
        if _oms_cache_val is not None and (now - _oms_cache_ts) < _oms_cac...
                                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
trading\risk.py:122: error: Statement is unreachable  [unreachable]
            return _oms_cache_val
            ^~~~~~~~~~~~~~~~~~~~~
trading\risk.py:132: error: Function is missing a return type annotation 
[no-untyped-def]
    def _get_kill_switch():
    ^~~~~~~~~~~~~~~~~~~~~~~
trading\risk.py:146: error: Returning Any from function declared to return
"int"  [no-any-return]
        return _constants_module.get_lot_size(symbol)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\risk.py:148: error: Function is missing a return type annotation 
[no-untyped-def]
    def _get_feed_quote(symbol: str):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\risk.py:259: error: Statement is unreachable  [unreachable]
                log.warning("RiskManager.update() called with None account...
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\risk.py:309: error: Returning Any from function declared to return
"Account"  [no-any-return]
                    return acc
                    ^~~~~~~~~~
trading\risk.py:445: error: Argument "key" to "sorted" has incompatible type
overloaded function; expected
"Callable[[str], SupportsDunderLT[Any] | SupportsDunderGT[Any]]"  [arg-type]
                            key=self._quote_timestamps.get,
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~
trading\risk.py:467: error: Incompatible default for argument "_account"
(default has type "None", argument has type "Account")  [assignment]
        def get_metrics(self, _account: Account = None) -> RiskMetrics:
                                                  ^~~~
trading\risk.py:467: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\risk.py:467: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\risk.py:1155: error: Incompatible default for argument "timestamp"
(default has type "None", argument has type "datetime")  [assignment]
            self, symbol: str, timestamp: datetime = None,
                                                     ^~~~
trading\risk.py:1155: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\risk.py:1155: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\executor_order_ops.py:26: error: Function is missing a return type
annotation  [no-untyped-def]
    def _resolve_access_control():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_order_ops.py:38: error: Function is missing a return type
annotation  [no-untyped-def]
    def _resolve_audit_log():
    ^~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_order_ops.py:50: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def submit(self, signal: TradeSignal) -> bool:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_order_ops.py:306: error: "TradeSignal" has no attribute
"_arrival_price"  [attr-defined]
        signal._arrival_price = float(fresh_px)
        ^~~~~~~~~~~~~~~~~~~~~
trading\executor_order_ops.py:372: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _execute(self, signal: TradeSignal) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_order_ops.py:556: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _startup_sync(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_order_ops.py:581: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _process_pending_fills(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_order_ops.py:686: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _cancel_oco_siblings(self, oms, filled_order: Order, fill: Fill) -...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
trading\executor_order_ops.py:762: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _record_execution_quality(self, order: Order, fill: Fill) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_order_ops.py:800: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _maybe_register_synthetic_exit(self, order: Order, fill: Fill) -> ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
trading\executor_order_ops.py:853: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _evaluate_synthetic_exits(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_order_ops.py:914: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _submit_synthetic_exit(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_order_ops.py:971: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _status_sync_loop(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\broker.py:232: error: Incompatible types in assignment (expression has
type "DataFetcher", variable has type "None")  [assignment]
                self._fetcher = get_fetcher()
                                ^~~~~~~~~~~~~
trading\broker.py:293: error: Statement is unreachable  [unreachable]
                return float(default)
                ^~~~~~~~~~~~~~~~~~~~~
trading\broker.py:345: error: "object" has no attribute "price"  [attr-defined]
                if q and getattr(q, "price", 0) and float(q.price) > 0:
                                                          ^~~~~~~
trading\broker.py:346: error: "object" has no attribute "price"  [attr-defined]
                    px = float(q.price)
                               ^~~~~~~
trading\broker.py:456: error: Statement is unreachable  [unreachable]
                            order.tags = {}
                            ^~~~~~~~~~~~~~~
trading\broker.py:485: error: Statement is unreachable  [unreachable]
                        return
                        ^~~~~~
trading\broker.py:520: error: Statement is unreachable  [unreachable]
                            order.tags = {}
                            ^~~~~~~~~~~~~~~
trading\broker.py:664: error: Incompatible default for argument "name" (default
has type "None", argument has type "str")  [assignment]
            name: str = None,
                        ^~~~
trading\broker.py:664: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\broker.py:664: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\broker.py:701: error: Statement is unreachable  [unreachable]
                    order.tags = {}
                    ^~~~~~~~~~~~~~~
trading\broker.py:720: error: Statement is unreachable  [unreachable]
                    order.tags = {}
                    ^~~~~~~~~~~~~~~
trading\broker.py:749: error: Statement is unreachable  [unreachable]
                order.tags = {}
                ^~~~~~~~~~~~~~~
trading\auto_trader.py:49: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def __init__(
        ^~~~~~~~~~~~~
trading\auto_trader.py:133: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def update_predictor(self, predictor) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\auto_trader.py:153: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _passes_precision_quality_gate(self, pred) -> tuple[bool, str]...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\auto_trader.py:206: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _cap_buy_shares_by_risk(
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\auto_trader.py:447: error: "ExecutionEngine" has no attribute
"_running"  [attr-defined]
                if not self._engine or not self._engine._running:
                                           ^~~~~~~~~~~~~~~~~~~~~
trading\auto_trader.py:449: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                if not self._engine.broker.is_connected:
                       ^~~~~~~~~~~~~~~~~~~
trading\auto_trader.py:792: error: "ExecutionEngine" has no attribute "submit" 
[attr-defined]
            success = self._engine.submit(signal)
                      ^~~~~~~~~~~~~~~~~~~
trading\auto_trader.py:806: error: Returning Any from function declared to
return "bool"  [no-any-return]
            return success
            ^~~~~~~~~~~~~~
trading\auto_trader.py:808: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _record_skip(self, pred, Signal, reason: str) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\__init__.py:2: error: Function is missing a return type annotation 
[no-untyped-def]
    def __getattr__(name: str):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:53: error: Incompatible default for argument "capital"
(default has type "None", argument has type "float")  [assignment]
            capital: float = None,
                             ^~~~
models\predictor.py:53: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\predictor.py:53: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\predictor.py:55: error: Incompatible default for argument
"prediction_horizon" (default has type "None", argument has type "int") 
[assignment]
            prediction_horizon: int = None,
                                      ^~~~
models\predictor.py:55: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\predictor.py:55: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\predictor.py:197: error: Incompatible types in assignment (expression
has type "DataProcessor", variable has type "None")  [assignment]
                self.processor = DataProcessor()
                                 ^~~~~~~~~~~~~~~
models\predictor.py:198: error: Incompatible types in assignment (expression
has type "FeatureEngine", variable has type "None")  [assignment]
                self.feature_engine = FeatureEngine()
                                      ^~~~~~~~~~~~~~~
models\predictor.py:199: error: Incompatible types in assignment (expression
has type "DataFetcher", variable has type "None")  [assignment]
                self.fetcher = get_fetcher()
                               ^~~~~~~~~~~~~
models\predictor.py:200: error: "None" has no attribute "get_feature_columns" 
[attr-defined]
                self._feature_cols = self.feature_engine.get_feature_colum...
                                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:210: error: "None" has no attribute "load_scaler" 
[attr-defined]
                    if not self.processor.load_scaler(str(chosen_scl)):
                           ^~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:226: error: "None" has no attribute "n_features" 
[attr-defined]
                        self.processor.n_features or len(self._feature_col...
                        ^~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:230: error: Incompatible types in assignment (expression
has type "EnsembleModel", variable has type "None")  [assignment]
                        self.ensemble = ens
                                        ^~~
models\predictor.py:311: error: Right operand of "or" is never evaluated 
[unreachable]
            if self.ensemble is None or not hasattr(self.ensemble, 'models...
                                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:315: error: Statement is unreachable  [unreachable]
            n_models = len(self.ensemble.models)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:334: error: Right operand of "or" is never evaluated 
[unreachable]
            if self.ensemble is None or not hasattr(self.ensemble, 'models...
                                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:337: error: Statement is unreachable  [unreachable]
            alpha = 0.1  # Learning rate for weight updates
            ^~~~~~~~~~~
models\predictor.py:614: error: Right operand of "and" is never evaluated 
[unreachable]
    ...             bool(self.processor is not None and getattr(self.processo...
                                                        ^~~~~~~~~~~~~~~~~~~~~...
models\predictor.py:623: error: Statement is unreachable  [unreachable]
            try:
            ^~~~
models\predictor.py:660: error: Statement is unreachable  [unreachable]
            try:
            ^~~~
models\predictor.py:805: error: Right operand of "and" is never evaluated 
[unreachable]
                    and not self.processor._verify_artifact_checksum(forec...
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\predictor.py:807: error: Statement is unreachable  [unreachable]
                    return
                    ^~~~~~
models\predictor.py:827: error: Returning Any from function declared to return
"dict[str, Any]"  [no-any-return]
                    return torch_load(
                    ^~~~~~~~~~~~~~~~~~
models\predictor.py:867: error: Incompatible types in assignment (expression
has type "TCNModel", variable has type "None")  [assignment]
                self.forecaster = TCNModel(
                                  ^~~~~~~~~
models\predictor.py:873: error: "None" has no attribute "load_state_dict" 
[attr-defined]
                self.forecaster.load_state_dict(data["state_dict"])
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:874: error: "None" has no attribute "eval"  [attr-defined]
                self.forecaster.eval()
                ^~~~~~~~~~~~~~~~~~~~
models\predictor.py:900: error: Incompatible default for argument "interval"
(default has type "None", argument has type "str")  [assignment]
            interval: str = None,
                            ^~~~
models\predictor.py:900: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\predictor.py:900: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\predictor.py:901: error: Incompatible default for argument
"forecast_minutes" (default has type "None", argument has type "int") 
[assignment]
            forecast_minutes: int = None,
                                    ^~~~
models\predictor.py:901: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\predictor.py:901: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\predictor.py:902: error: Incompatible default for argument
"lookback_bars" (default has type "None", argument has type "int")  [assignment]
            lookback_bars: int = None,
                                 ^~~~
models\predictor.py:902: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\predictor.py:902: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\predictor.py:924: error: "None" has no attribute "scaler" 
[attr-defined]
    ...     if not hasattr(self.processor, 'scaler') or self.processor.scaler...
                                                        ^~~~~~~~~~~~~~~~~~~~~
models\predictor.py:930: error: "Predictor" has no attribute
"_normalize_interval_token"  [attr-defined]
                interval = self._normalize_interval_token(interval)
                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:933: error: "Predictor" has no attribute
"_default_lookback_bars"  [attr-defined]
                    lookback_bars or self._default_lookback_bars(interval)
                                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:936: error: "Predictor" has no attribute "_clean_code" 
[attr-defined]
                code = self._clean_code(stock_code)
                       ^~~~~~~~~~~~~~~~
models\predictor.py:941: error: "Predictor" has no attribute "_get_cache_ttl" 
[attr-defined]
                cache_ttl = self._get_cache_ttl(
                            ^~~~~~~~~~~~~~~~~~~
models\predictor.py:947: error: "Predictor" has no attribute
"_get_cached_prediction"  [attr-defined]
                    cached = self._get_cached_prediction(
                             ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:951: error: Returning Any from function declared to return
"Prediction"  [no-any-return]
                        return cached
                        ^~~~~~~~~~~~~
models\predictor.py:970: error: "Predictor" has no attribute "_fetch_data" 
[attr-defined]
                    df = self._fetch_data(
                         ^~~~~~~~~~~~~~~~
models\predictor.py:991: error: "Predictor" has no attribute
"_apply_news_influence"  [attr-defined]
                            self._apply_news_influence(pred, code, interva...
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:992: error: "Predictor" has no attribute
"_set_cached_prediction"  [attr-defined]
                            self._set_cached_prediction(cache_key, pred)
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1001: error: "Predictor" has no attribute "_get_stock_name"
 [attr-defined]
                    pred.stock_name = self._get_stock_name(code, df)
                                      ^~~~~~~~~~~~~~~~~~~~
models\predictor.py:1005: error: "None" has no attribute "create_features" 
[attr-defined]
                    df = self.feature_engine.create_features(df)
                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1006: error: "Predictor" has no attribute
"_extract_technicals"  [attr-defined]
                    self._extract_technicals(df, pred)
                    ^~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1008: error: "None" has no attribute
"prepare_inference_sequence"  [attr-defined]
                    X = self.processor.prepare_inference_sequence(
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1013: error: Statement is unreachable  [unreachable]
                        self._apply_ensemble_prediction(X, pred)
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1031: error: "Predictor" has no attribute
"_apply_news_influence"  [attr-defined]
                    news_bias = self._apply_news_influence(pred, code, int...
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1032: error: "Predictor" has no attribute
"_refresh_prediction_uncertainty"  [attr-defined]
                    self._refresh_prediction_uncertainty(pred)
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1033: error: "Predictor" has no attribute
"_apply_tail_risk_guard"  [attr-defined]
                    self._apply_tail_risk_guard(pred)
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1036: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
                        pred.predicted_prices = self._generate_forecast(
                                                ^~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1041: error: "Predictor" has no attribute
"_sequence_signature"  [attr-defined]
                            sequence_signature=self._sequence_signature(X)...
                                               ^~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1048: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
                        pred.predicted_prices = self._generate_forecast(
                                                ^~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1053: error: "Predictor" has no attribute
"_sequence_signature"  [attr-defined]
                            sequence_signature=self._sequence_signature(X)...
                                               ^~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1057: error: "Predictor" has no attribute
"_build_prediction_bands"  [attr-defined]
                    self._build_prediction_bands(pred)
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1058: error: "Predictor" has no attribute
"_calculate_levels"  [attr-defined]
                    pred.levels = self._calculate_levels(pred)
                                  ^~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1059: error: "Predictor" has no attribute
"_calculate_position"  [attr-defined]
                    pred.position = self._calculate_position(pred)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1060: error: "Predictor" has no attribute
"_generate_reasons"  [attr-defined]
                    self._generate_reasons(pred)
                    ^~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1062: error: "Predictor" has no attribute
"_set_cached_prediction"  [attr-defined]
                    self._set_cached_prediction(cache_key, pred)
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1114: error: "Predictor" has no attribute
"_normalize_interval_token"  [attr-defined]
            fallback_iv = self._normalize_interval_token(
                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1170: error: "Predictor" has no attribute "_get_stock_name"
 [attr-defined]
            pred.stock_name = self._get_stock_name(pred.stock_code, df)
                              ^~~~~~~~~~~~~~~~~~~~
models\predictor.py:1261: error: "Predictor" has no attribute
"_refresh_prediction_uncertainty"  [attr-defined]
            self._refresh_prediction_uncertainty(pred)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1262: error: "Predictor" has no attribute
"_apply_tail_risk_guard"  [attr-defined]
            self._apply_tail_risk_guard(pred)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1263: error: "Predictor" has no attribute
"_build_prediction_bands"  [attr-defined]
            self._build_prediction_bands(pred)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1266: error: "Predictor" has no attribute
"_calculate_levels"  [attr-defined]
                pred.levels = self._calculate_levels(pred)
                              ^~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1274: error: "Predictor" has no attribute
"_calculate_position"  [attr-defined]
                pred.position = self._calculate_position(pred)
                                ^~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1282: error: "Predictor" has no attribute
"_generate_reasons"  [attr-defined]
                self._generate_reasons(pred)
                ^~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1311: error: "Prediction" has no attribute "regime" 
[attr-defined]
                pred.regime = regime_result.regime.value
                ^~~~~~~~~~~
models\predictor.py:1417: error: Incompatible default for argument "interval"
(default has type "None", argument has type "str")  [assignment]
            interval: str = None,
                            ^~~~
models\predictor.py:1417: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\predictor.py:1417: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\predictor.py:1418: error: Incompatible default for argument
"lookback_bars" (default has type "None", argument has type "int")  [assignment]
            lookback_bars: int = None,
                                 ^~~~
models\predictor.py:1418: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\predictor.py:1418: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\predictor.py:1424: error: "Predictor" has no attribute
"_normalize_interval_token"  [attr-defined]
                interval = self._normalize_interval_token(interval)
                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1426: error: "Predictor" has no attribute
"_default_lookback_bars"  [attr-defined]
                    lookback_bars or self._default_lookback_bars(interval)
                                     ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1434: error: "Predictor" has no attribute "_clean_code" 
[attr-defined]
                        code = self._clean_code(stock_code)
                               ^~~~~~~~~~~~~~~~
models\predictor.py:1450: error: "Predictor" has no attribute "_fetch_data" 
[attr-defined]
                            df = self._fetch_data(
                                 ^~~~~~~~~~~~~~~~
models\predictor.py:1459: error: "Predictor" has no attribute "_fetch_data" 
[attr-defined]
                            df = self._fetch_data(
                                 ^~~~~~~~~~~~~~~~
models\predictor.py:1475: error: "None" has no attribute "create_features" 
[attr-defined]
                        df = self.feature_engine.create_features(df)
                             ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1476: error: "None" has no attribute
"prepare_inference_sequence"  [attr-defined]
                        X = self.processor.prepare_inference_sequence(
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1490: error: Statement is unreachable  [unreachable]
                    try:
                    ^~~~
models\predictor.py:1527: error: Statement is unreachable  [unreachable]
                        try:
                        ^~~~
models\predictor.py:1542: error: "type[Predictor]" has no attribute
"get_realtime_forecast_curve"  [attr-defined]
    Predictor.get_realtime_forecast_curve = _predictor_forecast_ops.get_re...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1543: error: "type[Predictor]" has no attribute
"_stabilize_forecast_curve"  [attr-defined]
    Predictor._stabilize_forecast_curve = staticmethod(_predictor_forecast...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1544: error: "type[Predictor]" has no attribute
"get_top_picks"  [attr-defined]
    Predictor.get_top_picks = _predictor_forecast_ops.get_top_picks
    ^~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1545: error: "type[Predictor]" has no attribute
"_apply_ensemble_prediction"  [attr-defined]
    Predictor._apply_ensemble_prediction = _predictor_forecast_ops._apply_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1546: error: "type[Predictor]" has no attribute
"_apply_ensemble_result"  [attr-defined]
    Predictor._apply_ensemble_result = _predictor_forecast_ops._apply_ense...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1547: error: "type[Predictor]" has no attribute
"_append_warning_once"  [attr-defined]
    Predictor._append_warning_once = staticmethod(_predictor_forecast_ops....
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1548: error: "type[Predictor]" has no attribute
"_refresh_prediction_uncertainty"  [attr-defined]
    Predictor._refresh_prediction_uncertainty = _predictor_forecast_ops._r...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1549: error: "type[Predictor]" has no attribute
"_apply_tail_risk_guard"  [attr-defined]
    Predictor._apply_tail_risk_guard = _predictor_forecast_ops._apply_tail...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1550: error: "type[Predictor]" has no attribute
"_build_prediction_bands"  [attr-defined]
    Predictor._build_prediction_bands = _predictor_forecast_ops._build_pre...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1551: error: "type[Predictor]" has no attribute
"_apply_high_precision_gate"  [attr-defined]
    Predictor._apply_high_precision_gate = _predictor_forecast_ops._apply_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1552: error: "type[Predictor]" has no attribute
"_apply_runtime_signal_quality_gate"  [attr-defined]
    Predictor._apply_runtime_signal_quality_gate = _predictor_forecast_ops...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1553: error: "type[Predictor]" has no attribute
"_get_cache_ttl"  [attr-defined]
    Predictor._get_cache_ttl = _predictor_forecast_ops._get_cache_ttl
    ^~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1554: error: "type[Predictor]" has no attribute
"_get_cached_prediction"  [attr-defined]
    Predictor._get_cached_prediction = _predictor_forecast_ops._get_cached...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1555: error: "type[Predictor]" has no attribute
"_set_cached_prediction"  [attr-defined]
    Predictor._set_cached_prediction = _predictor_forecast_ops._set_cached...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1556: error: "type[Predictor]" has no attribute
"_news_cache_ttl"  [attr-defined]
    Predictor._news_cache_ttl = _predictor_forecast_ops._news_cache_ttl
    ^~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1557: error: "type[Predictor]" has no attribute
"_ensure_news_cache_state"  [attr-defined]
    Predictor._ensure_news_cache_state = _predictor_forecast_ops._ensure_n...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1558: error: "type[Predictor]" has no attribute
"_get_news_sentiment"  [attr-defined]
    Predictor._get_news_sentiment = _predictor_forecast_ops._get_news_sent...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1559: error: "type[Predictor]" has no attribute
"_compute_news_bias"  [attr-defined]
    Predictor._compute_news_bias = _predictor_forecast_ops._compute_news_b...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1560: error: "type[Predictor]" has no attribute
"_apply_news_influence"  [attr-defined]
    Predictor._apply_news_influence = _predictor_forecast_ops._apply_news_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1561: error: "type[Predictor]" has no attribute
"_normalize_interval_token"  [attr-defined]
    Predictor._normalize_interval_token = _predictor_runtime_ops._normaliz...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1562: error: "type[Predictor]" has no attribute
"_is_intraday_interval"  [attr-defined]
    Predictor._is_intraday_interval = _predictor_runtime_ops._is_intraday_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1563: error: "type[Predictor]" has no attribute
"_bar_safety_caps"  [attr-defined]
    Predictor._bar_safety_caps = _predictor_runtime_ops._bar_safety_caps
    ^~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1564: error: "type[Predictor]" has no attribute
"_sanitize_ohlc_row"  [attr-defined]
    Predictor._sanitize_ohlc_row = _predictor_runtime_ops._sanitize_ohlc_r...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1565: error: "type[Predictor]" has no attribute
"_intraday_session_mask"  [attr-defined]
    Predictor._intraday_session_mask = _predictor_runtime_ops._intraday_se...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1566: error: "type[Predictor]" has no attribute
"_sanitize_history_df"  [attr-defined]
    Predictor._sanitize_history_df = _predictor_runtime_ops._sanitize_hist...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1567: error: "type[Predictor]" has no attribute
"invalidate_cache"  [attr-defined]
    Predictor.invalidate_cache = _predictor_runtime_ops.invalidate_cache
    ^~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1568: error: "type[Predictor]" has no attribute
"_fetch_data"  [attr-defined]
    Predictor._fetch_data = _predictor_runtime_ops._fetch_data
    ^~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1569: error: "type[Predictor]" has no attribute
"_default_lookback_bars"  [attr-defined]
    Predictor._default_lookback_bars = _predictor_runtime_ops._default_loo...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1570: error: "type[Predictor]" has no attribute
"_sequence_signature"  [attr-defined]
    Predictor._sequence_signature = _predictor_runtime_ops._sequence_signa...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1571: error: "type[Predictor]" has no attribute
"_forecast_seed"  [attr-defined]
    Predictor._forecast_seed = _predictor_runtime_ops._forecast_seed
    ^~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1572: error: "type[Predictor]" has no attribute
"_generate_forecast"  [attr-defined]
    Predictor._generate_forecast = _predictor_runtime_ops._generate_foreca...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1573: error: "type[Predictor]" has no attribute
"_determine_signal"  [attr-defined]
    Predictor._determine_signal = _predictor_runtime_ops._determine_signal
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1574: error: "type[Predictor]" has no attribute
"_calculate_signal_strength"  [attr-defined]
    Predictor._calculate_signal_strength = _predictor_runtime_ops._calcula...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1575: error: "type[Predictor]" has no attribute
"_calculate_levels"  [attr-defined]
    Predictor._calculate_levels = _predictor_runtime_ops._calculate_levels
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1576: error: "type[Predictor]" has no attribute
"_calculate_position"  [attr-defined]
    Predictor._calculate_position = _predictor_runtime_ops._calculate_posi...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1577: error: "type[Predictor]" has no attribute
"_resolve_trade_distances"  [attr-defined]
    Predictor._resolve_trade_distances = _predictor_runtime_ops._resolve_t...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1578: error: "type[Predictor]" has no attribute
"_quality_scale"  [attr-defined]
    Predictor._quality_scale = _predictor_runtime_ops._quality_scale
    ^~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1579: error: "type[Predictor]" has no attribute
"_expected_edge"  [attr-defined]
    Predictor._expected_edge = _predictor_runtime_ops._expected_edge
    ^~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1580: error: "type[Predictor]" has no attribute
"_round_trip_cost_pct"  [attr-defined]
    Predictor._round_trip_cost_pct = _predictor_runtime_ops._round_trip_co...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1581: error: "type[Predictor]" has no attribute
"_extract_technicals"  [attr-defined]
    Predictor._extract_technicals = _predictor_runtime_ops._extract_techni...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1582: error: "type[Predictor]" has no attribute
"_get_atr_pct"  [attr-defined]
    Predictor._get_atr_pct = _predictor_runtime_ops._get_atr_pct
    ^~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1583: error: "type[Predictor]" has no attribute
"_generate_reasons"  [attr-defined]
    Predictor._generate_reasons = _predictor_runtime_ops._generate_reasons
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1584: error: "type[Predictor]" has no attribute
"_get_stock_name"  [attr-defined]
    Predictor._get_stock_name = _predictor_runtime_ops._get_stock_name
    ^~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor.py:1585: error: "type[Predictor]" has no attribute
"_clean_code"  [attr-defined]
    Predictor._clean_code = _predictor_runtime_ops._clean_code
    ^~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:22: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _normalize_interval_token(self, interval: str | None) -> str:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:36: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _is_intraday_interval(self, interval: str) -> bool:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:40: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _bar_safety_caps(self, interval: str) -> tuple[float, float]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:55: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _sanitize_ohlc_row(
    ^~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:154: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _intraday_session_mask(self, idx: pd.DatetimeIndex) -> NDArray[np....
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\predictor_runtime_ops.py:187: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _sanitize_history_df(
    ^~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:298: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def invalidate_cache(self, code: str | None = None) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:310: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _fetch_data(
    ^~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:320: error: Module "data.fetcher" has no
attribute "BARS_PER_DAY"  [attr-defined]
            from data.fetcher import BARS_PER_DAY
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:384: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _default_lookback_bars(self, interval: str | None) -> int:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:390: error: Module "data.fetcher" has no
attribute "BARS_PER_DAY"  [attr-defined]
            from data.fetcher import BARS_PER_DAY, INTERVAL_MAX_DAYS
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:390: error: Module "data.fetcher" has no
attribute "INTERVAL_MAX_DAYS"  [attr-defined]
            from data.fetcher import BARS_PER_DAY, INTERVAL_MAX_DAYS
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:415: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _sequence_signature(self, X: FloatArray) -> float:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:427: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _forecast_seed(
    ^~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:471: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _generate_forecast(
    ^~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:564: error: Incompatible types in assignment
(expression has type "ndarray[tuple[int, ...], dtype[Any]]", variable has type
"ndarray[tuple[int], dtype[Any]]")  [assignment]
                returns_arr = np.nan_to_num(
                              ^~~~~~~~~~~~~~
models\predictor_runtime_ops.py:724: error: Incompatible types in assignment
(expression has type "ndarray[tuple[int, ...], dtype[Any]]", variable has type
"ndarray[tuple[int], dtype[Any]]")  [assignment]
                probs = np.nan_to_num(probs, nan=0.0, posinf=0.0, neginf=0...
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:726: error: Incompatible types in assignment
(expression has type "ndarray[tuple[int, ...], dtype[Any]]", variable has type
"ndarray[tuple[int], dtype[Any]]")  [assignment]
                    probs = np.pad(probs, (0, 3 - probs.size), constant_va...
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\predictor_runtime_ops.py:729: error: Incompatible types in assignment
(expression has type "ndarray[tuple[int, ...], dtype[Any]]", variable has type
"ndarray[tuple[int], dtype[Any]]")  [assignment]
                    probs = np.array([0.33, 0.34, 0.33], dtype=float)
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:731: error: Incompatible types in assignment
(expression has type "ndarray[tuple[int, ...], dtype[float64]]", variable has
type "ndarray[tuple[int], dtype[Any]]")  [assignment]
                    probs = probs[:3] / prob_sum
                            ^~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:897: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _determine_signal(self, ensemble_pred: Any, pred: Prediction) -> S...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\predictor_runtime_ops.py:927: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _calculate_signal_strength(self, ensemble_pred: Any, pred: Predict...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\predictor_runtime_ops.py:942: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _calculate_levels(self, pred: Prediction) -> TradingLevels:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:978: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _calculate_position(self, pred: Prediction) -> PositionSize:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:1040: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _resolve_trade_distances(self, pred: Prediction) -> tuple[float, f...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\predictor_runtime_ops.py:1059: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _quality_scale(self, pred: Prediction) -> float:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:1067: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _expected_edge(
    ^~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:1098: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _round_trip_cost_pct(self, side: str) -> float:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:1110: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _extract_technicals(self, df: pd.DataFrame, pred: Prediction) -> N...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\predictor_runtime_ops.py:1150: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _get_atr_pct(self, df: pd.DataFrame) -> float:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:1161: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _generate_reasons(self, pred: Prediction) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:1266: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _get_stock_name(self, code: str, df: pd.DataFrame) -> str:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:1277: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _clean_code(self, code: str) -> str:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_runtime_ops.py:1283: error: Returning Any from function
declared to return "str"  [no-any-return]
                return self.fetcher.clean_code(code)
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:22: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def get_realtime_forecast_curve(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:25: error: Incompatible default for argument
"interval" (default has type "None", argument has type "str")  [assignment]
        interval: str = None,
                        ^~~~
models\predictor_forecast_ops.py:25: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\predictor_forecast_ops.py:25: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\predictor_forecast_ops.py:26: error: Incompatible default for argument
"horizon_steps" (default has type "None", argument has type "int")  [assignment]
        horizon_steps: int = None,
                             ^~~~
models\predictor_forecast_ops.py:26: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\predictor_forecast_ops.py:26: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\predictor_forecast_ops.py:27: error: Incompatible default for argument
"lookback_bars" (default has type "None", argument has type "int")  [assignment]
        lookback_bars: int = None,
                             ^~~~
models\predictor_forecast_ops.py:27: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\predictor_forecast_ops.py:27: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\predictor_forecast_ops.py:87: error: "SessionBarCache" has no attribute
"read_history"  [attr-defined]
                        s_df = get_session_bar_cache().read_history(
                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:275: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def get_top_picks(
    ^~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:302: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _apply_ensemble_prediction(self, X: FloatArray, pred: Prediction) ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\predictor_forecast_ops.py:307: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _apply_ensemble_result(self, ensemble_pred: Any, pred: Prediction)...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\predictor_forecast_ops.py:383: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _refresh_prediction_uncertainty(self, pred: Prediction) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:458: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _apply_tail_risk_guard(self, pred: Prediction) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:486: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _build_prediction_bands(self, pred: Prediction) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:535: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _apply_high_precision_gate(self, pred: Prediction) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:580: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _apply_runtime_signal_quality_gate(self, pred: Prediction) -> None...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:632: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _get_cache_ttl(self, use_realtime: bool, interval: str) -> float:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:644: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _get_cached_prediction(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:654: error: Returning Any from function
declared to return "Prediction | None"  [no-any-return]
                    return copy.deepcopy(pred)
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:658: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _set_cached_prediction(self, cache_key: str, pred: Prediction) -> ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\predictor_forecast_ops.py:681: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _news_cache_ttl(self, interval: str) -> float:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:687: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _ensure_news_cache_state(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:694: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _get_news_sentiment(
    ^~~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:745: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _compute_news_bias(
    ^~~~~~~~~~~~~~~~~~~~~~~
models\predictor_forecast_ops.py:765: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _apply_news_influence(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~
models\ensemble.py:85: error: Incompatible import of "GradScaler" (imported
name has type "type[torch.cuda.amp.grad_scaler.GradScaler]", local name has type
"type[torch.amp.grad_scaler.GradScaler]")  [assignment]
            from torch.cuda.amp import GradScaler, autocast
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\ensemble.py:85: error: Incompatible import of "autocast" (imported name
has type "type[torch.cuda.amp.autocast_mode.autocast]", local name has type
"type[torch.amp.autocast_mode.autocast]")  [assignment]
            from torch.cuda.amp import GradScaler, autocast
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\ensemble.py:86: error: Argument 1 to "autocast" has incompatible type
"**dict[str, bool]"; expected "str"  [arg-type]
            return (lambda: autocast(**{"enabled": True})), GradScaler(ena...
                                       ^~~~~~~~~~~~~~~~~
models\ensemble.py:86: error: Argument 1 to "autocast" has incompatible type
"**dict[str, bool]"; expected "dtype | None"  [arg-type]
            return (lambda: autocast(**{"enabled": True})), GradScaler(ena...
                                       ^~~~~~~~~~~~~~~~~
models\ensemble.py:420: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "Sampler[Any] | Iterable[Any] | None"  [arg-type]
    ...DataLoader(train_ds, batch_size=batch_size, shuffle=True, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:420: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "Sampler[list[Any]] | Iterable[list[Any]] | None" 
[arg-type]
    ...DataLoader(train_ds, batch_size=batch_size, shuffle=True, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:420: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "Callable[[list[Any]], Any] | None"  [arg-type]
    ...DataLoader(train_ds, batch_size=batch_size, shuffle=True, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:420: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "bool"  [arg-type]
    ...DataLoader(train_ds, batch_size=batch_size, shuffle=True, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:420: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "Callable[[int], None] | None"  [arg-type]
    ...DataLoader(train_ds, batch_size=batch_size, shuffle=True, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:420: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "str"  [arg-type]
    ...DataLoader(train_ds, batch_size=batch_size, shuffle=True, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:421: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "Sampler[Any] | Iterable[Any] | None"  [arg-type]
    ... DataLoader(val_ds, batch_size=batch_size, shuffle=False, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:421: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "Sampler[list[Any]] | Iterable[list[Any]] | None" 
[arg-type]
    ... DataLoader(val_ds, batch_size=batch_size, shuffle=False, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:421: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "Callable[[list[Any]], Any] | None"  [arg-type]
    ... DataLoader(val_ds, batch_size=batch_size, shuffle=False, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:421: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "bool"  [arg-type]
    ... DataLoader(val_ds, batch_size=batch_size, shuffle=False, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:421: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "Callable[[int], None] | None"  [arg-type]
    ... DataLoader(val_ds, batch_size=batch_size, shuffle=False, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:421: error: Argument 4 to "DataLoader" has incompatible type
"**dict[str, int]"; expected "str"  [arg-type]
    ... DataLoader(val_ds, batch_size=batch_size, shuffle=False, **loader_kw)
                                                                   ^~~~~~~~~
models\ensemble.py:542: error: Item "None" of "Any | None" has no attribute
"scale"  [union-attr]
                            scaler.scale(loss).backward()
                            ^~~~~~~~~~~~
models\ensemble.py:543: error: Item "None" of "Any | None" has no attribute
"unscale_"  [union-attr]
                            scaler.unscale_(optimizer)
                            ^~~~~~~~~~~~~~~
models\ensemble.py:545: error: Item "None" of "Any | None" has no attribute
"step"  [union-attr]
                            scaler.step(optimizer)
                            ^~~~~~~~~~~
models\ensemble.py:546: error: Item "None" of "Any | None" has no attribute
"update"  [union-attr]
                            scaler.update()
                            ^~~~~~~~~~~~~
models\ensemble.py:672: error: Incompatible types in assignment (expression has
type "ndarray[tuple[int, ...], dtype[float64]]", variable has type
"ndarray[tuple[int], dtype[Any]]")  [assignment]
                trained_dist = exp_w / exp_sum
                               ^~~~~~~~~~~~~~~
models\ensemble.py:887: error: Incompatible types in assignment (expression has
type "None", variable has type "Callable[[str | Path, Any, bool, bool], None]") 
[assignment]
                atomic_torch_save = None
                                    ^~~~
models\ensemble.py:888: error: Incompatible types in assignment (expression has
type "None", variable has type
"Callable[[str | Path, Any, int, bool, bool], None]")  [assignment]
                atomic_write_json = None
                                    ^~~~
models\ensemble.py:935: error: Statement is unreachable  [unreachable]
                torch.save(state, path_obj)
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\ensemble.py:962: error: Statement is unreachable  [unreachable]
                import json
                ^~~~~~~~~~~
models\ensemble.py:996: error: Returning Any from function declared to return
"dict[str, Any]"  [no-any-return]
                    return torch_load(
                    ^~~~~~~~~~~~~~~~~~
models\ensemble.py:1024: error: Statement is unreachable  [unreachable]
                    log.error(f"Invalid ensemble file format (not dict): {...
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\auto_learner_components.py:245: error: Returning Any from function
declared to return "bool"  [no-any-return]
            return spread < self._plateau_threshold
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_components.py:274: error: Incompatible default for argument
"cache_dir" (default has type "None", argument has type "Path")  [assignment]
            cache_dir: Path = None,
                              ^~~~
models\auto_learner_components.py:274: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\auto_learner_components.py:274: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\auto_learner_components.py:333: error: Function is missing a type
annotation  [no-untyped-def]
                def safe_sample(pool, count):
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_components.py:358: error: Returning Any from function
declared to return "list[str]"  [no-any-return]
                return selected
                ^~~~~~~~~~~~~~~
models\auto_learner_components.py:460: error: Incompatible default for argument
"model_dir" (default has type "None", argument has type "Path")  [assignment]
        def __init__(self, model_dir: Path = None, max_backups: int = 5) -...
                                             ^~~~
models\auto_learner_components.py:460: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\auto_learner_components.py:460: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\auto_learner_components.py:567: error: Incompatible return value type
(got "dict[str, int]", expected "dict[str, float]")  [return-value]
                return _empty_result
                       ^~~~~~~~~~~~~
models\auto_learner_components.py:567: note: "dict" is invariant -- see https://mypy.readthedocs.io/en/stable/common_issues.html#variance
models\auto_learner_components.py:567: note: Consider using "Mapping" instead, which is covariant in the value type
models\auto_learner_components.py:567: note: Perhaps you need a type annotation for "_empty_result"? Suggestion: "dict[str, float]"
models\auto_learner_components.py:579: error: Incompatible return value type
(got "dict[str, int]", expected "dict[str, float]")  [return-value]
                    return _empty_result
                           ^~~~~~~~~~~~~
models\auto_learner_components.py:579: note: "dict" is invariant -- see https://mypy.readthedocs.io/en/stable/common_issues.html#variance
models\auto_learner_components.py:579: note: Consider using "Mapping" instead, which is covariant in the value type
models\auto_learner_components.py:579: note: Perhaps you need a type annotation for "_empty_result"? Suggestion: "dict[str, float]"
models\auto_learner_components.py:588: error: Incompatible return value type
(got "dict[str, int]", expected "dict[str, float]")  [return-value]
                        return _empty_result
                               ^~~~~~~~~~~~~
models\auto_learner_components.py:588: note: "dict" is invariant -- see https://mypy.readthedocs.io/en/stable/common_issues.html#variance
models\auto_learner_components.py:588: note: Consider using "Mapping" instead, which is covariant in the value type
models\auto_learner_components.py:588: note: Perhaps you need a type annotation for "_empty_result"? Suggestion: "dict[str, float]"
models\auto_learner_components.py:591: error: Incompatible return value type
(got "dict[str, int]", expected "dict[str, float]")  [return-value]
                    return _empty_result
                           ^~~~~~~~~~~~~
models\auto_learner_components.py:591: note: "dict" is invariant -- see https://mypy.readthedocs.io/en/stable/common_issues.html#variance
models\auto_learner_components.py:591: note: Consider using "Mapping" instead, which is covariant in the value type
models\auto_learner_components.py:591: note: Perhaps you need a type annotation for "_empty_result"? Suggestion: "dict[str, float]"
models\auto_learner_components.py:598: error: Incompatible return value type
(got "dict[str, int]", expected "dict[str, float]")  [return-value]
                    return _empty_result
                           ^~~~~~~~~~~~~
models\auto_learner_components.py:598: note: "dict" is invariant -- see https://mypy.readthedocs.io/en/stable/common_issues.html#variance
models\auto_learner_components.py:598: note: Consider using "Mapping" instead, which is covariant in the value type
models\auto_learner_components.py:598: note: Perhaps you need a type annotation for "_empty_result"? Suggestion: "dict[str, float]"
models\auto_learner_components.py:692: error: Incompatible return value type
(got "dict[str, int]", expected "dict[str, float]")  [return-value]
                    return _empty_result
                           ^~~~~~~~~~~~~
models\auto_learner_components.py:692: note: "dict" is invariant -- see https://mypy.readthedocs.io/en/stable/common_issues.html#variance
models\auto_learner_components.py:692: note: Consider using "Mapping" instead, which is covariant in the value type
models\auto_learner_components.py:692: note: Perhaps you need a type annotation for "_empty_result"? Suggestion: "dict[str, float]"
models\auto_learner_components.py:702: error: Incompatible types in assignment
(expression has type "list[dict[str, Any]]", target has type "float") 
[assignment]
                    result["samples"] = samples
                                        ^~~~~~~
models\auto_learner_components.py:708: error: Incompatible return value type
(got "dict[str, int]", expected "dict[str, float]")  [return-value]
                return _empty_result
                       ^~~~~~~~~~~~~
models\auto_learner_components.py:708: note: "dict" is invariant -- see https://mypy.readthedocs.io/en/stable/common_issues.html#variance
models\auto_learner_components.py:708: note: Consider using "Mapping" instead, which is covariant in the value type
models\auto_learner_components.py:708: note: Perhaps you need a type annotation for "_empty_result"? Suggestion: "dict[str, float]"
models\auto_learner_components.py:710: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _model_files(self, interval, horizon) -> list[str]:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_components.py:807: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _maybe_refresh_pool(self, max_stocks, min_market_cap, stop_che...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\auto_learner_components.py:989: error: Incompatible default for argument
"base_lr" (default has type "None", argument has type "float")  [assignment]
            self, base_lr: float = None, decay_rate: float = 0.05,
                                   ^~~~
models\auto_learner_components.py:989: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\auto_learner_components.py:989: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\auto_learner_components.py:1083: error: Module "data.fetcher" has no
attribute "BARS_PER_DAY"  [attr-defined]
                    from data.fetcher import BARS_PER_DAY
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner_components.py:1092: error: "ParallelFetcher" has no
attribute "_cancel_token"  [attr-defined]
                    if self._cancel_token.wait(timeout=max(0.0, float(dela...
                       ^~~~~~~~~~~~~~~~~~
trading\signals.py:100: error: Function is missing a return type annotation 
[no-untyped-def]
        def __post_init__(self):
        ^~~~~~~~~~~~~~~~~~~~~~~~
trading\signals.py:100: note: Use "-> None" if function does not return a value
trading\signals.py:103: error: Statement is unreachable  [unreachable]
                self.reasons = []
                ^~~~~~~~~~~~~~~~~
trading\signals.py:105: error: Statement is unreachable  [unreachable]
                self.warnings = []
                ^~~~~~~~~~~~~~~~~~
trading\signals.py:184: error: Incompatible types in assignment (expression has
type "TechnicalAnalyzer", variable has type "None")  [assignment]
                self.tech_analyzer = TechnicalAnalyzer()
                                     ^~~~~~~~~~~~~~~~~~~
trading\signals.py:193: error: Incompatible types in assignment (expression has
type "SentimentAnalyzer", variable has type "None")  [assignment]
                self.sentiment_analyzer = SentimentAnalyzer()
                                          ^~~~~~~~~~~~~~~~~~~
trading\signals.py:194: error: Incompatible types in assignment (expression has
type "NewsScraper", variable has type "None")  [assignment]
                self.news_scraper = NewsScraper()
                                    ^~~~~~~~~~~~~
trading\signals.py:203: error: Incompatible types in assignment (expression has
type "StrategyScriptEngine", variable has type "None")  [assignment]
                self.strategy_engine = StrategyScriptEngine()
                                       ^~~~~~~~~~~~~~~~~~~~~~
trading\signals.py:209: error: Function is missing a return type annotation 
[no-untyped-def]
        def _safe_get(obj: object, attr: str, default=None):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\signals.py:209: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def _safe_get(obj: object, attr: str, default=None):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\signals.py:284: error: Statement is unreachable  [unreachable]
                try:
                ^~~~
trading\signals.py:359: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def _calculate_ai_score(self, prediction) -> float:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\signals.py:413: error: Statement is unreachable  [unreachable]
            try:
            ^~~~
trading\signals.py:475: error: Statement is unreachable  [unreachable]
                try:
                ^~~~
trading\executor_reconcile_ops.py:17: error: Incompatible types in assignment
(expression has type "None", variable has type
"Callable[[str, Callable[[], Any]], None]")  [assignment]
        register_snapshot_provider = None
                                     ^~~~
trading\executor_reconcile_ops.py:18: error: Incompatible types in assignment
(expression has type "None", variable has type "Callable[[str], bool]") 
[assignment]
        unregister_snapshot_provider = None
                                       ^~~~
trading\executor_reconcile_ops.py:20: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _reconciliation_loop(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_reconcile_ops.py:58: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _submit_with_retry(self, order: Order, attempts: int = 3) -> Order...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_reconcile_ops.py:69: error: Returning Any from function
declared to return "Order"  [no-any-return]
                    return result
                    ^~~~~~~~~~~~~
trading\executor_reconcile_ops.py:70: error: Returning Any from function
declared to return "Order"  [no-any-return]
                return result
                ^~~~~~~~~~~~~
trading\executor_core_ops.py:49: error: Incompatible types in assignment
(expression has type "None", variable has type
"Callable[[str, Callable[[], Any]], None]")  [assignment]
        register_snapshot_provider = None
                                     ^~~~
trading\executor_core_ops.py:50: error: Incompatible types in assignment
(expression has type "None", variable has type "Callable[[str], bool]") 
[assignment]
        unregister_snapshot_provider = None
                                       ^~~~
trading\executor_core_ops.py:52: error: Function is missing a return type
annotation  [no-untyped-def]
    def _resolve_access_control():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:64: error: Function is missing a return type
annotation  [no-untyped-def]
    def _resolve_audit_log():
    ^~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:75: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def __init__(self, mode: TradingMode = None) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:75: error: Incompatible default for argument
"mode" (default has type "None", argument has type "TradingMode")  [assignment]
    def __init__(self, mode: TradingMode = None) -> None:
                                           ^~~~
trading\executor_core_ops.py:75: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\executor_core_ops.py:75: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\executor_core_ops.py:76: error: Right operand of "or" is never
evaluated  [unreachable]
        self.mode = mode or CONFIG.trading_mode
                            ^~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:173: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def start(self) -> bool:
    ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:290: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _start_engine_thread(
    ^~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:324: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _handle_worker_thread_crash(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:362: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def stop(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:411: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _build_execution_snapshot(self) -> dict[str, object]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:431: error: Item "None" of "Any | None" has no
attribute "to_dict"  [union-attr]
                    auto_state.to_dict()
                    ^~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:440: error: Unsupported target for indexed
assignment ("object")  [index]
                snapshot["broker"]["routing"] = broker.get_health_snapshot...
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:472: error: Unsupported target for indexed
assignment ("object")  [index]
                        snapshot["runtime"]["lease_record"] = record
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:489: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _get_execution_quality_snapshot(self) -> dict[str, object]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:505: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _watchdog_loop(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:556: error: Function is missing a return type
annotation  [no-untyped-def]
    def _order_ops():
    ^~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:562: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def submit(self, signal: TradeSignal) -> bool:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:563: error: Returning Any from function declared
to return "bool"  [no-any-return]
        return _order_ops().submit(self, signal)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:566: error: Function is missing a return type
annotation  [no-untyped-def]
    def _execute(self, signal: TradeSignal):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:566: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _execute(self, signal: TradeSignal):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:570: error: Function is missing a return type
annotation  [no-untyped-def]
    def _startup_sync(self):
    ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:574: error: Function is missing a return type
annotation  [no-untyped-def]
    def _process_pending_fills(self):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:578: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _cancel_oco_siblings(self, oms, filled_order: Order, fill: Fill) -...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
trading\executor_core_ops.py:579: error: Returning Any from function declared
to return "None"  [no-any-return]
        return _order_ops()._cancel_oco_siblings(self, oms, filled_order, ...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
trading\executor_core_ops.py:582: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _record_execution_quality(self, order: Order, fill: Fill) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:583: error: Returning Any from function declared
to return "None"  [no-any-return]
        return _order_ops()._record_execution_quality(self, order, fill)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:586: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _maybe_register_synthetic_exit(self, order: Order, fill: Fill) -> ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
trading\executor_core_ops.py:587: error: Returning Any from function declared
to return "None"  [no-any-return]
        return _order_ops()._maybe_register_synthetic_exit(self, order, fi...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:590: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _evaluate_synthetic_exits(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:591: error: Returning Any from function declared
to return "None"  [no-any-return]
        return _order_ops()._evaluate_synthetic_exits(self)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:594: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _submit_synthetic_exit(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:600: error: Returning Any from function declared
to return "bool"  [no-any-return]
        return _order_ops()._submit_synthetic_exit(
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_core_ops.py:608: error: Function is missing a return type
annotation  [no-untyped-def]
    def _status_sync_loop(self):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_auto_ops.py:17: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def trigger_model_drift_alarm(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_auto_ops.py:58: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _apply_model_drift_alarm(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_auto_ops.py:121: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def init_auto_trader(self, predictor: Any, watch_list: list[str]) -> N...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
trading\executor_auto_ops.py:132: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def start_auto_trade(self, mode: AutoTradeMode = AutoTradeMode.AUTO) -...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
trading\executor_auto_ops.py:156: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def stop_auto_trade(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_auto_ops.py:163: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def set_auto_mode(self, mode: AutoTradeMode) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_auto_ops.py:169: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def get_auto_trade_state(self) -> AutoTradeState | None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor_auto_ops.py:172: error: Returning Any from function declared
to return "AutoTradeState | None"  [no-any-return]
            return self.auto_trader.get_state()
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:79: error: "None" has no attribute "connect" 
[attr-defined]
                self._client.connect(exe_path)
                ^~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:81: error: "None" has no attribute "balance" 
[attr-defined]
                balance = self._client.balance
                          ^~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:102: error: "object" has no attribute "price" 
[attr-defined]
                if q and getattr(q, "price", 0) and float(q.price) > 0:
                                                          ^~~~~~~
trading\broker_live.py:103: error: "object" has no attribute "price" 
[attr-defined]
                    return float(q.price)
                                 ^~~~~~~
trading\broker_live.py:120: error: "None" has no attribute "balance" 
[attr-defined]
                balance = self._client.balance
                          ^~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:160: error: "None" has no attribute "position" 
[attr-defined]
                raw = self._client.position
                      ^~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:227: error: "None" has no attribute "market_buy" 
[attr-defined]
                        result = self._client.market_buy(
                                 ^~~~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:231: error: "None" has no attribute "buy" 
[attr-defined]
                        result = self._client.buy(
                                 ^~~~~~~~~~~~~~~~
trading\broker_live.py:236: error: "None" has no attribute "market_sell" 
[attr-defined]
                        result = self._client.market_sell(
                                 ^~~~~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:240: error: "None" has no attribute "sell" 
[attr-defined]
                        result = self._client.sell(
                                 ^~~~~~~~~~~~~~~~~
trading\broker_live.py:290: error: "None" has no attribute "today_trades" 
[attr-defined]
                trades = self._client.today_trades
                         ^~~~~~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:390: error: "None" has no attribute "today_entrusts" 
[attr-defined]
                entrusts = self._client.today_entrusts
                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:416: error: "None" has no attribute "today_entrusts" 
[attr-defined]
                entrusts = self._client.today_entrusts
                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:454: error: "None" has no attribute "cancel_entrust" 
[attr-defined]
                self._client.cancel_entrust(broker_id)
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:475: error: Incompatible types in assignment (expression
has type "DataFetcher", variable has type "None")  [assignment]
                self._fetcher = get_fetcher()
                                ^~~~~~~~~~~~~
trading\broker_live.py:756: error: Returning Any from function declared to
return "Account"  [no-any-return]
            return self._first_read("get_account")
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:759: error: Returning Any from function declared to
return "dict[str, Position]"  [no-any-return]
            return self._first_read("get_positions")
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:762: error: Returning Any from function declared to
return "Position | None"  [no-any-return]
            return self._first_read("get_position", symbol)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\broker_live.py:829: error: Returning Any from function declared to
return "float | None"  [no-any-return]
            return self._first_read("get_quote", symbol)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer_pipeline_ops.py:24: error: Incompatible types in assignment
(expression has type "None", variable has type
"Callable[[str | Path, Any, bool, bool], None]")  [assignment]
        atomic_torch_save = None
                            ^~~~
models\trainer_pipeline_ops.py:78: error: Returning Any from function declared
to return "type[Any]"  [no-any-return]
                return candidate
                ^~~~~~~~~~~~~~~~
models\trainer_pipeline_ops.py:84: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def train(
    ^~~~~~~~~~
models\trainer_pipeline_ops.py:86: error: Incompatible default for argument
"stock_codes" (default has type "None", argument has type "list[str]") 
[assignment]
        stock_codes: list[str] = None,
                                 ^~~~
models\trainer_pipeline_ops.py:86: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_pipeline_ops.py:86: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_pipeline_ops.py:87: error: Incompatible default for argument
"epochs" (default has type "None", argument has type "int")  [assignment]
        epochs: int = None,
                      ^~~~
models\trainer_pipeline_ops.py:87: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_pipeline_ops.py:87: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_pipeline_ops.py:88: error: Incompatible default for argument
"batch_size" (default has type "None", argument has type "int")  [assignment]
        batch_size: int = None,
                          ^~~~
models\trainer_pipeline_ops.py:88: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_pipeline_ops.py:88: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_pipeline_ops.py:89: error: Incompatible default for argument
"model_names" (default has type "None", argument has type "list[str]") 
[assignment]
        model_names: list[str] = None,
                                 ^~~~
models\trainer_pipeline_ops.py:89: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_pipeline_ops.py:89: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_pipeline_ops.py:90: error: Incompatible default for argument
"callback" (default has type "None", argument has type "Callable[..., Any]") 
[assignment]
        callback: Callable = None,
                             ^~~~
models\trainer_pipeline_ops.py:90: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_pipeline_ops.py:90: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_pipeline_ops.py:95: error: Incompatible default for argument
"prediction_horizon" (default has type "None", argument has type "int") 
[assignment]
        prediction_horizon: int = None,
                                  ^~~~
models\trainer_pipeline_ops.py:95: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_pipeline_ops.py:95: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_pipeline_ops.py:96: error: Incompatible default for argument
"lookback_bars" (default has type "None", argument has type "int")  [assignment]
        lookback_bars: int = None,
                             ^~~~
models\trainer_pipeline_ops.py:96: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_pipeline_ops.py:96: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_pipeline_ops.py:97: error: Incompatible default for argument
"learning_rate" (default has type "None", argument has type "float") 
[assignment]
        learning_rate: float = None,
                               ^~~~
models\trainer_pipeline_ops.py:97: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer_pipeline_ops.py:97: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer_pipeline_ops.py:606: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _train_forecaster(
    ^~~~~~~~~~~~~~~~~~~~~~
models\trainer_pipeline_ops.py:629: error: Need type annotation for
"Xf_train_list" (hint: "Xf_train_list: list[<type>] = ...")  [var-annotated]
        Xf_train_list, Yf_train_list = [], []
        ^~~~~~~~~~~~~
models\trainer_pipeline_ops.py:629: error: Need type annotation for
"Yf_train_list" (hint: "Yf_train_list: list[<type>] = ...")  [var-annotated]
        Xf_train_list, Yf_train_list = [], []
                       ^~~~~~~~~~~~~
models\trainer_pipeline_ops.py:630: error: Need type annotation for
"Xf_val_list" (hint: "Xf_val_list: list[<type>] = ...")  [var-annotated]
        Xf_val_list, Yf_val_list = [], []
        ^~~~~~~~~~~
models\trainer_pipeline_ops.py:630: error: Need type annotation for
"Yf_val_list" (hint: "Yf_val_list: list[<type>] = ...")  [var-annotated]
        Xf_val_list, Yf_val_list = [], []
                     ^~~~~~~~~~~
models\trainer_pipeline_ops.py:821: error: Statement is unreachable 
[unreachable]
                        torch.save(payload, target_path)
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:173: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _update(self, stage=None, message=None, progress=None, **kw) -...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\auto_learner.py:209: error: Function is missing a return type annotation
 [no-untyped-def]
        def start(
        ^~~~~~~~~~
models\auto_learner.py:209: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def start(
        ^~~~~~~~~~
models\auto_learner.py:253: error: Module "data.fetcher" has no attribute
"BARS_PER_DAY"  [attr-defined]
                from data.fetcher import BARS_PER_DAY
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:301: error: Function is missing a type annotation 
[no-untyped-def]
        def run(self, **kwargs):
        ^~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:317: error: Function is missing a return type annotation
 [no-untyped-def]
        def start_targeted(
        ^~~~~~~~~~~~~~~~~~~
models\auto_learner.py:340: error: Function is missing a type annotation 
[no-untyped-def]
        def run_targeted(self, **kwargs):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:353: error: Function is missing a return type annotation
 [no-untyped-def]
        def _targeted_loop(
        ^~~~~~~~~~~~~~~~~~~
models\auto_learner.py:376: error: Function is missing a return type annotation
 [no-untyped-def]
        def _interruptible_sleep(self, seconds: int):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:476: error: Function is missing a type annotation 
[no-untyped-def]
        def _resolve_interval(self, interval, horizon, lookback):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:479: error: Module "data.fetcher" has no attribute
"BARS_PER_DAY"  [attr-defined]
                from data.fetcher import BARS_PER_DAY, INTERVAL_MAX_DAYS
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:479: error: Module "data.fetcher" has no attribute
"INTERVAL_MAX_DAYS"  [attr-defined]
                from data.fetcher import BARS_PER_DAY, INTERVAL_MAX_DAYS
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:511: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _ensure_holdout(self, interval, lookback, min_bars, cycle_numb...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\auto_learner.py:541: error: Need type annotation for "new_holdout"
(hint: "new_holdout: list[<type>] = ...")  [var-annotated]
            new_holdout = []
            ^~~~~~~~~~~
models\auto_learner.py:691: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _train(
        ^~~~~~~~~~~
models\auto_learner.py:715: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
            def cb(model_name, epoch_idx, val_acc) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:770: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _validate_and_decide(
        ^~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:907: error: Value of type "object" is not indexable 
[index]
                    payload["thresholds"]["min_confidence"],
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:908: error: Value of type "object" is not indexable 
[index]
                    payload["thresholds"]["min_agreement"],
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:909: error: Value of type "object" is not indexable 
[index]
                    payload["thresholds"]["max_entropy"],
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:910: error: Value of type "object" is not indexable 
[index]
                    payload["thresholds"]["min_edge"],
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:911: error: Value of type "object" is not indexable 
[index]
                    payload["metrics"]["profit_factor"],
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:912: error: Value of type "object" is not indexable 
[index]
                    payload["metrics"]["precision"],
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:913: error: Value of type "object" is not indexable 
[index]
                    payload["metrics"]["trades"],
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:918: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _cache_training_sequences(self, codes, interval, horizon, look...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\auto_learner.py:966: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def _log_cycle(self, cycle, new_batch, replay_batch, ok_codes, acc...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
models\auto_learner.py:1001: error: Function is missing a return type
annotation  [no-untyped-def]
        def _save_state(self):
        ^~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:1004: error: Function is missing a return type
annotation  [no-untyped-def]
        def _load_state(self):
        ^~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:1060: error: "type[ContinuousLearner]" has no attribute
"_main_loop"  [attr-defined]
    ContinuousLearner._main_loop = _main_loop_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:1061: error: "type[ContinuousLearner]" has no attribute
"_run_cycle"  [attr-defined]
    ContinuousLearner._run_cycle = _run_cycle_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\auto_learner.py:1062: error: "type[ContinuousLearner]" has no attribute
"_run_targeted_cycle"  [attr-defined]
    ContinuousLearner._run_targeted_cycle = _run_targeted_cycle_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:63: error: Incompatible types in assignment (expression has
type "None", variable has type "Callable[[str, Callable[[], Any]], None]") 
[assignment]
        register_snapshot_provider = None
                                     ^~~~
trading\executor.py:64: error: Incompatible types in assignment (expression has
type "None", variable has type "Callable[[str], bool]")  [assignment]
        unregister_snapshot_provider = None
                                       ^~~~
trading\executor.py:99: error: Incompatible default for argument "mode"
(default has type "None", argument has type "TradingMode")  [assignment]
        def __init__(self, mode: TradingMode = None) -> None:
                                               ^~~~
trading\executor.py:99: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
trading\executor.py:99: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
trading\executor.py:163: error: "ExecutionEngine" has no attribute "mode" 
[attr-defined]
            if self.mode != TradingMode.LIVE:
               ^~~~~~~~~
trading\executor.py:222: error: Statement is unreachable  [unreachable]
                return None
                ^~~~~~~~~~~
trading\executor.py:359: error: "object" has no attribute "price" 
[attr-defined]
                if q and getattr(q, "price", 0) and float(q.price) > 0:
                                                          ^~~~~~~
trading\executor.py:360: error: "object" has no attribute "price" 
[attr-defined]
                    return float(q.price)
                                 ^~~~~~~
trading\executor.py:365: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                px = self.broker.get_quote(symbol)
                     ^~~~~~~~~~~
trading\executor.py:375: error: Argument 3 to "getattr" has incompatible type
"int"; expected "Quote | None"  [arg-type]
                if q and getattr(q, "price", 0) and float(q.price) > 0:
                                             ^
trading\executor.py:388: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                        self.broker.register_order_mapping(order.id, order...
                        ^~~~~~~~~~~
trading\executor.py:397: error: Cannot determine type of "_exec_thread" 
[has-type]
                self._exec_thread,
                ^~~~~~~~~~~~~~~~~
trading\executor.py:398: error: Cannot determine type of "_fill_sync_thread" 
[has-type]
                self._fill_sync_thread,
                ^~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:399: error: Cannot determine type of "_status_sync_thread" 
[has-type]
                self._status_sync_thread,
                ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:400: error: Cannot determine type of "_recon_thread" 
[has-type]
                self._recon_thread,
                ^~~~~~~~~~~~~~~~~~
trading\executor.py:401: error: Cannot determine type of "_reconnect_thread" 
[has-type]
                self._reconnect_thread,
                ^~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:402: error: Cannot determine type of "_watchdog_thread" 
[has-type]
                self._watchdog_thread,
                ^~~~~~~~~~~~~~~~~~~~~
trading\executor.py:403: error: Cannot determine type of "_checkpoint_thread" 
[has-type]
                self._checkpoint_thread,
                ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:429: error: "ExecutionEngine" has no attribute
"_thread_hb_lock"  [attr-defined]
            with self._thread_hb_lock:
                 ^~~~~~~~~~~~~~~~~~~~
trading\executor.py:430: error: "ExecutionEngine" has no attribute
"_thread_heartbeats"  [attr-defined]
                self._thread_heartbeats[str(name)] = time.time()
                ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:434: error: "ExecutionEngine" has no attribute
"_stop_event"  [attr-defined]
            return bool(self._stop_event.wait(timeout=max(0.0, float(timeo...
                        ^~~~~~~~~~~~~~~~
trading\executor.py:439: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
            if self.auto_trader is not None:
               ^~~~~~~~~~~~~~~~
trading\executor.py:441: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
                    auto_state = self.auto_trader.get_state()
                                 ^~~~~~~~~~~~~~~~
trading\executor.py:445: error: "ExecutionEngine" has no attribute
"_thread_hb_lock"  [attr-defined]
            with self._thread_hb_lock:
                 ^~~~~~~~~~~~~~~~~~~~
trading\executor.py:446: error: "ExecutionEngine" has no attribute
"_thread_heartbeats"  [attr-defined]
                hb = dict(self._thread_heartbeats)
                          ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:449: error: "ExecutionEngine" has no attribute "_running" 
[attr-defined]
                "running": bool(self._running),
                                ^~~~~~~~~~~~~
trading\executor.py:451: error: "ExecutionEngine" has no attribute "mode" 
[attr-defined]
                "mode": str(getattr(self.mode, "value", self.mode)),
                                    ^~~~~~~~~
trading\executor.py:452: error: "ExecutionEngine" has no attribute
"_runtime_lease_id"  [attr-defined]
                "runtime_lease_id": str(self._runtime_lease_id),
                                        ^~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:456: error: "ExecutionEngine" has no attribute "_queue" 
[attr-defined]
                "queue_depth": int(self._queue.qsize()),
                                   ^~~~~~~~~~~
trading\executor.py:458: error: Item "None" of "Any | None" has no attribute
"to_dict"  [union-attr]
                    auto_state.to_dict() if hasattr(auto_state, "to_dict")...
                    ^~~~~~~~~~~~~~~~~~
trading\executor.py:465: error: "ExecutionEngine" has no attribute
"_runtime_lease_id"  [attr-defined]
                "owner_id": str(self._runtime_lease_id),
                                ^~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:468: error: "ExecutionEngine" has no attribute "mode" 
[attr-defined]
                "mode": str(getattr(self.mode, "value", self.mode)),
                                    ^~~~~~~~~
trading\executor.py:477: error: Returning Any from function declared to return
"RuntimeLeaseClient | None"  [no-any-return]
                return client
                ^~~~~~~~~~~~~
trading\executor.py:509: error: "ExecutionEngine" has no attribute
"_runtime_lease_enabled"; maybe "_runtime_lease_payload" or
"_runtime_lease_client"?  [attr-defined]
            if not self._runtime_lease_enabled:
                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:517: error: "ExecutionEngine" has no attribute
"_runtime_lease_id"  [attr-defined]
                    owner_id=self._runtime_lease_id,
                             ^~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:518: error: "ExecutionEngine" has no attribute
"_runtime_lease_ttl_seconds"  [attr-defined]
                    ttl_seconds=self._runtime_lease_ttl_seconds,
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:538: error: "ExecutionEngine" has no attribute
"_runtime_lease_enabled"; maybe "_runtime_lease_payload" or
"_runtime_lease_client"?  [attr-defined]
            if not self._runtime_lease_enabled:
                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:545: error: "ExecutionEngine" has no attribute
"_runtime_lease_id"  [attr-defined]
                    owner_id=self._runtime_lease_id,
                             ^~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:546: error: "ExecutionEngine" has no attribute
"_runtime_lease_ttl_seconds"  [attr-defined]
                    ttl_seconds=self._runtime_lease_ttl_seconds,
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:565: error: "ExecutionEngine" has no attribute
"_runtime_lease_enabled"; maybe "_runtime_lease_payload" or
"_runtime_lease_client"?  [attr-defined]
            if not self._runtime_lease_enabled:
                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:572: error: "ExecutionEngine" has no attribute
"_runtime_lease_id"  [attr-defined]
                    owner_id=self._runtime_lease_id,
                             ^~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:573: error: "ExecutionEngine" has no attribute
"_runtime_lease_id"  [attr-defined]
                    metadata={"released_by": self._runtime_lease_id},
                                             ^~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:582: error: "ExecutionEngine" has no attribute
"_runtime_state_path"; maybe "_runtime_lease_path"?  [attr-defined]
                atomic_write_json(self._runtime_state_path, payload, inden...
                                  ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:590: error: "ExecutionEngine" has no attribute
"_runtime_state_path"; maybe "_runtime_lease_path"?  [attr-defined]
                if not self._runtime_state_path.exists():
                       ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:592: error: "ExecutionEngine" has no attribute
"_runtime_state_path"; maybe "_runtime_lease_path"?  [attr-defined]
                state = read_json(self._runtime_state_path)
                                  ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:609: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
            if self.auto_trader is None or not isinstance(self._recovered_...
               ^~~~~~~~~~~~~~~~
trading\executor.py:614: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
                    self.auto_trader.pause(
                    ^~~~~~~~~~~~~~~~
trading\executor.py:618: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
                    self.auto_trader.set_mode(AutoTradeMode.MANUAL)
                    ^~~~~~~~~~~~~~~~
trading\executor.py:629: error: "ExecutionEngine" has no attribute "_running" 
[attr-defined]
            while self._running:
                  ^~~~~~~~~~~~~
trading\executor.py:639: error: "ExecutionEngine" has no attribute
"_kill_switch"; maybe "_on_kill_switch"?  [attr-defined]
                                self._kill_switch.activate(msg, activated_...
                                ^~~~~~~~~~~~~~~~~
trading\executor.py:662: error: "object" has no attribute "price" 
[attr-defined]
                    return float(q.price), ts, "feed", delayed
                                 ^~~~~~~
trading\executor.py:668: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                px = self.broker.get_quote(symbol)
                     ^~~~~~~~~~~
trading\executor.py:745: error: "ExecutionEngine" has no attribute "mode" 
[attr-defined]
                if block_delayed or str(self.mode.value).lower() == "live"...
                                        ^~~~~~~~~
trading\executor.py:823: error: "ExecutionEngine" has no attribute
"_recent_submit_keys"  [attr-defined]
            last_seen = float(self._recent_submit_keys.get(key, 0.0) or 0....
                              ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:826: error: "ExecutionEngine" has no attribute
"_recent_submit_keys"  [attr-defined]
            self._recent_submit_keys[key] = now
            ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:830: error: "ExecutionEngine" has no attribute
"_recent_submit_keys"  [attr-defined]
            stale_keys = [k for k, ts in self._recent_submit_keys.items() ...
                                         ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:832: error: "ExecutionEngine" has no attribute
"_recent_submit_keys"  [attr-defined]
                self._recent_submit_keys.pop(k, None)
                ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:836: error: "ExecutionEngine" has no attribute
"_recent_submissions"  [attr-defined]
            bucket = self._recent_submissions.get(sym)
                     ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:839: error: "ExecutionEngine" has no attribute
"_recent_submissions"  [attr-defined]
                self._recent_submissions[sym] = bucket
                ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:858: error: "ExecutionEngine" has no attribute
"_recent_rejections"  [attr-defined]
            self._recent_rejections.append(now)
            ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:859: error: "ExecutionEngine" has no attribute
"_recent_rejections"  [attr-defined]
            while self._recent_rejections and (now - float(self._recent_re...
                  ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:860: error: "ExecutionEngine" has no attribute
"_recent_rejections"  [attr-defined]
                self._recent_rejections.popleft()
                ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:861: error: "ExecutionEngine" has no attribute
"_recent_rejections"  [attr-defined]
    ...  set_gauge("order_rejections_window", float(len(self._recent_rejectio...
                                                        ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:864: error: "ExecutionEngine" has no attribute
"_recent_rejections"  [attr-defined]
            if len(self._recent_rejections) < max(3, threshold):
                   ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:867: error: "ExecutionEngine" has no attribute
"_kill_switch"; maybe "_on_kill_switch"?  [attr-defined]
                if self._kill_switch.can_trade:
                   ^~~~~~~~~~~~~~~~~
trading\executor.py:868: error: "ExecutionEngine" has no attribute
"_recent_rejections"  [attr-defined]
    ...     msg = f"Excessive rejections detected ({len(self._recent_rejectio...
                                                        ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:869: error: "ExecutionEngine" has no attribute
"_kill_switch"; maybe "_on_kill_switch"?  [attr-defined]
                    self._kill_switch.activate(msg, activated_by="executio...
                    ^~~~~~~~~~~~~~~~~
trading\executor.py:872: error: "ExecutionEngine" has no attribute
"_recent_rejections"  [attr-defined]
                        {"count": int(len(self._recent_rejections)), "last...
                                          ^~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:883: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
                if self.auto_trader and self.auto_trader.get_mode() != Aut...
                   ^~~~~~~~~~~~~~~~
trading\executor.py:884: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
                    self.auto_trader.set_mode(AutoTradeMode.MANUAL)
                    ^~~~~~~~~~~~~~~~
trading\executor.py:886: error: "ExecutionEngine" has no attribute
"_alert_manager"  [attr-defined]
                    self._alert_manager.risk_alert(
                    ^~~~~~~~~~~~~~~~~~~
trading\executor.py:916: error: Returning Any from function declared to return
"bool"  [no-any-return]
            return self.submit(signal)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:916: error: "ExecutionEngine" has no attribute "submit" 
[attr-defined]
            return self.submit(signal)
                   ^~~~~~~~~~~
trading\executor.py:921: error: "ExecutionEngine" has no attribute "_running" 
[attr-defined]
            while self._running:
                  ^~~~~~~~~~~~~
trading\executor.py:924: error: "ExecutionEngine" has no attribute "_queue" 
[attr-defined]
                    signal = self._queue.get(timeout=0.2)
                             ^~~~~~~~~~~
trading\executor.py:927: error: "ExecutionEngine" has no attribute "_execute" 
[attr-defined]
                    self._execute(signal)
                    ^~~~~~~~~~~~~
trading\executor.py:932: error: "ExecutionEngine" has no attribute
"_alert_manager"  [attr-defined]
                    self._alert_manager.system_alert(
                    ^~~~~~~~~~~~~~~~~~~
trading\executor.py:938: error: "ExecutionEngine" has no attribute
"risk_manager"  [attr-defined]
                    self.risk_manager
                    ^~~~~~~~~~~~~~~~~
trading\executor.py:939: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                    and self.broker.is_connected
                        ^~~~~~~~~~~
trading\executor.py:943: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                        account = self.broker.get_account()
                                  ^~~~~~~~~~~
trading\executor.py:944: error: "ExecutionEngine" has no attribute
"risk_manager"  [attr-defined]
                        self.risk_manager.update(account)
                        ^~~~~~~~~~~~~~~~~
trading\executor.py:956: error: "ExecutionEngine" has no attribute
"risk_manager"  [attr-defined]
            if self.risk_manager:
               ^~~~~~~~~~~~~~~~~
trading\executor.py:957: error: Returning Any from function declared to return
"dict[str, Any] | None"  [no-any-return]
                return self.risk_manager.get_metrics()
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:957: error: "ExecutionEngine" has no attribute
"risk_manager"  [attr-defined]
                return self.risk_manager.get_metrics()
                       ^~~~~~~~~~~~~~~~~
trading\executor.py:961: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
            if not self.auto_trader:
                   ^~~~~~~~~~~~~~~~
trading\executor.py:966: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
            with self.auto_trader._lock:
                 ^~~~~~~~~~~~~~~~
trading\executor.py:967: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
                for action in self.auto_trader.state.recent_actions:
                              ^~~~~~~~~~~~~~~~
trading\executor.py:976: error: "ExecutionEngine" has no attribute "_running" 
[attr-defined]
            while self._running:
                  ^~~~~~~~~~~~~
trading\executor.py:981: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                    if not self.broker.is_connected:
                           ^~~~~~~~~~~
trading\executor.py:983: error: "ExecutionEngine" has no attribute
"_process_pending_fills"  [attr-defined]
                    self._process_pending_fills()
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:984: error: "ExecutionEngine" has no attribute
"_evaluate_synthetic_exits"; maybe "_restore_synthetic_exits" or
"_persist_synthetic_exits"?  [attr-defined]
                    self._evaluate_synthetic_exits()
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:994: error: Cannot determine type of "_processed_fill_ids" 
[has-type]
            if len(self._processed_fill_ids) <= int(max_size):
                   ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1017: error: "ExecutionEngine" has no attribute "_running" 
[attr-defined]
            while self._running:
                  ^~~~~~~~~~~~~
trading\executor.py:1022: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                    if self.broker.is_connected:
                       ^~~~~~~~~~~
trading\executor.py:1033: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                        ok = self.broker.connect(
                             ^~~~~~~~~~~
trading\executor.py:1040: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                        ok = self.broker.connect()
                             ^~~~~~~~~~~
trading\executor.py:1045: error: "ExecutionEngine" has no attribute
"_startup_sync"  [attr-defined]
                        self._startup_sync()
                        ^~~~~~~~~~~~~~~~~~
trading\executor.py:1058: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
            if self.auto_trader:
               ^~~~~~~~~~~~~~~~
trading\executor.py:1060: error: "ExecutionEngine" has no attribute
"auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"?  [attr-defined]
                    self.auto_trader.pause(f"Kill switch: {reason}")
                    ^~~~~~~~~~~~~~~~
trading\executor.py:1065: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                for order in self.broker.get_orders(active_only=True):
                             ^~~~~~~~~~~
trading\executor.py:1067: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
                        self.broker.cancel_order(order.id)
                        ^~~~~~~~~~~
trading\executor.py:1078: error: "ExecutionEngine" has no attribute "_queue" 
[attr-defined]
                while not self._queue.empty():
                          ^~~~~~~~~~~
trading\executor.py:1079: error: "ExecutionEngine" has no attribute "_queue" 
[attr-defined]
                    self._queue.get_nowait()
                    ^~~~~~~~~~~
trading\executor.py:1083: error: "ExecutionEngine" has no attribute
"_alert_manager"  [attr-defined]
            self._alert_manager.critical_alert(
            ^~~~~~~~~~~~~~~~~~~
trading\executor.py:1095: error: "ExecutionEngine" has no attribute "on_reject"
 [attr-defined]
            if self.on_reject:
               ^~~~~~~~~~~~~~
trading\executor.py:1104: error: "ExecutionEngine" has no attribute "on_reject"
 [attr-defined]
                self.on_reject(order, reason)
                ^~~~~~~~~~~~~~
trading\executor.py:1117: error: "ExecutionEngine" has no attribute "broker" 
[attr-defined]
            return self.broker.get_orders()
                   ^~~~~~~~~~~
trading\executor.py:1118: error: "type[ExecutionEngine]" has no attribute
"start"  [attr-defined]
    ExecutionEngine.start = _start_impl
    ^~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1119: error: "type[ExecutionEngine]" has no attribute
"stop"  [attr-defined]
    ExecutionEngine.stop = _stop_impl
    ^~~~~~~~~~~~~~~~~~~~
trading\executor.py:1120: error: "type[ExecutionEngine]" has no attribute
"_build_execution_snapshot"  [attr-defined]
    ExecutionEngine._build_execution_snapshot = _build_execution_snapshot_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1121: error: "type[ExecutionEngine]" has no attribute
"_get_execution_quality_snapshot"  [attr-defined]
    ExecutionEngine._get_execution_quality_snapshot = _get_execution_quali...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1122: error: "type[ExecutionEngine]" has no attribute
"_watchdog_loop"  [attr-defined]
    ExecutionEngine._watchdog_loop = _watchdog_loop_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1123: error: "type[ExecutionEngine]" has no attribute
"submit"  [attr-defined]
    ExecutionEngine.submit = _submit_impl
    ^~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1124: error: "type[ExecutionEngine]" has no attribute
"_execute"  [attr-defined]
    ExecutionEngine._execute = _execute_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1125: error: "type[ExecutionEngine]" has no attribute
"_startup_sync"  [attr-defined]
    ExecutionEngine._startup_sync = _startup_sync_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1126: error: "type[ExecutionEngine]" has no attribute
"_process_pending_fills"  [attr-defined]
    ExecutionEngine._process_pending_fills = _process_pending_fills_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1127: error: "type[ExecutionEngine]" has no attribute
"_cancel_oco_siblings"  [attr-defined]
    ExecutionEngine._cancel_oco_siblings = _cancel_oco_siblings_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1128: error: "type[ExecutionEngine]" has no attribute
"_record_execution_quality"  [attr-defined]
    ExecutionEngine._record_execution_quality = _record_execution_quality_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1129: error: "type[ExecutionEngine]" has no attribute
"_maybe_register_synthetic_exit"  [attr-defined]
    ExecutionEngine._maybe_register_synthetic_exit = _maybe_register_synth...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1130: error: "type[ExecutionEngine]" has no attribute
"_evaluate_synthetic_exits"  [attr-defined]
    ExecutionEngine._evaluate_synthetic_exits = _evaluate_synthetic_exits_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1131: error: "type[ExecutionEngine]" has no attribute
"_submit_synthetic_exit"  [attr-defined]
    ExecutionEngine._submit_synthetic_exit = _submit_synthetic_exit_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1132: error: "type[ExecutionEngine]" has no attribute
"_status_sync_loop"  [attr-defined]
    ExecutionEngine._status_sync_loop = _status_sync_loop_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1133: error: "type[ExecutionEngine]" has no attribute
"_reconciliation_loop"  [attr-defined]
    ExecutionEngine._reconciliation_loop = _reconciliation_loop_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
trading\executor.py:1134: error: "type[ExecutionEngine]" has no attribute
"_submit_with_retry"  [attr-defined]
    ExecutionEngine._submit_with_retry = _submit_with_retry_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:56: error: Incompatible types in assignment (expression has
type "None", variable has type
"Callable[[str | Path, Any, int, bool, bool], None]")  [assignment]
        atomic_write_json = None
                            ^~~~
models\trainer.py:57: error: Incompatible types in assignment (expression has
type "None", variable has type "Callable[[str | Path], Any]")  [assignment]
        read_json = None
                    ^~~~
models\trainer.py:154: error: Module "data.fetcher" has no attribute
"BARS_PER_DAY"  [attr-defined]
                from data.fetcher import BARS_PER_DAY, INTERVAL_MAX_DAYS
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:154: error: Module "data.fetcher" has no attribute
"INTERVAL_MAX_DAYS"  [attr-defined]
                from data.fetcher import BARS_PER_DAY, INTERVAL_MAX_DAYS
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:279: error: "Trainer" has no attribute "_split_single_stock" 
[attr-defined]
                splits = self._split_single_stock(df_raw, horizon, feature...
                         ^~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:358: error: Returning Any from function declared to return
"ndarray[Any, Any]"  [no-any-return]
            return arr[np.isfinite(arr)]
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:582: error: Statement is unreachable  [unreachable]
                    with open(path, encoding="utf-8") as f:
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:596: error: Statement is unreachable  [unreachable]
                    with open(path, "w", encoding="utf-8") as f:
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:604: error: Incompatible default for argument "stock_codes"
(default has type "None", argument has type "list[str]")  [assignment]
            stock_codes: list[str] = None,
                                     ^~~~
models\trainer.py:604: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer.py:604: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer.py:605: error: Incompatible default for argument "epochs"
(default has type "None", argument has type "int")  [assignment]
            epochs: int = None,
                          ^~~~
models\trainer.py:605: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer.py:605: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer.py:606: error: Incompatible default for argument "batch_size"
(default has type "None", argument has type "int")  [assignment]
            batch_size: int = None,
                              ^~~~
models\trainer.py:606: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer.py:606: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer.py:607: error: Incompatible default for argument "model_names"
(default has type "None", argument has type "list[str]")  [assignment]
            model_names: list[str] = None,
                                     ^~~~
models\trainer.py:607: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer.py:607: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer.py:608: error: Incompatible default for argument "callback"
(default has type "None", argument has type "Callable[..., Any]")  [assignment]
            callback: Callable = None,
                                 ^~~~
models\trainer.py:608: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer.py:608: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer.py:613: error: Incompatible default for argument
"prediction_horizon" (default has type "None", argument has type "int") 
[assignment]
            prediction_horizon: int = None,
                                      ^~~~
models\trainer.py:613: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer.py:613: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer.py:614: error: Incompatible default for argument "lookback_bars"
(default has type "None", argument has type "int")  [assignment]
            lookback_bars: int = None,
                                 ^~~~
models\trainer.py:614: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer.py:614: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer.py:615: error: Incompatible default for argument "learning_rate"
(default has type "None", argument has type "float")  [assignment]
            learning_rate: float = None,
                                   ^~~~
models\trainer.py:615: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
models\trainer.py:615: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
models\trainer.py:701: error: "type[Trainer]" has no attribute
"_assess_raw_data_quality"  [attr-defined]
    Trainer._assess_raw_data_quality = _assess_raw_data_quality_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:702: error: "type[Trainer]" has no attribute
"_split_single_stock"  [attr-defined]
    Trainer._split_single_stock = _split_single_stock_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:703: error: "type[Trainer]" has no attribute
"_fetch_raw_data"  [attr-defined]
    Trainer._fetch_raw_data = _fetch_raw_data_impl
    ^~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:704: error: "type[Trainer]" has no attribute
"_create_sequences_from_splits"  [attr-defined]
    Trainer._create_sequences_from_splits = _create_sequences_from_splits_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:705: error: "type[Trainer]" has no attribute
"_rebalance_train_samples"  [attr-defined]
    Trainer._rebalance_train_samples = _rebalance_train_samples_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:706: error: "type[Trainer]" has no attribute
"_effective_confidence_floor"  [attr-defined]
    Trainer._effective_confidence_floor = _effective_confidence_floor_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:707: error: "type[Trainer]" has no attribute
"_fallback_temporal_validation_split"  [attr-defined]
    Trainer._fallback_temporal_validation_split = _fallback_temporal_valid...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:708: error: "type[Trainer]" has no attribute
"_walk_forward_validate"  [attr-defined]
    Trainer._walk_forward_validate = _walk_forward_validate_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:709: error: "type[Trainer]" has no attribute
"_build_quality_gate"  [attr-defined]
    Trainer._build_quality_gate = _build_quality_gate_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:710: error: "type[Trainer]" has no attribute
"_run_drift_guard"  [attr-defined]
    Trainer._run_drift_guard = _run_drift_guard_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:711: error: "type[Trainer]" has no attribute
"_trade_quality_thresholds"  [attr-defined]
    Trainer._trade_quality_thresholds = _trade_quality_thresholds_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:712: error: "type[Trainer]" has no attribute "_trade_masks" 
[attr-defined]
    Trainer._trade_masks = staticmethod(_trade_masks_impl)
    ^~~~~~~~~~~~~~~~~~~~
models\trainer.py:713: error: "type[Trainer]" has no attribute
"_build_explainability_samples"  [attr-defined]
    Trainer._build_explainability_samples = _build_explainability_samples_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:714: error: "type[Trainer]" has no attribute "prepare_data" 
[attr-defined]
    Trainer.prepare_data = _prepare_data_impl
    ^~~~~~~~~~~~~~~~~~~~
models\trainer.py:715: error: "type[Trainer]" has no attribute
"_build_trading_stress_tests"  [attr-defined]
    Trainer._build_trading_stress_tests = _build_trading_stress_tests_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
models\trainer.py:716: error: "type[Trainer]" has no attribute "_evaluate" 
[attr-defined]
    Trainer._evaluate = _evaluate_impl
    ^~~~~~~~~~~~~~~~~
models\trainer.py:717: error: "type[Trainer]" has no attribute
"_simulate_trading"  [attr-defined]
    Trainer._simulate_trading = _simulate_trading_impl
    ^~~~~~~~~~~~~~~~~~~~~~~~~
models\__init__.py:12: error: Incompatible types in assignment (expression has
type "None", variable has type "type[MultiHeadAttention]")  [assignment]
        MultiHeadAttention = None
                             ^~~~
models\__init__.py:13: error: Incompatible types in assignment (expression has
type "None", variable has type "type[PositionalEncoding]")  [assignment]
        PositionalEncoding = None
                             ^~~~
models\__init__.py:14: error: Incompatible types in assignment (expression has
type "None", variable has type "type[LSTMBlock]")  [assignment]
        LSTMBlock = None
                    ^~~~
models\__init__.py:15: error: Incompatible types in assignment (expression has
type "None", variable has type "type[TransformerBlock]")  [assignment]
        TransformerBlock = None
                           ^~~~
models\__init__.py:16: error: Incompatible types in assignment (expression has
type "None", variable has type "type[TemporalConvBlock]")  [assignment]
        TemporalConvBlock = None
                            ^~~~
models\__init__.py:17: error: Incompatible types in assignment (expression has
type "None", variable has type "type[AttentionPooling]")  [assignment]
        AttentionPooling = None
                           ^~~~
models\__init__.py:28: error: Incompatible types in assignment (expression has
type "None", variable has type "type[LSTMModel]")  [assignment]
        LSTMModel = None
                    ^~~~
models\__init__.py:29: error: Incompatible types in assignment (expression has
type "None", variable has type "type[TransformerModel]")  [assignment]
        TransformerModel = None
                           ^~~~
models\__init__.py:30: error: Incompatible types in assignment (expression has
type "None", variable has type "type[GRUModel]")  [assignment]
        GRUModel = None
                   ^~~~
models\__init__.py:31: error: Incompatible types in assignment (expression has
type "None", variable has type "type[TCNModel]")  [assignment]
        TCNModel = None
                   ^~~~
models\__init__.py:32: error: Incompatible types in assignment (expression has
type "None", variable has type "type[HybridModel]")  [assignment]
        HybridModel = None
                      ^~~~
models\__init__.py:37: error: Incompatible types in assignment (expression has
type "None", variable has type "type[EnsembleModel]")  [assignment]
        EnsembleModel = None
                        ^~~~
models\__init__.py:38: error: Incompatible types in assignment (expression has
type "None", variable has type "type[EnsemblePrediction]")  [assignment]
        EnsemblePrediction = None
                             ^~~~
models\__init__.py:43: error: Incompatible types in assignment (expression has
type "None", variable has type "type[Trainer]")  [assignment]
        Trainer = None
                  ^~~~
models\__init__.py:48: error: Incompatible types in assignment (expression has
type "None", variable has type "type[Predictor]")  [assignment]
        Predictor = None
                    ^~~~
models\__init__.py:53: error: Incompatible types in assignment (expression has
type "None", variable has type "type[ContinuousLearner]")  [assignment]
        AutoLearner = None
                      ^~~~
models\__init__.py:54: error: Incompatible types in assignment (expression has
type "None", variable has type "type[LearningProgress]")  [assignment]
        LearningProgress = None
                           ^~~~
ui\widgets.py:38: error: Function is missing a return type annotation 
[no-untyped-def]
    def _get_signal_enum():
    ^~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:196: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def update_prediction(self, pred) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:202: error: Item "None" of "Any | None" has no attribute "value" 
[union-attr]
                sig.value if hasattr(sig, "value") else (str(sig) if sig e...
                ^~~~~~~~~
ui\widgets.py:336: error: Item "None" of "QHeaderView | None" has no attribute
"setSectionResizeMode"  [union-attr]
            self.horizontalHeader().setSectionResizeMode(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:341: error: Item "None" of "QHeaderView | None" has no attribute
"setVisible"  [union-attr]
            self.verticalHeader().setVisible(False)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:344: error: Function is missing a type annotation 
[no-untyped-def]
        def _safe_attr(obj, attr, default=0):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:361: error: Statement is unreachable  [unreachable]
                positions = {}
                ^~~~~~~~~~~~~~
ui\widgets.py:578: error: Incompatible types in assignment (expression has type
"QLabel", variable has type "None")  [assignment]
            self.value_label = QLabel(str(value))
                               ^~~~~~~~~~~~~~~~~~
ui\widgets.py:579: error: "None" has no attribute "setStyleSheet" 
[attr-defined]
            self.value_label.setStyleSheet(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:588: error: Incompatible default for argument "color" (default
has type "None", argument has type "str")  [assignment]
        def set_value(self, value: str, color: str = None) -> None:
                                                     ^~~~
ui\widgets.py:588: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
ui\widgets.py:588: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
ui\widgets.py:593: error: Statement is unreachable  [unreachable]
            self.value_label.setText(str(value))
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:621: error: Incompatible types in assignment (expression has type
"QLabel", variable has type "None")  [assignment]
            self.connection_label = QLabel("Disconnected")
                                    ^~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:622: error: "None" has no attribute "setStyleSheet" 
[attr-defined]
            self.connection_label.setStyleSheet(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:629: error: Incompatible types in assignment (expression has type
"QLabel", variable has type "None")  [assignment]
            self.market_label = QLabel("Market: --")
                                ^~~~~~~~~~~~~~~~~~~~
ui\widgets.py:630: error: "None" has no attribute "setStyleSheet" 
[attr-defined]
            self.market_label.setStyleSheet(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:637: error: Incompatible types in assignment (expression has type
"QLabel", variable has type "None")  [assignment]
            self.mode_label = QLabel("Mode: Paper Trading")
                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:638: error: "None" has no attribute "setStyleSheet" 
[attr-defined]
            self.mode_label.setStyleSheet(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\widgets.py:648: error: Statement is unreachable  [unreachable]
            if connected:
            ^~~~~~~~~~~~~
ui\widgets.py:675: error: Statement is unreachable  [unreachable]
            if is_open:
            ^~~~~~~~~~~
tests\test_trainer_risk_hardening.py:14: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_evaluate_falls_back_when_sklearn_metrics_missing(monkeypatch)...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_trainer_risk_hardening.py:16: error: Incompatible types in
assignment (expression has type "SimpleNamespace", variable has type
"EnsembleModel | None")  [assignment]
        trainer.ensemble = SimpleNamespace(
                           ^~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:30: error: "Trainer" has no attribute
"_effective_confidence_floor"  [attr-defined]
        trainer._effective_confidence_floor = lambda *_a, **_k: 0.6
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:31: error: "Trainer" has no attribute
"_trade_quality_thresholds"  [attr-defined]
        trainer._trade_quality_thresholds = lambda *_a, **_k: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:32: error: "Trainer" has no attribute
"_trade_masks"  [attr-defined]
        trainer._trade_masks = lambda *_a, **_k: {}
        ^~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:33: error: "Trainer" has no attribute
"_simulate_trading"  [attr-defined]
        trainer._simulate_trading = lambda *_a, **_k: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:34: error: "Trainer" has no attribute
"_build_trading_stress_tests"  [attr-defined]
        trainer._build_trading_stress_tests = lambda *_a, **_k: {}
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:35: error: "Trainer" has no attribute
"_build_explainability_samples"  [attr-defined]
        trainer._build_explainability_samples = lambda *_a, **_k: []
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:36: error: Cannot assign to a method 
[method-assign]
        trainer._risk_adjusted_score = lambda *_a, **_k: 0.0
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:40: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_import(name, globals=None, locals=None, fromlist=(), lev...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_trainer_risk_hardening.py:51: error: "Trainer" has no attribute
"_evaluate"  [attr-defined]
        out = trainer._evaluate(X, y, r, regime_profile={"level": "normal"...
              ^~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:75: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history(self, code, **kwargs):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:78: error: Incompatible types in
assignment (expression has type "_Fetcher", variable has type "DataFetcher") 
[assignment]
        trainer.fetcher = _Fetcher()
                          ^~~~~~~~~~
tests\test_trainer_risk_hardening.py:80: error: "Trainer" has no attribute
"_fetch_raw_data"  [attr-defined]
        out = trainer._fetch_raw_data(
              ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:115: error: Function is missing a type
annotation  [no-untyped-def]
            def clean_code(code):
            ^~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:118: error: Function is missing a type
annotation  [no-untyped-def]
            def reconcile_pending_cache_sync(self, codes=None, interval="1...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_trainer_risk_hardening.py:123: error: Function is missing a type
annotation  [no-untyped-def]
            def get_pending_reconcile_codes(interval="1m"):  # noqa: ARG00...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:127: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history(code, **kwargs):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:131: error: Incompatible types in
assignment (expression has type "_Fetcher", variable has type "DataFetcher") 
[assignment]
        trainer.fetcher = fetcher
                          ^~~~~~~
tests\test_trainer_risk_hardening.py:133: error: "Trainer" has no attribute
"_fetch_raw_data"  [attr-defined]
        out = trainer._fetch_raw_data(
              ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:170: error: "Trainer" has no attribute
"_build_quality_gate"  [attr-defined]
        out = trainer._build_quality_gate(
              ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:204: error: "Trainer" has no attribute
"_build_quality_gate"  [attr-defined]
        out = trainer._build_quality_gate(
              ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:218: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_train_blocks_incremental_mode_on_high_regime(monkeypatch, tmp...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_trainer_risk_hardening.py:335: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def __init__(self, input_size, model_names=None) -> None:  # n...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_trainer_risk_hardening.py:340: error: Need type annotation for
"trained_stock_codes" (hint: "trained_stock_codes: list[<type>] = ...") 
[var-annotated]
                self.trained_stock_codes = []
                ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:342: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def load(self, path) -> bool:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:346: error: Function is missing a type
annotation  [no-untyped-def]
            def train(
            ^~~~~~~~~~
tests\test_trainer_risk_hardening.py:360: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def save(self, path) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_trainer_risk_hardening.py:394: error: "Trainer" has no attribute
"_rebalance_train_samples"  [attr-defined]
        X_out, y_out, r_out, report = trainer._rebalance_train_samples(X, ...
                                      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_simulator_advanced_orders.py:12: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_simulator_quote_falls_back_to_recent_cache(monkeypatch) -> No...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_simulator_advanced_orders.py:19: error: Function is missing a type
annotation  [no-untyped-def]
            def get_realtime(self, symbol):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_simulator_advanced_orders.py:35: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_simulator_quote_falls_back_to_history_close(monkeypatch) -> N...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_simulator_advanced_orders.py:39: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def get_realtime(self, symbol) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_simulator_advanced_orders.py:42: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history(
            ^~~~~~~~~~~~~~~~
tests\test_simulator_advanced_orders.py:59: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_stop_order_waits_for_trigger_then_fills(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_simulator_advanced_orders.py:90: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_trailing_sell_waits_then_triggers_on_pullback(monkeypatch) ->...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_runtime_lease.py:10: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def _mk_engine(tmp_path, lease_id: str) -> ExecutionEngine:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_runtime_lease.py:12: error: "ExecutionEngine" has no attribute
"mode"  [attr-defined]
        eng.mode = SimpleNamespace(value="simulation")
        ^~~~~~~~
tests\test_runtime_lease.py:13: error: "ExecutionEngine" has no attribute
"_runtime_lease_enabled"; maybe "_runtime_lease_payload" or
"_runtime_lease_client"?  [attr-defined]
        eng._runtime_lease_enabled = True
        ^~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_runtime_lease.py:14: error: "ExecutionEngine" has no attribute
"_runtime_lease_ttl_seconds"  [attr-defined]
        eng._runtime_lease_ttl_seconds = 30.0
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_runtime_lease.py:15: error: "ExecutionEngine" has no attribute
"_runtime_lease_id"  [attr-defined]
        eng._runtime_lease_id = lease_id
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_runtime_lease.py:21: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_runtime_lease_exclusive_owner(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_runtime_lease.py:30: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_runtime_lease_refresh_and_release(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_runtime_lease.py:40: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_sqlite_runtime_lease_exclusive_owner(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_runtime_lease.py:54: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_sqlite_runtime_lease_stale_takeover_increments_fencing_token(...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_runtime_lease.py:79: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_file_runtime_lease_contention_has_single_winner(tmp_path, mon...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_runtime_lease.py:88: error: Function is missing a type annotation 
[no-untyped-def]
        def _patched_row(self, *args, **kwargs):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_profit_sizing.py:31: error: "Predictor" has no attribute
"_calculate_position"  [attr-defined]
        pos = p._calculate_position(pred)
              ^~~~~~~~~~~~~~~~~~~~~
tests\test_profit_sizing.py:56: error: "Predictor" has no attribute
"_calculate_position"  [attr-defined]
        pos = p._calculate_position(pred)
              ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_model_selection.py:4: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _touch(path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_model_selection.py:8: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_model_pair_prefers_same_interval_when_exact_horizon_missing(t...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_model_selection.py:26: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_model_pair_prefers_exact_interval_and_horizon(tmp_path) -> No...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_model_selection.py:44: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_model_pair_intraday_request_prefers_intraday_fallback(tmp_pat...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_model_selection.py:61: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_best_scaler_checkpoint_prefers_same_interval_nearest_horizon(...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_model_selection.py:76: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_model_checkpoint_selection_accepts_candidate_suffix(tmp_path)...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_model_selection.py:96: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_trained_stock_fallback_uses_matching_learner_state(tmp_path) ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_model_selection.py:129: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_trained_stock_last_train_manifest_fallback(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:13: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _touch(path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:17: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_forecaster_checkpoint_prefers_same_interval(tmp_path) -> None...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:32: error: Function is missing a return type
annotation  [no-untyped-def]
        def eval(self):
        ^~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:35: error: Function is missing a type
annotation  [no-untyped-def]
        def __call__(self, _x):
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:44: error: Incompatible types in assignment
(expression has type "_DummyForecaster", variable has type "None")  [assignment]
        predictor.forecaster = _DummyForecaster()
                               ^~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:47: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out = predictor._generate_forecast(
              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:60: error: Incompatible types in assignment
(expression has type "_DummyForecaster", variable has type "None")  [assignment]
        predictor.forecaster = _DummyForecaster()
                               ^~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:63: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out = predictor._generate_forecast(
              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:79: error: Function is missing a type
annotation  [no-untyped-def]
        def predict(self, _x):
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:86: error: Incompatible types in assignment
(expression has type "_DummyEnsemble", variable has type "None")  [assignment]
        predictor.ensemble = _DummyEnsemble()
                             ^~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:89: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out_a = predictor._generate_forecast(
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:97: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out_b = predictor._generate_forecast(
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:117: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out = predictor._generate_forecast(
              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:134: error: Incompatible types in assignment
(expression has type "_DummyEnsemble", variable has type "None")  [assignment]
        predictor.ensemble = _DummyEnsemble()
                             ^~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:137: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out_a = predictor._generate_forecast(
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:146: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out_b = predictor._generate_forecast(
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:162: error: Function is missing a type
annotation  [no-untyped-def]
        def predict(self, _x):
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:167: error: Function is missing a return type
annotation  [no-untyped-def]
        def eval(self):
        ^~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:170: error: Function is missing a type
annotation  [no-untyped-def]
        def __call__(self, _x):
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:179: error: Incompatible types in assignment
(expression has type "_NeutralEnsemble", variable has type "None")  [assignment]
        predictor.ensemble = _NeutralEnsemble()
                             ^~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:182: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out = predictor._generate_forecast(
              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:198: error: Incompatible types in assignment
(expression has type "_ConstantUpForecaster", variable has type "None") 
[assignment]
        predictor.forecaster = _ConstantUpForecaster()
                               ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:199: error: Incompatible types in assignment
(expression has type "_NeutralEnsemble", variable has type "None")  [assignment]
        predictor.ensemble = _NeutralEnsemble()
                             ^~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:202: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out = predictor._generate_forecast(
              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:228: error: Incompatible types in assignment
(expression has type "_NeutralEnsemble", variable has type "None")  [assignment]
        predictor.ensemble = _NeutralEnsemble()
                             ^~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:231: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out_pos = predictor._generate_forecast(
                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:241: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        out_neg = predictor._generate_forecast(
                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:260: error: "Predictor" has no attribute
"_get_news_sentiment"  [attr-defined]
        predictor._get_news_sentiment = lambda *_args, **_kwargs: (0.8, 0....
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:271: error: "Predictor" has no attribute
"_apply_news_influence"  [attr-defined]
        news_bias = predictor._apply_news_influence(pred, "600519", "1m")
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:292: error: "Predictor" has no attribute
"_set_cached_prediction"  [attr-defined]
        predictor._set_cached_prediction("600519:1m:30", pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:294: error: "Predictor" has no attribute
"_get_cached_prediction"  [attr-defined]
        cached = predictor._get_cached_prediction("600519:1m:30")
                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:298: error: "Predictor" has no attribute
"_get_cached_prediction"  [attr-defined]
        cached_again = predictor._get_cached_prediction("600519:1m:30")
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:301: error: "Predictor" has no attribute
"_get_cached_prediction"  [attr-defined]
        assert predictor._get_cached_prediction("600519:1d:5") is None
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:317: error: "Predictor" has no attribute
"_set_cached_prediction"  [attr-defined]
        predictor._set_cached_prediction("600519:1m:30:rt", pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:322: error: "Predictor" has no attribute
"_get_cached_prediction"  [attr-defined]
        assert predictor._get_cached_prediction("600519:1m:30:rt", ttl=5.0...
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:323: error: "Predictor" has no attribute
"_get_cached_prediction"  [attr-defined]
        assert predictor._get_cached_prediction("600519:1m:30:rt", ttl=1.2...
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:331: error: "Predictor" has no attribute
"_get_cache_ttl"  [attr-defined]
        assert predictor._get_cache_ttl(use_realtime=False, interval="1m")...
               ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:332: error: "Predictor" has no attribute
"_get_cache_ttl"  [attr-defined]
        assert predictor._get_cache_ttl(use_realtime=True, interval="1m") ...
               ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:333: error: "Predictor" has no attribute
"_get_cache_ttl"  [attr-defined]
        assert predictor._get_cache_ttl(use_realtime=True, interval="1d") ...
               ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:356: error: "Predictor" has no attribute
"_sanitize_history_df"  [attr-defined]
        out = predictor._sanitize_history_df(df, "1m")
              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:387: error: "Predictor" has no attribute
"_sanitize_history_df"  [attr-defined]
        out = predictor._sanitize_history_df(base, "1m")
              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:398: error: Function is missing a type
annotation  [no-untyped-def]
        def predict_batch(self, X, batch_size=1024):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:413: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def predict(self, _x) -> NoReturn:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:423: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def predict_batch(self, X, batch_size=1024) -> NoReturn:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:427: error: Function is missing a type
annotation  [no-untyped-def]
        def predict(self, _x):
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:441: error: Function is missing a type
annotation  [no-untyped-def]
        def create_features(self, df):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:446: error: Function is missing a type
annotation  [no-untyped-def]
        def prepare_inference_sequence(self, df, _feature_cols):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:467: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def _mk_quick_predictor(ensemble) -> Predictor:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:473: error: Incompatible types in assignment
(expression has type "_DummyFeatureEngine", variable has type "None") 
[assignment]
        predictor.feature_engine = _DummyFeatureEngine()
                                   ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:474: error: Incompatible types in assignment
(expression has type "_DummyProcessor", variable has type "None")  [assignment]
        predictor.processor = _DummyProcessor()
                              ^~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:476: error: "Predictor" has no attribute
"_clean_code"  [attr-defined]
        predictor._clean_code = lambda code: str(code).strip()
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:477: error: "Predictor" has no attribute
"_fetch_data"  [attr-defined]
        predictor._fetch_data = (
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:483: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_realtime_forecast_curve_defaults_to_30_on_latest_1680_bars(mo...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_forecast.py:488: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history(self, _code, interval, bars, use_cache=True, u...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_forecast.py:503: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def get_realtime(self, _code) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:507: error: Function is missing a type
annotation  [no-untyped-def]
            def read_history(self, symbol, interval, bars=500, final_only=...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_forecast.py:520: error: "Predictor" has no attribute
"_clean_code"  [attr-defined]
        predictor._clean_code = lambda code: str(code).strip()
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:521: error: Incompatible types in assignment
(expression has type "_DummyFeatureEngine", variable has type "None") 
[assignment]
        predictor.feature_engine = _DummyFeatureEngine()
                                   ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:522: error: Incompatible types in assignment
(expression has type "_DummyProcessor", variable has type "None")  [assignment]
        predictor.processor = _DummyProcessor()
                              ^~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:524: error: Incompatible types in assignment
(expression has type "_Fetcher", variable has type "None")  [assignment]
        predictor.fetcher = _Fetcher()
                            ^~~~~~~~~~
tests\test_predictor_forecast.py:525: error: "Predictor" has no attribute
"_get_atr_pct"  [attr-defined]
        predictor._get_atr_pct = lambda _df: 0.02
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:529: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_generate(
        ^~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:542: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        predictor._generate_forecast = _fake_generate
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:544: error: "Predictor" has no attribute
"get_realtime_forecast_curve"  [attr-defined]
        actual, predicted = predictor.get_realtime_forecast_curve(
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:552: error: "None" has no attribute
"last_bars"  [attr-defined]
        assert predictor.fetcher.last_bars == 1680
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:559: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_realtime_forecast_curve_merges_partial_session_bars(monkeypat...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_forecast.py:561: error: Function is missing a type
annotation  [no-untyped-def]
            def get_history(self, _code, interval, bars, use_cache=True, u...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_forecast.py:577: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def get_realtime(self, _code) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:583: error: Function is missing a type
annotation  [no-untyped-def]
            def read_history(self, symbol, interval, bars=500, final_only=...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_forecast.py:612: error: "Predictor" has no attribute
"_clean_code"  [attr-defined]
        predictor._clean_code = lambda code: str(code).strip()
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:613: error: Incompatible types in assignment
(expression has type "_DummyFeatureEngine", variable has type "None") 
[assignment]
        predictor.feature_engine = _DummyFeatureEngine()
                                   ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:614: error: Incompatible types in assignment
(expression has type "_DummyProcessor", variable has type "None")  [assignment]
        predictor.processor = _DummyProcessor()
                              ^~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:616: error: Incompatible types in assignment
(expression has type "_Fetcher", variable has type "None")  [assignment]
        predictor.fetcher = _Fetcher()
                            ^~~~~~~~~~
tests\test_predictor_forecast.py:617: error: "Predictor" has no attribute
"_get_atr_pct"  [attr-defined]
        predictor._get_atr_pct = lambda _df: 0.02
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:618: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        predictor._generate_forecast = lambda *args, **kwargs: [100.0] * 3...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:620: error: "Predictor" has no attribute
"get_realtime_forecast_curve"  [attr-defined]
        actual, predicted = predictor.get_realtime_forecast_curve(
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:663: error: "Predictor" has no attribute
"_clean_code"  [attr-defined]
        predictor._clean_code = lambda code: str(code).strip()
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:664: error: Incompatible types in assignment
(expression has type "_DummyFeatureEngine", variable has type "None") 
[assignment]
        predictor.feature_engine = _DummyFeatureEngine()
                                   ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:665: error: Incompatible types in assignment
(expression has type "_DummyProcessor", variable has type "None")  [assignment]
        predictor.processor = _DummyProcessor()
                              ^~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:668: error: "Predictor" has no attribute
"_extract_technicals"  [attr-defined]
        predictor._extract_technicals = lambda _df, _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:669: error: "Predictor" has no attribute
"_generate_forecast"  [attr-defined]
        predictor._generate_forecast = (
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:673: error: "Predictor" has no attribute
"_calculate_levels"  [attr-defined]
        predictor._calculate_levels = lambda pred: pred.levels
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:674: error: "Predictor" has no attribute
"_calculate_position"  [attr-defined]
        predictor._calculate_position = lambda pred: pred.position
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:675: error: "Predictor" has no attribute
"_generate_reasons"  [attr-defined]
        predictor._generate_reasons = lambda _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:676: error: "Predictor" has no attribute
"_sequence_signature"  [attr-defined]
        predictor._sequence_signature = lambda _X: 0.0
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:677: error: "Predictor" has no attribute
"_set_cached_prediction"  [attr-defined]
        predictor._set_cached_prediction = lambda *_args, **_kwargs: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:678: error: Incompatible types in assignment
(expression has type "SimpleNamespace", variable has type "None")  [assignment]
        predictor.fetcher = SimpleNamespace(
                            ^~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:681: error: "Predictor" has no attribute
"_get_stock_name"  [attr-defined]
        predictor._get_stock_name = lambda _code, _df: "Demo"
        ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:685: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_fetch(code, interval, lookback, use_realtime, history_al...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_predictor_forecast.py:689: error: "Predictor" has no attribute
"_fetch_data"  [attr-defined]
        predictor._fetch_data = _fake_fetch
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:715: error: "Predictor" has no attribute
"_clean_code"  [attr-defined]
        predictor._clean_code = lambda code: str(code).strip()
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:716: error: Incompatible types in assignment
(expression has type "_DummyFeatureEngine", variable has type "None") 
[assignment]
        predictor.feature_engine = _DummyFeatureEngine()
                                   ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:717: error: Incompatible types in assignment
(expression has type "_DummyProcessor", variable has type "None")  [assignment]
        predictor.processor = _DummyProcessor()
                              ^~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:720: error: "Predictor" has no attribute
"_set_cached_prediction"  [attr-defined]
        predictor._set_cached_prediction = lambda *_args, **_kwargs: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:721: error: Incompatible types in assignment
(expression has type "SimpleNamespace", variable has type "None")  [assignment]
        predictor.fetcher = SimpleNamespace(
                            ^~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:725: error: "Predictor" has no attribute
"_get_stock_name"  [attr-defined]
        predictor._get_stock_name = lambda _code, _df: ""
        ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:726: error: "Predictor" has no attribute
"_fetch_data"  [attr-defined]
        predictor._fetch_data = (
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:749: error: "Predictor" has no attribute
"_clean_code"  [attr-defined]
        predictor._clean_code = lambda code: str(code).strip()
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:750: error: Incompatible types in assignment
(expression has type "_DummyFeatureEngine", variable has type "None") 
[assignment]
        predictor.feature_engine = _DummyFeatureEngine()
                                   ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:751: error: Incompatible types in assignment
(expression has type "_DummyProcessor", variable has type "None")  [assignment]
        predictor.processor = _DummyProcessor()
                              ^~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:754: error: "Predictor" has no attribute
"_set_cached_prediction"  [attr-defined]
        predictor._set_cached_prediction = lambda *_args, **_kwargs: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:755: error: Incompatible types in assignment
(expression has type "SimpleNamespace", variable has type "None")  [assignment]
        predictor.fetcher = SimpleNamespace(
                            ^~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:759: error: "Predictor" has no attribute
"_get_stock_name"  [attr-defined]
        predictor._get_stock_name = lambda _code, _df: "Demo"
        ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:760: error: "Predictor" has no attribute
"_calculate_levels"  [attr-defined]
        predictor._calculate_levels = lambda pred: pred.levels
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:761: error: "Predictor" has no attribute
"_calculate_position"  [attr-defined]
        predictor._calculate_position = lambda pred: pred.position
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:762: error: "Predictor" has no attribute
"_generate_reasons"  [attr-defined]
        predictor._generate_reasons = lambda _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:763: error: "Predictor" has no attribute
"_fetch_data"  [attr-defined]
        predictor._fetch_data = (
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:785: error: "Predictor" has no attribute
"_get_stock_name"  [attr-defined]
        predictor._get_stock_name = lambda _code, _df: "Demo"
        ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:786: error: "Predictor" has no attribute
"_refresh_prediction_uncertainty"  [attr-defined]
        predictor._refresh_prediction_uncertainty = lambda _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:787: error: "Predictor" has no attribute
"_apply_tail_risk_guard"  [attr-defined]
        predictor._apply_tail_risk_guard = lambda _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:788: error: "Predictor" has no attribute
"_build_prediction_bands"  [attr-defined]
        predictor._build_prediction_bands = lambda _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:789: error: "Predictor" has no attribute
"_calculate_levels"  [attr-defined]
        predictor._calculate_levels = lambda pred: pred.levels
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:790: error: "Predictor" has no attribute
"_calculate_position"  [attr-defined]
        predictor._calculate_position = lambda pred: pred.position
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:791: error: "Predictor" has no attribute
"_generate_reasons"  [attr-defined]
        predictor._generate_reasons = lambda _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:797: error: "PrecisionConfig" has no attribute
"allow_short_history_directional_signals"  [attr-defined]
            CONFIG.precision.allow_short_history_directional_signals = Fal...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:812: error: "PrecisionConfig" has no attribute
"allow_short_history_directional_signals"  [attr-defined]
            CONFIG.precision.allow_short_history_directional_signals = old...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:817: error: "Predictor" has no attribute
"_get_stock_name"  [attr-defined]
        predictor._get_stock_name = lambda _code, _df: "Demo"
        ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:818: error: "Predictor" has no attribute
"_refresh_prediction_uncertainty"  [attr-defined]
        predictor._refresh_prediction_uncertainty = lambda _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:819: error: "Predictor" has no attribute
"_apply_tail_risk_guard"  [attr-defined]
        predictor._apply_tail_risk_guard = lambda _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:820: error: "Predictor" has no attribute
"_build_prediction_bands"  [attr-defined]
        predictor._build_prediction_bands = lambda _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:821: error: "Predictor" has no attribute
"_calculate_levels"  [attr-defined]
        predictor._calculate_levels = lambda pred: pred.levels
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:822: error: "Predictor" has no attribute
"_calculate_position"  [attr-defined]
        predictor._calculate_position = lambda pred: pred.position
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:823: error: "Predictor" has no attribute
"_generate_reasons"  [attr-defined]
        predictor._generate_reasons = lambda _pred: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:829: error: "PrecisionConfig" has no attribute
"allow_short_history_directional_signals"  [attr-defined]
            CONFIG.precision.allow_short_history_directional_signals = Tru...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:850: error: "PrecisionConfig" has no attribute
"allow_short_history_directional_signals"  [attr-defined]
            CONFIG.precision.allow_short_history_directional_signals = old...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:866: error: "Predictor" has no attribute
"_apply_ensemble_result"  [attr-defined]
        predictor._apply_ensemble_result(ensemble_pred, pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:887: error: "Predictor" has no attribute
"_determine_signal"  [attr-defined]
        out = predictor._determine_signal(ensemble_pred, pred)
              ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:904: error: "Predictor" has no attribute
"_generate_reasons"  [attr-defined]
        predictor._generate_reasons(pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:930: error: "Predictor" has no attribute
"_refresh_prediction_uncertainty"  [attr-defined]
        predictor._refresh_prediction_uncertainty(pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:931: error: "Predictor" has no attribute
"_build_prediction_bands"  [attr-defined]
        predictor._build_prediction_bands(pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:964: error: "Predictor" has no attribute
"_refresh_prediction_uncertainty"  [attr-defined]
        predictor._refresh_prediction_uncertainty(pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_predictor_forecast.py:965: error: "Predictor" has no attribute
"_apply_tail_risk_guard"  [attr-defined]
        predictor._apply_tail_risk_guard(pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_precision_upgrades.py:86: error: Function is missing a return type
annotation  [no-untyped-def]
    def _make_validation_learner(post_val: dict):
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_precision_upgrades.py:93: error: Function is missing a type
annotation  [no-untyped-def]
            def validate_model(self, *_a, **_k):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_precision_upgrades.py:96: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def restore_backup(self, *_a, **_k) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_precision_upgrades.py:99: error: Incompatible types in assignment
(expression has type "_Guardian", variable has type "ModelGuardian") 
[assignment]
        learner._guardian = _Guardian()
                            ^~~~~~~~~~~
tests\test_precision_upgrades.py:100: error: Cannot assign to a method 
[method-assign]
        learner._get_holdout_set = lambda: {"000001", "000002", "000004"}
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_precision_upgrades.py:101: error: Cannot assign to a method 
[method-assign]
        learner._maybe_tune_precision_thresholds = (
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_multi_venue_broker.py:29: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def connect(self, **kwargs) -> bool:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_multi_venue_broker.py:39: error: Function is missing a return type
annotation  [no-untyped-def]
        def get_positions(self):
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_multi_venue_broker.py:63: error: Function is missing a return type
annotation  [no-untyped-def]
        def get_orders(self, active_only: bool = True):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_multi_venue_broker.py:69: error: Function is missing a return type
annotation  [no-untyped-def]
        def get_fills(self, since: datetime = None):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_multi_venue_broker.py:69: error: Argument 1 of "get_fills" is
incompatible with supertype "trading.broker.BrokerInterface"; supertype defines
the argument type as "datetime | None"  [override]
        def get_fills(self, since: datetime = None):
                            ^~~~~~~~~~~~~~~
tests\test_multi_venue_broker.py:69: note: This violates the Liskov substitution principle
tests\test_multi_venue_broker.py:69: note: See https://mypy.readthedocs.io/en/stable/common_issues.html#incompatible-overrides
tests\test_multi_venue_broker.py:69: error: Incompatible default for argument
"since" (default has type "None", argument has type "datetime")  [assignment]
        def get_fills(self, since: datetime = None):
                                              ^~~~
tests\test_multi_venue_broker.py:69: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
tests\test_multi_venue_broker.py:69: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
tests\test_multi_venue_broker.py:72: error: Function is missing a return type
annotation  [no-untyped-def]
        def get_order_status(self, order_id: str):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_multi_venue_broker.py:204: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_easytrader_get_quote_fetcher_failure_returns_none(monkeypatch...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_multi_venue_broker.py:209: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def get_quote(symbol) -> None:  # noqa: ARG004
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_multi_venue_broker.py:214: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def get_realtime(symbol) -> NoReturn:  # noqa: ARG004
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:18: error: Function is missing a return type annotation 
[no-untyped-def]
        def sample_input(self):
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:26: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_lstm_model(self, sample_input) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:42: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_transformer_model(self, sample_input) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:57: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_gru_model(self, sample_input) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:71: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_tcn_model(self, sample_input) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:89: error: Function is missing a return type annotation 
[no-untyped-def]
        def sample_data(self):
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:100: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_ensemble_creation(self, sample_data) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:113: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_ensemble_prediction(self, sample_data) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:131: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_ensemble_training(self, sample_data) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:151: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_partial_weight_update_preserves_untrained_mass(
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:172: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_full_weight_update_reflects_validation_ranking(
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:190: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_train_skips_calibration_when_stop_requested(
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:210: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
            def _fake_calibrate(*_args, **_kwargs) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:230: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_train_skips_calibration_after_midcycle_stop(
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:250: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
            def _fake_calibrate(*_args, **_kwargs) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:259: error: Function is missing a return type annotation 
[no-untyped-def]
                def __call__(self):
                ^~~~~~~~~~~~~~~~~~~
tests\test_models.py:278: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
        def test_ensemble_save_load_preserves_trained_stock_codes(
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_models.py:334: error: Statement is unreachable  [unreachable]
            assert predictor.feature_engine is not None
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_metrics_http.py:35: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_metrics_http_api_key_guard(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_metrics_http.py:83: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def test_metrics_http_extended_telemetry_endpoints(monkeypatch) -> Non...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:16: error: Argument "engine" to
"AutoTrader" has incompatible type "_DummyEngine"; expected "ExecutionEngine" 
[arg-type]
        at = AutoTrader(engine=_DummyEngine(), predictor=None, watch_list=...
                               ^~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:28: error: Argument "engine" to
"AutoTrader" has incompatible type "_DummyEngine"; expected "ExecutionEngine" 
[arg-type]
        at = AutoTrader(engine=_DummyEngine(), predictor=None, watch_list=...
                               ^~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:47: error: Argument "engine" to
"AutoTrader" has incompatible type "_DummyEngine"; expected "ExecutionEngine" 
[arg-type]
        at = AutoTrader(engine=_DummyEngine(), predictor=None, watch_list=...
                               ^~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:53: error: "PrecisionConfig" has no
attribute "block_auto_trade_on_short_history_fallback"  [attr-defined]
            CONFIG.precision.block_auto_trade_on_short_history_fallback = ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:64: error: "PrecisionConfig" has no
attribute "block_auto_trade_on_short_history_fallback"  [attr-defined]
            CONFIG.precision.block_auto_trade_on_short_history_fallback = ...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:68: error: Argument "engine" to
"AutoTrader" has incompatible type "_DummyEngine"; expected "ExecutionEngine" 
[arg-type]
        at = AutoTrader(engine=_DummyEngine(), predictor=None, watch_list=...
                               ^~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:75: error: "PrecisionConfig" has no
attribute "fail_closed_on_quality_gate_error"  [attr-defined]
            CONFIG.precision.fail_closed_on_quality_gate_error = True
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:87: error: "PrecisionConfig" has no
attribute "fail_closed_on_quality_gate_error"  [attr-defined]
            CONFIG.precision.fail_closed_on_quality_gate_error = old_fail_...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:120: error: Function is missing a type
annotation  [no-untyped-def]
            def predict_quick_batch(self, *args, **kwargs):  # noqa: ARG00...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:123: error: Function is missing a type
annotation  [no-untyped-def]
            def predict(self, *args, **kwargs):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:134: error: Argument "engine" to
"AutoTrader" has incompatible type "SimpleNamespace"; expected "ExecutionEngine"
 [arg-type]
        at = AutoTrader(engine=engine, predictor=_Predictor(), watch_list=...
                               ^~~~~~
tests\test_institutional_upgrades.py:153: error: Argument "engine" to
"AutoTrader" has incompatible type "_DummyEngine"; expected "ExecutionEngine" 
[arg-type]
            at = AutoTrader(engine=_DummyEngine(), predictor=None, watch_l...
                                   ^~~~~~~~~~~~~~
tests\test_institutional_upgrades.py:171: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_news_aggregator_stale_cache_fallback_and_source_health(monkey...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_institutional_upgrades.py:204: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_news_aggregator_institutional_snapshot_shape(monkeypatch) -> ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_institutional_upgrades.py:240: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_news_aggregator_stock_fallback_from_market_pool(monkeypatch) ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_institutional_upgrades.py:274: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_news_aggregator_stock_news_prefers_direct_over_context(monkey...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_institutional_upgrades.py:306: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_news_aggregator_stock_news_does_not_mutate_shared_market_item...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_high_precision_mode.py:24: error: "Predictor" has no attribute
"_apply_high_precision_gate"  [attr-defined]
        p._apply_high_precision_gate(pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_high_precision_mode.py:48: error: "Predictor" has no attribute
"_apply_high_precision_gate"  [attr-defined]
        p._apply_high_precision_gate(pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_high_precision_mode.py:74: error: "Predictor" has no attribute
"_apply_high_precision_gate"  [attr-defined]
        p._apply_high_precision_gate(pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_high_precision_mode.py:92: error: "Predictor" has no attribute
"_apply_runtime_signal_quality_gate"  [attr-defined]
        p._apply_runtime_signal_quality_gate(pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_high_precision_mode.py:112: error: "Predictor" has no attribute
"_apply_runtime_signal_quality_gate"  [attr-defined]
        p._apply_runtime_signal_quality_gate(pred)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_thread_lifecycle.py:19: error: Argument "engine" to
"AutoTrader" has incompatible type "_DummyEngine"; expected "ExecutionEngine" 
[arg-type]
        trader = AutoTrader(engine=_DummyEngine(), predictor=None, watch_l...
                                   ^~~~~~~~~~~~~~
tests\test_executor_thread_lifecycle.py:31: error: Incompatible types in
assignment (expression has type "Thread", variable has type "None") 
[assignment]
        eng._exec_thread = t
                           ^
tests\test_executor_thread_lifecycle.py:32: error: Incompatible types in
assignment (expression has type "Thread", variable has type "None") 
[assignment]
        eng._fill_sync_thread = t
                                ^
tests\test_executor_thread_lifecycle.py:33: error: Incompatible types in
assignment (expression has type "Thread", variable has type "None") 
[assignment]
        eng._status_sync_thread = t
                                  ^
tests\test_executor_thread_lifecycle.py:34: error: Incompatible types in
assignment (expression has type "Thread", variable has type "None") 
[assignment]
        eng._recon_thread = t
                            ^
tests\test_executor_thread_lifecycle.py:35: error: Incompatible types in
assignment (expression has type "Thread", variable has type "None") 
[assignment]
        eng._reconnect_thread = t
                                ^
tests\test_executor_thread_lifecycle.py:36: error: Incompatible types in
assignment (expression has type "Thread", variable has type "None") 
[assignment]
        eng._watchdog_thread = t
                               ^
tests\test_executor_thread_lifecycle.py:37: error: Incompatible types in
assignment (expression has type "Thread", variable has type "None") 
[assignment]
        eng._checkpoint_thread = t
                                 ^
tests\test_executor_thread_lifecycle.py:55: error: Need type annotation for
"_thread_heartbeats" (hint: "_thread_heartbeats: dict[<type>, <type>] = ...") 
[var-annotated]
                self._thread_heartbeats = {}
                ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_thread_lifecycle.py:83: error: Statement is unreachable 
[unreachable]
        assert started.wait(timeout=1.0)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:17: error: "ExecutionEngine" has no
attribute "_running"  [attr-defined]
        eng._running = True
        ^~~~~~~~~~~~
tests\test_executor_health_guard.py:18: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.SIMULATION
        ^~~~~~~~
tests\test_executor_health_guard.py:19: error: "ExecutionEngine" has no
attribute "_health_monitor"  [attr-defined]
        eng._health_monitor = SimpleNamespace(
        ^~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:22: error: "ExecutionEngine" has no
attribute "_kill_switch"; maybe "_on_kill_switch"?  [attr-defined]
        eng._kill_switch = SimpleNamespace(can_trade=True)
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:23: error: "ExecutionEngine" has no
attribute "risk_manager"  [attr-defined]
        eng.risk_manager = SimpleNamespace(check_order=lambda *a, **k: (Tr...
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:24: error: "ExecutionEngine" has no
attribute "_queue"  [attr-defined]
        eng._queue = queue.Queue()
        ^~~~~~~~~~
tests\test_executor_health_guard.py:25: error: "ExecutionEngine" has no
attribute "_alert_manager"  [attr-defined]
        eng._alert_manager = SimpleNamespace(risk_alert=lambda *a, **k: No...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:26: error: Cannot assign to a method 
[method-assign]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:26: error: Incompatible types in assignment
(expression has type
"def _reject_signal(self, sig: TradeSignal, reason: str) -> None", variable has
type "def _reject_signal(self, signal: TradeSignal, reason: str) -> None") 
[assignment]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
                             ^
tests\test_executor_health_guard.py:29: error: "ExecutionEngine" has no
attribute "submit"  [attr-defined]
        ok = eng.submit(sig)
             ^~~~~~~~~~
tests\test_executor_health_guard.py:38: error: Need type annotation for
"set_calls" (hint: "set_calls: list[<type>] = ...")  [var-annotated]
                self.set_calls = []
                ^~~~~~~~~~~~~~
tests\test_executor_health_guard.py:40: error: Function is missing a return
type annotation  [no-untyped-def]
            def get_mode(self):
            ^~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:43: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def set_mode(self, mode) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:48: error: "ExecutionEngine" has no
attribute "auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"? 
[attr-defined]
        eng.auto_trader = DummyAutoTrader()
        ^~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:49: error: "ExecutionEngine" has no
attribute "_alert_manager"  [attr-defined]
        eng._alert_manager = SimpleNamespace(risk_alert=lambda *a, **k: No...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:52: error: Argument 1 to
"_on_health_degraded" of "ExecutionEngine" has incompatible type
"SimpleNamespace"; expected "SystemHealth"  [arg-type]
        eng._on_health_degraded(health)
                                ^~~~~~
tests\test_executor_health_guard.py:54: error: "ExecutionEngine" has no
attribute "auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"? 
[attr-defined]
        assert eng.auto_trader.get_mode() == AutoTradeMode.MANUAL
               ^~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:55: error: "ExecutionEngine" has no
attribute "auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"? 
[attr-defined]
        assert eng.auto_trader.set_calls
               ^~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:62: error: "ExecutionEngine" has no
attribute "_running"  [attr-defined]
        eng._running = True
        ^~~~~~~~~~~~
tests\test_executor_health_guard.py:63: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.SIMULATION
        ^~~~~~~~
tests\test_executor_health_guard.py:64: error: "ExecutionEngine" has no
attribute "_health_monitor"  [attr-defined]
        eng._health_monitor = SimpleNamespace(
        ^~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:67: error: "ExecutionEngine" has no
attribute "_kill_switch"; maybe "_on_kill_switch"?  [attr-defined]
        eng._kill_switch = SimpleNamespace(can_trade=True)
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:68: error: "ExecutionEngine" has no
attribute "risk_manager"  [attr-defined]
        eng.risk_manager = SimpleNamespace(check_order=lambda *a, **k: (Tr...
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:69: error: "ExecutionEngine" has no
attribute "_queue"  [attr-defined]
        eng._queue = queue.Queue()
        ^~~~~~~~~~
tests\test_executor_health_guard.py:70: error: "ExecutionEngine" has no
attribute "_alert_manager"  [attr-defined]
        eng._alert_manager = SimpleNamespace(risk_alert=lambda *a, **k: No...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:71: error: Cannot assign to a method 
[method-assign]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:71: error: Incompatible types in assignment
(expression has type
"def _reject_signal(self, sig: TradeSignal, reason: str) -> None", variable has
type "def _reject_signal(self, signal: TradeSignal, reason: str) -> None") 
[assignment]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
                             ^
tests\test_executor_health_guard.py:72: error: "ExecutionEngine" has no
attribute "_recent_submit_keys"  [attr-defined]
        eng._recent_submit_keys = {}
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:73: error: "ExecutionEngine" has no
attribute "_recent_submissions"  [attr-defined]
        eng._recent_submissions = {}
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:74: error: "ExecutionEngine" has no
attribute "_recent_rejections"  [attr-defined]
        eng._recent_rejections = deque()
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:78: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_require(symbol, max_age_seconds=15.0, block_delayed=Fals...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:79: error: Incompatible types in assignment
(expression has type "bool", target has type "None")  [assignment]
            captured["block_delayed"] = bool(block_delayed)
                                        ^~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:84: error: Cannot assign to a method 
[method-assign]
        eng._require_fresh_quote = _fake_require
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:91: error: Cannot assign to a method 
[method-assign]
        CONFIG.is_market_open = lambda: True
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:92: error: Incompatible types in assignment
(expression has type "Callable[[], SimpleNamespace]", variable has type
"Callable[[], AccessControl]")  [assignment]
        exec_mod.get_access_control = lambda: SimpleNamespace(check=lambda...
                                      ^
tests\test_executor_health_guard.py:92: error: Incompatible return value type
(got "SimpleNamespace", expected "AccessControl")  [return-value]
        exec_mod.get_access_control = lambda: SimpleNamespace(check=lambda...
                                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:93: error: Incompatible types in assignment
(expression has type "Callable[[], SimpleNamespace]", variable has type
"Callable[[], AuditLog]")  [assignment]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                 ^
tests\test_executor_health_guard.py:93: error: Incompatible return value type
(got "SimpleNamespace", expected "AuditLog")  [return-value]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:102: error: "ExecutionEngine" has no
attribute "submit"  [attr-defined]
            ok = eng.submit(sig)
                 ^~~~~~~~~~
tests\test_executor_health_guard.py:105: error: Statement is unreachable 
[unreachable]
            assert "delayed" in str(getattr(sig, "_rejected_reason", ""))....
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:108: error: Cannot assign to a method 
[method-assign]
            CONFIG.is_market_open = old_is_open
            ^~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:119: error: Need type annotation for
"pause_calls" (hint: "pause_calls: list[<type>] = ...")  [var-annotated]
                self.pause_calls = []
                ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:120: error: Need type annotation for
"mode_calls" (hint: "mode_calls: list[<type>] = ...")  [var-annotated]
                self.mode_calls = []
                ^~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:122: error: Function is missing a return
type annotation  [no-untyped-def]
            def get_mode(self):
            ^~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:125: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def set_mode(self, mode) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:129: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def pause(self, reason, duration_seconds=0) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:133: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.LIVE
        ^~~~~~~~
tests\test_executor_health_guard.py:134: error: "ExecutionEngine" has no
attribute "auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"? 
[attr-defined]
        eng.auto_trader = DummyAutoTrader()
        ^~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:135: error: "ExecutionEngine" has no
attribute "_alert_manager"  [attr-defined]
        eng._alert_manager = SimpleNamespace(risk_alert=lambda *a, **k: No...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:141: error: Incompatible types in
assignment (expression has type "Callable[[], SimpleNamespace]", variable has
type "Callable[[], AuditLog]")  [assignment]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                 ^
tests\test_executor_health_guard.py:141: error: Incompatible return value type
(got "SimpleNamespace", expected "AuditLog")  [return-value]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:152: error: "ExecutionEngine" has no
attribute "auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"? 
[attr-defined]
            assert eng.auto_trader.get_mode() == AutoTradeMode.MANUAL
                   ^~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:153: error: "ExecutionEngine" has no
attribute "auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"? 
[attr-defined]
            assert eng.auto_trader.mode_calls
                   ^~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:154: error: "ExecutionEngine" has no
attribute "auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"? 
[attr-defined]
            assert eng.auto_trader.pause_calls
                   ^~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:169: error: "ExecutionEngine" has no
attribute "_running"  [attr-defined]
        eng._running = True
        ^~~~~~~~~~~~
tests\test_executor_health_guard.py:170: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.SIMULATION
        ^~~~~~~~
tests\test_executor_health_guard.py:171: error: "ExecutionEngine" has no
attribute "_health_monitor"  [attr-defined]
        eng._health_monitor = SimpleNamespace(
        ^~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:174: error: "ExecutionEngine" has no
attribute "_kill_switch"; maybe "_on_kill_switch"?  [attr-defined]
        eng._kill_switch = SimpleNamespace(can_trade=True)
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:175: error: "ExecutionEngine" has no
attribute "risk_manager"  [attr-defined]
        eng.risk_manager = SimpleNamespace(check_order=lambda *a, **k: (Tr...
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:176: error: "ExecutionEngine" has no
attribute "_queue"  [attr-defined]
        eng._queue = queue.Queue()
        ^~~~~~~~~~
tests\test_executor_health_guard.py:177: error: "ExecutionEngine" has no
attribute "_alert_manager"  [attr-defined]
        eng._alert_manager = SimpleNamespace(risk_alert=lambda *a, **k: No...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:178: error: Cannot assign to a method 
[method-assign]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:178: error: Incompatible types in
assignment (expression has type
"def _reject_signal(self, sig: TradeSignal, reason: str) -> None", variable has
type "def _reject_signal(self, signal: TradeSignal, reason: str) -> None") 
[assignment]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
                             ^
tests\test_executor_health_guard.py:179: error: Cannot assign to a method 
[method-assign]
        eng._require_fresh_quote = lambda symbol, max_age_seconds=15.0: (T...
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:179: error: Incompatible types in
assignment (expression has type "Callable[[Any, Any], tuple[bool, str, float]]",
variable has type "Callable[[str, float, bool], tuple[bool, str, float]]") 
[assignment]
        eng._require_fresh_quote = lambda symbol, max_age_seconds=15.0: (T...
                                   ^
tests\test_executor_health_guard.py:180: error: "ExecutionEngine" has no
attribute "_recent_submit_keys"  [attr-defined]
        eng._recent_submit_keys = {}
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:181: error: "ExecutionEngine" has no
attribute "_recent_submissions"  [attr-defined]
        eng._recent_submissions = {}
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:182: error: "ExecutionEngine" has no
attribute "_recent_rejections"  [attr-defined]
        eng._recent_rejections = deque()
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:188: error: Cannot assign to a method 
[method-assign]
        CONFIG.is_market_open = lambda: True
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:189: error: Incompatible types in
assignment (expression has type "Callable[[], SimpleNamespace]", variable has
type "Callable[[], AccessControl]")  [assignment]
        exec_mod.get_access_control = lambda: SimpleNamespace(check=lambda...
                                      ^
tests\test_executor_health_guard.py:189: error: Incompatible return value type
(got "SimpleNamespace", expected "AccessControl")  [return-value]
        exec_mod.get_access_control = lambda: SimpleNamespace(check=lambda...
                                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:190: error: Incompatible types in
assignment (expression has type "Callable[[], SimpleNamespace]", variable has
type "Callable[[], AuditLog]")  [assignment]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                 ^
tests\test_executor_health_guard.py:190: error: Incompatible return value type
(got "SimpleNamespace", expected "AuditLog")  [return-value]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:200: error: "ExecutionEngine" has no
attribute "submit"  [attr-defined]
            ok = eng.submit(sig)
                 ^~~~~~~~~~
tests\test_executor_health_guard.py:205: error: Cannot assign to a method 
[method-assign]
            CONFIG.is_market_open = old_is_open
            ^~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:211: error: "ExecutionEngine" has no
attribute "_running"  [attr-defined]
        eng._running = True
        ^~~~~~~~~~~~
tests\test_executor_health_guard.py:212: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.SIMULATION
        ^~~~~~~~
tests\test_executor_health_guard.py:213: error: "ExecutionEngine" has no
attribute "auto_trader"; maybe "init_auto_trader" or "stop_auto_trade"? 
[attr-defined]
        eng.auto_trader = None
        ^~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:214: error: "ExecutionEngine" has no
attribute "broker"  [attr-defined]
        eng.broker = SimpleNamespace(
        ^~~~~~~~~~
tests\test_executor_health_guard.py:220: error: "ExecutionEngine" has no
attribute "_build_execution_snapshot"  [attr-defined]
        snap = eng._build_execution_snapshot()
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:228: error: "ExecutionEngine" has no
attribute "_exec_quality_lock"  [attr-defined]
        eng._exec_quality_lock = threading.RLock()
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:229: error: "ExecutionEngine" has no
attribute "_exec_quality"  [attr-defined]
        eng._exec_quality = {
        ^~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:241: error: "ExecutionEngine" has no
attribute "_record_execution_quality"  [attr-defined]
        eng._record_execution_quality(order, fill)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:242: error: "ExecutionEngine" has no
attribute "_get_execution_quality_snapshot"  [attr-defined]
        snap = eng._get_execution_quality_snapshot()
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:252: error: "ExecutionEngine" has no
attribute "_synthetic_exit_lock"  [attr-defined]
        eng._synthetic_exit_lock = threading.RLock()
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:254: error: Cannot assign to a method 
[method-assign]
        eng._get_quote_snapshot = lambda symbol: (12.0, None, "test")
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:254: error: Incompatible types in
assignment (expression has type "Callable[[str], tuple[float, None, str]]",
variable has type "Callable[[str], tuple[float, datetime | None, str, bool]]") 
[assignment]
        eng._get_quote_snapshot = lambda symbol: (12.0, None, "test")
                                  ^
tests\test_executor_health_guard.py:254: error: Incompatible return value type
(got "tuple[float, None, str]", expected
"tuple[float, datetime | None, str, bool]")  [return-value]
        eng._get_quote_snapshot = lambda symbol: (12.0, None, "test")
                                                 ^~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:258: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _fake_submit(plan, trigger_price, reason) -> bool:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:262: error: "ExecutionEngine" has no
attribute "_submit_synthetic_exit"  [attr-defined]
        eng._submit_synthetic_exit = _fake_submit
        ^~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:274: error: "ExecutionEngine" has no
attribute "_maybe_register_synthetic_exit"; maybe "_persist_synthetic_exits" or
"_restore_synthetic_exits"?  [attr-defined]
        eng._maybe_register_synthetic_exit(order, fill)
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:277: error: "ExecutionEngine" has no
attribute "_evaluate_synthetic_exits"; maybe "_restore_synthetic_exits" or
"_persist_synthetic_exits"?  [attr-defined]
        eng._evaluate_synthetic_exits()
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:282: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_synthetic_exit_state_roundtrip(tmp_path) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:284: error: "ExecutionEngine" has no
attribute "_synthetic_exit_lock"  [attr-defined]
        eng._synthetic_exit_lock = threading.RLock()
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:299: error: "ExecutionEngine" has no
attribute "_synthetic_exit_state_path"  [attr-defined]
        eng._synthetic_exit_state_path = tmp_path / "synthetic_exits_state...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:301: error: "ExecutionEngine" has no
attribute "_synthetic_persist_min_interval_s"  [attr-defined]
        eng._synthetic_persist_min_interval_s = 0.0
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:317: error: "ExecutionEngine" has no
attribute "_running"  [attr-defined]
        eng._running = True
        ^~~~~~~~~~~~
tests\test_executor_health_guard.py:318: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.SIMULATION
        ^~~~~~~~
tests\test_executor_health_guard.py:319: error: "ExecutionEngine" has no
attribute "_health_monitor"  [attr-defined]
        eng._health_monitor = SimpleNamespace(
        ^~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:322: error: "ExecutionEngine" has no
attribute "_kill_switch"; maybe "_on_kill_switch"?  [attr-defined]
        eng._kill_switch = SimpleNamespace(can_trade=True)
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:323: error: "ExecutionEngine" has no
attribute "risk_manager"  [attr-defined]
        eng.risk_manager = SimpleNamespace(check_order=lambda *a, **k: (Tr...
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:324: error: "ExecutionEngine" has no
attribute "_queue"  [attr-defined]
        eng._queue = queue.Queue()
        ^~~~~~~~~~
tests\test_executor_health_guard.py:325: error: "ExecutionEngine" has no
attribute "_alert_manager"  [attr-defined]
        eng._alert_manager = SimpleNamespace(risk_alert=lambda *a, **k: No...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:326: error: Cannot assign to a method 
[method-assign]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:326: error: Incompatible types in
assignment (expression has type
"def _reject_signal(self, sig: TradeSignal, reason: str) -> None", variable has
type "def _reject_signal(self, signal: TradeSignal, reason: str) -> None") 
[assignment]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
                             ^
tests\test_executor_health_guard.py:327: error: Cannot assign to a method 
[method-assign]
        eng._require_fresh_quote = lambda symbol, max_age_seconds=15.0: (T...
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:327: error: Incompatible types in
assignment (expression has type "Callable[[Any, Any], tuple[bool, str, float]]",
variable has type "Callable[[str, float, bool], tuple[bool, str, float]]") 
[assignment]
        eng._require_fresh_quote = lambda symbol, max_age_seconds=15.0: (T...
                                   ^
tests\test_executor_health_guard.py:328: error: "ExecutionEngine" has no
attribute "_recent_submit_keys"  [attr-defined]
        eng._recent_submit_keys = {}
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:329: error: "ExecutionEngine" has no
attribute "_recent_submissions"  [attr-defined]
        eng._recent_submissions = {}
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:330: error: "ExecutionEngine" has no
attribute "_recent_rejections"  [attr-defined]
        eng._recent_rejections = deque()
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:335: error: Cannot assign to a method 
[method-assign]
        CONFIG.is_market_open = lambda: True
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:336: error: Incompatible types in
assignment (expression has type "Callable[[], SimpleNamespace]", variable has
type "Callable[[], AccessControl]")  [assignment]
        exec_mod.get_access_control = lambda: SimpleNamespace(check=lambda...
                                      ^
tests\test_executor_health_guard.py:336: error: Incompatible return value type
(got "SimpleNamespace", expected "AccessControl")  [return-value]
        exec_mod.get_access_control = lambda: SimpleNamespace(check=lambda...
                                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:337: error: Incompatible types in
assignment (expression has type "Callable[[], SimpleNamespace]", variable has
type "Callable[[], AuditLog]")  [assignment]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                 ^
tests\test_executor_health_guard.py:337: error: Incompatible return value type
(got "SimpleNamespace", expected "AuditLog")  [return-value]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:346: error: "ExecutionEngine" has no
attribute "submit"  [attr-defined]
            ok = eng.submit(sig)
                 ^~~~~~~~~~
tests\test_executor_health_guard.py:350: error: "ExecutionEngine" has no
attribute "_queue"  [attr-defined]
            queued = eng._queue.get_nowait()
                     ^~~~~~~~~~
tests\test_executor_health_guard.py:353: error: Cannot assign to a method 
[method-assign]
            CONFIG.is_market_open = old_is_open
            ^~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:362: error: "ExecutionEngine" has no
attribute "_running"  [attr-defined]
        eng._running = True
        ^~~~~~~~~~~~
tests\test_executor_health_guard.py:363: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.SIMULATION
        ^~~~~~~~
tests\test_executor_health_guard.py:364: error: "ExecutionEngine" has no
attribute "_health_monitor"  [attr-defined]
        eng._health_monitor = SimpleNamespace(
        ^~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:367: error: "ExecutionEngine" has no
attribute "_kill_switch"; maybe "_on_kill_switch"?  [attr-defined]
        eng._kill_switch = SimpleNamespace(can_trade=True)
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:368: error: "ExecutionEngine" has no
attribute "risk_manager"  [attr-defined]
        eng.risk_manager = SimpleNamespace(check_order=lambda *a, **k: (Tr...
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:369: error: "ExecutionEngine" has no
attribute "_queue"  [attr-defined]
        eng._queue = queue.Queue()
        ^~~~~~~~~~
tests\test_executor_health_guard.py:370: error: "ExecutionEngine" has no
attribute "_alert_manager"  [attr-defined]
        eng._alert_manager = SimpleNamespace(risk_alert=lambda *a, **k: No...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:371: error: Cannot assign to a method 
[method-assign]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:371: error: Incompatible types in
assignment (expression has type
"def _reject_signal(self, sig: TradeSignal, reason: str) -> None", variable has
type "def _reject_signal(self, signal: TradeSignal, reason: str) -> None") 
[assignment]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
                             ^
tests\test_executor_health_guard.py:372: error: Cannot assign to a method 
[method-assign]
        eng._require_fresh_quote = lambda symbol, max_age_seconds=15.0: (T...
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:372: error: Incompatible types in
assignment (expression has type "Callable[[Any, Any], tuple[bool, str, float]]",
variable has type "Callable[[str, float, bool], tuple[bool, str, float]]") 
[assignment]
        eng._require_fresh_quote = lambda symbol, max_age_seconds=15.0: (T...
                                   ^
tests\test_executor_health_guard.py:373: error: "ExecutionEngine" has no
attribute "_recent_submit_keys"  [attr-defined]
        eng._recent_submit_keys = {}
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:374: error: "ExecutionEngine" has no
attribute "_recent_submissions"  [attr-defined]
        eng._recent_submissions = {}
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:375: error: "ExecutionEngine" has no
attribute "_recent_rejections"  [attr-defined]
        eng._recent_rejections = deque()
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:380: error: Cannot assign to a method 
[method-assign]
        CONFIG.is_market_open = lambda: True
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:381: error: Incompatible types in
assignment (expression has type "Callable[[], SimpleNamespace]", variable has
type "Callable[[], AccessControl]")  [assignment]
        exec_mod.get_access_control = lambda: SimpleNamespace(check=lambda...
                                      ^
tests\test_executor_health_guard.py:381: error: Incompatible return value type
(got "SimpleNamespace", expected "AccessControl")  [return-value]
        exec_mod.get_access_control = lambda: SimpleNamespace(check=lambda...
                                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:382: error: Incompatible types in
assignment (expression has type "Callable[[], SimpleNamespace]", variable has
type "Callable[[], AuditLog]")  [assignment]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                 ^
tests\test_executor_health_guard.py:382: error: Incompatible return value type
(got "SimpleNamespace", expected "AuditLog")  [return-value]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:392: error: "ExecutionEngine" has no
attribute "submit"  [attr-defined]
            ok = eng.submit(sig)
                 ^~~~~~~~~~
tests\test_executor_health_guard.py:396: error: Cannot assign to a method 
[method-assign]
            CONFIG.is_market_open = old_is_open
            ^~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:405: error: "ExecutionEngine" has no
attribute "_running"  [attr-defined]
        eng._running = True
        ^~~~~~~~~~~~
tests\test_executor_health_guard.py:406: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.LIVE
        ^~~~~~~~
tests\test_executor_health_guard.py:407: error: "ExecutionEngine" has no
attribute "broker"  [attr-defined]
        eng.broker = SimpleNamespace()  # no advanced-order capability sur...
        ^~~~~~~~~~
tests\test_executor_health_guard.py:408: error: "ExecutionEngine" has no
attribute "_health_monitor"  [attr-defined]
        eng._health_monitor = SimpleNamespace(
        ^~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:411: error: "ExecutionEngine" has no
attribute "_kill_switch"; maybe "_on_kill_switch"?  [attr-defined]
        eng._kill_switch = SimpleNamespace(can_trade=True)
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:412: error: "ExecutionEngine" has no
attribute "risk_manager"  [attr-defined]
        eng.risk_manager = SimpleNamespace(check_order=lambda *a, **k: (Tr...
        ^~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:413: error: "ExecutionEngine" has no
attribute "_queue"  [attr-defined]
        eng._queue = queue.Queue()
        ^~~~~~~~~~
tests\test_executor_health_guard.py:414: error: "ExecutionEngine" has no
attribute "_alert_manager"  [attr-defined]
        eng._alert_manager = SimpleNamespace(risk_alert=lambda *a, **k: No...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:415: error: Cannot assign to a method 
[method-assign]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
        ^~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:415: error: Incompatible types in
assignment (expression has type
"def _reject_signal(self, sig: TradeSignal, reason: str) -> None", variable has
type "def _reject_signal(self, signal: TradeSignal, reason: str) -> None") 
[assignment]
        eng._reject_signal = lambda sig, reason: setattr(sig, "_rejected_r...
                             ^
tests\test_executor_health_guard.py:416: error: Cannot assign to a method 
[method-assign]
        eng._require_fresh_quote = (
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:419: error: "ExecutionEngine" has no
attribute "_recent_submit_keys"  [attr-defined]
        eng._recent_submit_keys = {}
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:420: error: "ExecutionEngine" has no
attribute "_recent_submissions"  [attr-defined]
        eng._recent_submissions = {}
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:421: error: "ExecutionEngine" has no
attribute "_recent_rejections"  [attr-defined]
        eng._recent_rejections = deque()
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:429: error: Cannot assign to a method 
[method-assign]
        CONFIG.is_market_open = lambda: True
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:430: error: "SecurityConfig" has no
attribute "allow_live_order_type_emulation"  [attr-defined]
        CONFIG.security.allow_live_order_type_emulation = False
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:431: error: Incompatible types in
assignment (expression has type "Callable[[], SimpleNamespace]", variable has
type "Callable[[], AccessControl]")  [assignment]
        exec_mod.get_access_control = lambda: SimpleNamespace(check=lambda...
                                      ^
tests\test_executor_health_guard.py:431: error: Incompatible return value type
(got "SimpleNamespace", expected "AccessControl")  [return-value]
        exec_mod.get_access_control = lambda: SimpleNamespace(check=lambda...
                                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:432: error: Incompatible types in
assignment (expression has type "Callable[[], SimpleNamespace]", variable has
type "Callable[[], AuditLog]")  [assignment]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                 ^
tests\test_executor_health_guard.py:432: error: Incompatible return value type
(got "SimpleNamespace", expected "AuditLog")  [return-value]
        exec_mod.get_audit_log = lambda: SimpleNamespace(log_risk_event=la...
                                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:441: error: "ExecutionEngine" has no
attribute "submit"  [attr-defined]
            ok = eng.submit(sig)
                 ^~~~~~~~~~
tests\test_executor_health_guard.py:447: error: Cannot assign to a method 
[method-assign]
            CONFIG.is_market_open = old_is_open
            ^~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:448: error: "SecurityConfig" has no
attribute "allow_live_order_type_emulation"  [attr-defined]
            CONFIG.security.allow_live_order_type_emulation = old_allow_li...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:455: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.SIMULATION
        ^~~~~~~~
tests\test_executor_health_guard.py:456: error: Cannot assign to a method 
[method-assign]
        eng._wait_or_stop = lambda _seconds: False
        ^~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:456: error: Incompatible types in
assignment (expression has type
"def _wait_or_stop(self, _seconds: float) -> bool", variable has type
"def _wait_or_stop(self, timeout_seconds: float) -> bool")  [assignment]
        eng._wait_or_stop = lambda _seconds: False
                            ^
tests\test_executor_health_guard.py:458: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _boom_submit(_order) -> NoReturn:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:461: error: "ExecutionEngine" has no
attribute "broker"  [attr-defined]
        eng.broker = SimpleNamespace(submit_order=_boom_submit)
        ^~~~~~~~~~
tests\test_executor_health_guard.py:464: error: "SecurityConfig" has no
attribute "strict_runtime_exception_policy"  [attr-defined]
        CONFIG.security.strict_runtime_exception_policy = True
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:468: error: "ExecutionEngine" has no
attribute "_submit_with_retry"  [attr-defined]
                eng._submit_with_retry(order, attempts=2)
                ^~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:470: error: "SecurityConfig" has no
attribute "strict_runtime_exception_policy"  [attr-defined]
            CONFIG.security.strict_runtime_exception_policy = old_strict
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:477: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _cancel(order_id) -> bool:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:481: error: "ExecutionEngine" has no
attribute "broker"  [attr-defined]
        eng.broker = SimpleNamespace(cancel_order=_cancel)
        ^~~~~~~~~~
tests\test_executor_health_guard.py:503: error: "ExecutionEngine" has no
attribute "_cancel_oco_siblings"  [attr-defined]
        eng._cancel_oco_siblings(oms, filled_order, fill)
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:530: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.SIMULATION
        ^~~~~~~~
tests\test_executor_health_guard.py:537: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_live_readiness_non_strict_allows_start_check(monkeypatch) -> ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:541: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.LIVE
        ^~~~~~~~
tests\test_executor_health_guard.py:565: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_start_blocks_when_live_readiness_fails_strict(monkeypatch) ->...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_executor_health_guard.py:569: error: "ExecutionEngine" has no
attribute "_running"  [attr-defined]
        eng._running = False
        ^~~~~~~~~~~~
tests\test_executor_health_guard.py:570: error: "ExecutionEngine" has no
attribute "mode"  [attr-defined]
        eng.mode = TradingMode.LIVE
        ^~~~~~~~
tests\test_executor_health_guard.py:572: error: "ExecutionEngine" has no
attribute "_health_monitor"  [attr-defined]
        eng._health_monitor = SimpleNamespace(
        ^~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:577: error: Cannot assign to a method 
[method-assign]
        eng._acquire_runtime_lease = lambda: (_ for _ in ()).throw(
        ^~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_executor_health_guard.py:592: error: "ExecutionEngine" has no
attribute "start"  [attr-defined]
            ok = eng.start()
                 ^~~~~~~~~
tests\test_data_leakage.py:20: error: Function is missing a return type
annotation  [no-untyped-def]
        def sample_df(self):
        ^~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:46: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def test_scaler_fitted_only_on_training(self, sample_df) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:65: error: Item "None" of "Any | None" has no
attribute "center_"  [union-attr]
            train_center = processor.scaler.center_.copy()
                           ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:66: error: Item "None" of "Any | None" has no
attribute "scale_"  [union-attr]
            train_scale = processor.scaler.scale_.copy()
                          ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:73: error: Item "None" of "Any | None" has no
attribute "center_"  [union-attr]
            np.testing.assert_array_equal(processor.scaler.center_, train_...
                                          ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:74: error: Item "None" of "Any | None" has no
attribute "scale_"  [union-attr]
            np.testing.assert_array_equal(processor.scaler.scale_, train_s...
                                          ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:76: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def test_split_temporal_applies_embargo(self, sample_df) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:96: error: Function is missing a return type
annotation  [no-untyped-def]
        def deterministic_df(self):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:114: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
        def test_labels_use_only_future_data(self, deterministic_df) -> No...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:130: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
        def test_last_horizon_rows_have_nan_labels(self, deterministic_df)...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_data_leakage.py:147: error: Function is missing a return type
annotation  [no-untyped-def]
        def sample_data(self):
        ^~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:165: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
        def test_train_inference_sequence_match(self, sample_data) -> None...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:200: error: Function is missing a return type
annotation  [no-untyped-def]
        def ordered_df(self):
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:217: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
        def test_no_shuffle_in_split(self, ordered_df) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_data_leakage.py:248: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
        def test_weights_preserved_after_save_load(self, tmp_path) -> None...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:28: error: Function is missing a
type annotation  [no-untyped-def]
            def discover_new(
            ^~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:33: error: Function is missing a
type annotation for one or more arguments  [no-untyped-def]
            def mark_failed(self, code) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:36: error: Function is missing a
type annotation for one or more arguments  [no-untyped-def]
            def mark_processed(self, codes) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:43: error: Function is missing a
type annotation  [no-untyped-def]
            def sample(self, n):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:47: error: Function is missing a
type annotation  [no-untyped-def]
            def fetch_batch(
            ^~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:52: error: Incompatible types in
assignment (expression has type "_Rotator", variable has type "StockRotator") 
[assignment]
        learner._rotator = _Rotator()
                           ^~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:53: error: Incompatible types in
assignment (expression has type "_Replay", variable has type
"ExperienceReplayBuffer")  [assignment]
        learner._replay = _Replay()
                          ^~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:54: error: Incompatible types in
assignment (expression has type "_Fetcher", variable has type "ParallelFetcher")
 [assignment]
        learner._fetcher = _Fetcher()
                           ^~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:55: error: Incompatible types in
assignment (expression has type "SimpleNamespace", variable has type
"ModelGuardian")  [assignment]
        learner._guardian = SimpleNamespace(backup_current=lambda *_a, **_...
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:56: error: Incompatible types in
assignment (expression has type "SimpleNamespace", variable has type
"LRScheduler")  [assignment]
        learner._lr_scheduler = SimpleNamespace(
                                ^~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:59: error: Incompatible types in
assignment (expression has type "SimpleNamespace", variable has type
"MetricTracker")  [assignment]
        learner._metrics = SimpleNamespace(
                           ^~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:65: error: Cannot assign to a
method  [method-assign]
        learner._ensure_holdout = lambda *_a, **_k: None
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:66: error: Cannot assign to a
method  [method-assign]
        learner._get_holdout_set = lambda: set()
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:67: error: Cannot assign to a
method  [method-assign]
        learner._should_stop = lambda: False
        ^~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:68: error: Cannot assign to a
method  [method-assign]
        learner._update = lambda **_kw: None
        ^~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:69: error: Cannot assign to a
method  [method-assign]
        learner._prioritize_codes_by_news = (
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:72: error: Cannot assign to a
method  [method-assign]
        learner._train = lambda *_a, **_k: {
        ^~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:76: error: Cannot assign to a
method  [method-assign]
        learner._validate_and_decide = lambda *_a, **_k: True
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:77: error: Cannot assign to a
method  [method-assign]
        learner._finalize_cycle = (
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:81: error: "ContinuousLearner"
has no attribute "_run_cycle"  [attr-defined]
        ok = learner._run_cycle(
             ^~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:106: error: Function is missing
a type annotation  [no-untyped-def]
            def discover_new(
            ^~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:111: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def mark_failed(self, code) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:114: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def mark_processed(self, codes) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:121: error: Function is missing
a type annotation  [no-untyped-def]
            def sample(self, n):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:125: error: Function is missing
a type annotation  [no-untyped-def]
            def fetch_batch(
            ^~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:132: error: Incompatible types
in assignment (expression has type "_Rotator", variable has type "StockRotator")
 [assignment]
        learner._rotator = _Rotator()
                           ^~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:133: error: Incompatible types
in assignment (expression has type "_Replay", variable has type
"ExperienceReplayBuffer")  [assignment]
        learner._replay = _Replay()
                          ^~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:134: error: Incompatible types
in assignment (expression has type "_Fetcher", variable has type
"ParallelFetcher")  [assignment]
        learner._fetcher = _Fetcher()
                           ^~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:135: error: Incompatible types
in assignment (expression has type "SimpleNamespace", variable has type
"ModelGuardian")  [assignment]
        learner._guardian = SimpleNamespace(
                            ^~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:141: error: Incompatible types
in assignment (expression has type "SimpleNamespace", variable has type
"LRScheduler")  [assignment]
        learner._lr_scheduler = SimpleNamespace(
                                ^~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:144: error: Incompatible types
in assignment (expression has type "SimpleNamespace", variable has type
"MetricTracker")  [assignment]
        learner._metrics = SimpleNamespace(
                           ^~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:151: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
        def _should_not_validate(*_a, **_k) -> NoReturn:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:154: error: Cannot assign to a
method  [method-assign]
        learner._ensure_holdout = lambda *_a, **_k: None
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:155: error: Cannot assign to a
method  [method-assign]
        learner._get_holdout_set = lambda: set()
        ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:156: error: Cannot assign to a
method  [method-assign]
        learner._should_stop = lambda: False
        ^~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:157: error: Cannot assign to a
method  [method-assign]
        learner._update = lambda **_kw: None
        ^~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:158: error: Cannot assign to a
method  [method-assign]
        learner._prioritize_codes_by_news = (
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:161: error: Cannot assign to a
method  [method-assign]
        learner._train = lambda *_a, **_k: {
        ^~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:174: error: Cannot assign to a
method  [method-assign]
        learner._validate_and_decide = _should_not_validate
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:175: error: Cannot assign to a
method  [method-assign]
        learner._finalize_cycle = lambda accepted, *_a, **_k: finalized.__...
        ^~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:176: error: Incompatible types
in assignment (expression has type "bool", target has type "None")  [assignment]
            "accepted", bool(accepted)
                        ^~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:179: error: "ContinuousLearner"
has no attribute "_run_cycle"  [attr-defined]
        ok = learner._run_cycle(
             ^~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:192: error: Statement is
unreachable  [unreachable]
        assert restore_calls["count"] == 1
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:196: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
    def test_trainer_metadata_uses_split_survivors(monkeypatch) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:258: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def __init__(self, input_size, model_names=None) -> None:  # n...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:263: error: Need type annotation
for "trained_stock_codes" (hint: "trained_stock_codes: list[<type>] = ...") 
[var-annotated]
                self.trained_stock_codes = []
                ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:265: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def load(self, path) -> bool:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:268: error: Function is missing
a type annotation  [no-untyped-def]
            def train(
            ^~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:282: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def save(self, path) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:303: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
    def test_split_and_fit_scaler_refits_on_feature_mismatch(monkeypatch) ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:313: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def fit_scaler(self, features, interval=None, horizon=None) ->...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:316: error: Incompatible types
in assignment (expression has type "_Processor", variable has type
"DataProcessor")  [assignment]
        trainer.processor = _Processor()
                            ^~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:365: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
    def test_trainer_prepare_data_forces_1m_and_minimum_lookback(monkeypat...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:372: error: Function is missing
a type annotation  [no-untyped-def]
        def _fake_fetch(stocks, interval, bars, **kwargs):  # noqa: ARG001
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:427: error: "Trainer" has no
attribute "prepare_data"  [attr-defined]
        trainer.prepare_data(
        ^~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:447: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
    def test_trainer_incremental_adds_missing_default_models(monkeypatch, ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:516: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def __init__(self, input_size, model_names=None) -> None:  # n...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:522: error: Need type annotation
for "trained_stock_codes" (hint: "trained_stock_codes: list[<type>] = ...") 
[var-annotated]
                self.trained_stock_codes = []
                ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:526: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def load(self, path) -> bool:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:529: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def _init_model(self, name) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:537: error: Function is missing
a type annotation  [no-untyped-def]
            def train(
            ^~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:551: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def save(self, path) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:575: error: "EnsembleModel" has
no attribute "normalized"  [attr-defined]
        assert trainer.ensemble.normalized is True
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:578: error: Function is missing
a return type annotation  [no-untyped-def]
    def _setup_minimal_trainer_for_artifact_gate(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:578: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
    def _setup_minimal_trainer_for_artifact_gate(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:710: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def __init__(self, input_size, model_names=None) -> None:  # n...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:715: error: Need type annotation
for "trained_stock_codes" (hint: "trained_stock_codes: list[<type>] = ...") 
[var-annotated]
                self.trained_stock_codes = []
                ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:717: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def load(self, path) -> bool:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:720: error: Function is missing
a type annotation  [no-untyped-def]
            def train(
            ^~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:734: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def save(self, path) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:742: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
    def test_trainer_keeps_live_artifacts_when_quality_gate_fails(monkeypa...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:775: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
    def test_trainer_promotes_live_artifacts_when_quality_gate_passes(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:811: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
    def test_drift_guard_skips_weak_initial_baseline(monkeypatch, tmp_path...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:825: error: "Trainer" has no
attribute "_run_drift_guard"  [attr-defined]
        weak_out = trainer._run_drift_guard(
                   ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:848: error: "Trainer" has no
attribute "_run_drift_guard"  [attr-defined]
        strong_out = trainer._run_drift_guard(
                     ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:887: error: Function is missing
a type annotation for one or more arguments  [no-untyped-def]
            def add(self, codes, confidence=0.5) -> None:  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:893: error: Incompatible types
in assignment (expression has type "_Replay", variable has type
"ExperienceReplayBuffer")  [assignment]
        learner._replay = _Replay()
                          ^~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:894: error: Incompatible types
in assignment (expression has type "SimpleNamespace", variable has type
"StockRotator")  [assignment]
        learner._rotator = SimpleNamespace(mark_processed=lambda *_a, **_k...
                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:895: error: Incompatible types
in assignment (expression has type "SimpleNamespace", variable has type
"ModelGuardian")  [assignment]
        learner._guardian = SimpleNamespace(save_as_best=lambda *_a, **_k:...
                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_trainer_regressions.py:896: error: Cannot assign to a
method  [method-assign]
        learner._cache_training_sequences = lambda *_a, **_k: None
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:897: error: Cannot assign to a
method  [method-assign]
        learner._update = lambda **_k: None
        ^~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:898: error: Cannot assign to a
method  [method-assign]
        learner._log_cycle = lambda *_a, **_k: None
        ^~~~~~~~~~~~~~~~~~
tests\test_auto_learner_trainer_regressions.py:931: error: Statement is
unreachable  [unreachable]
        assert learner.progress.consecutive_rejections == 0
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_session_priority.py:9: error: Function is missing a
type annotation for one or more arguments  [no-untyped-def]
    def test_session_continuous_window_seconds_counts_contiguous_1m_bars(m...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_session_priority.py:24: error: Function is missing a
type annotation  [no-untyped-def]
            def read_history(self, symbol, interval, bars=5000, final_only...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_session_priority.py:71: error: Function is missing a
type annotation for one or more arguments  [no-untyped-def]
    def test_prioritize_codes_by_news_promotes_symbols_with_recent_mention...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_session_priority.py:75: error: Function is missing a
type annotation  [no-untyped-def]
            def get_market_news(self, count=80, force_refresh=False):  # n...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_session_priority.py:91: error: Function is missing a
type annotation  [no-untyped-def]
            def get_sentiment_summary(self, stock_code):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_session_priority.py:115: error: Function is missing a
type annotation for one or more arguments  [no-untyped-def]
    def test_prioritize_codes_by_news_keeps_order_when_no_news(monkeypatch...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_session_priority.py:117: error: Function is missing a
type annotation  [no-untyped-def]
            def get_market_news(self, count=80, force_refresh=False):  # n...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_session_priority.py:120: error: Function is missing a
type annotation  [no-untyped-def]
            def get_sentiment_summary(self, stock_code):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_drift_alarm.py:8: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_emit_model_drift_alarm_calls_execution_trigger(monkeypatch) -...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_drift_alarm.py:11: error: Incompatible types in
assignment (expression has type "SimpleNamespace", variable has type
"LearningProgress")  [assignment]
        learner.progress = SimpleNamespace(add_warning=lambda msg: warning...
                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_drift_alarm.py:19: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _fake_trigger(cls, reason, *, severity="critical", metadata=No...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_drift_alarm.py:20: error: Unsupported operand types for
+ ("object" and "int")  [operator]
            calls["count"] += 1
            ^
tests\test_auto_learner_drift_alarm.py:56: error: Unsupported right operand
type for in ("object")  [operator]
        assert "unit_cycle" in calls["reason"]
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_auto_learner_discovery_pool.py:8: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_rotator_keeps_full_universe_and_persists_without_truncation(m...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_auto_learner_discovery_pool.py:44: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_rotator_injects_new_listing_between_full_refresh_windows(monk...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_artifact_loading_security.py:33: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_ensemble_load_blocks_unsafe_legacy_fallback(monkeypatch, tmp_...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_artifact_loading_security.py:42: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_torch_load(
        ^~~~~~~~~~~~~~~~~~~~~
tests\test_artifact_loading_security.py:73: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_ensemble_load_allows_unsafe_legacy_fallback_when_opted_in(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_artifact_loading_security.py:84: error: Function is missing a type
annotation  [no-untyped-def]
        def _fake_torch_load(
        ^~~~~~~~~~~~~~~~~~~~~
data\processor_realtime_predictor.py:59: error: Statement is unreachable 
[unreachable]
                    return True
                    ^~~~~~~~~~~
data\processor_realtime_predictor.py:165: error: Function is missing a return
type annotation  [no-untyped-def]
                def _load_checkpoint(weights_only: bool):
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
data\processor_realtime_predictor.py:276: error: Item "None" of "Any | None"
has no attribute "create_features"  [union-attr]
                df_features = self.feature_engine.create_features(df.copy(...
                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\backtest.py:239: error: Incompatible default for argument
"stock_codes" (default has type "None", argument has type "list[str]") 
[assignment]
            stock_codes: list[str] = None,
                                     ^~~~
analysis\backtest.py:239: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
analysis\backtest.py:239: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
analysis\backtest.py:243: error: Incompatible default for argument
"initial_capital" (default has type "None", argument has type "float") 
[assignment]
            initial_capital: float = None
                                     ^~~~
analysis\backtest.py:243: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
analysis\backtest.py:243: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
analysis\backtest.py:351: error: Incompatible types in assignment (expression
has type "BacktestResult", variable has type "tuple[Any, ...] | None") 
[assignment]
            result = self._calculate_metrics(
                     ^~~~~~~~~~~~~~~~~~~~~~~~
analysis\backtest.py:362: error: Incompatible return value type (got
"tuple[Any, ...] | None", expected "BacktestResult")  [return-value]
            return result
                   ^~~~~~
analysis\backtest.py:515: error: "ModelConfig" has no attribute
"backtest_trade_horizon"  [attr-defined]
                    CONFIG.model.backtest_trade_horizon = int(trade_h)
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\backtest.py:516: error: "RiskConfig" has no attribute
"backtest_max_volume_participation"  [attr-defined]
                    CONFIG.risk.backtest_max_volume_participation = float(...
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\backtest.py:521: error: Argument "stock_codes" to "run" of
"Backtester" has incompatible type "list[str] | None"; expected "list[str]" 
[arg-type]
                            stock_codes=stock_codes,
                                        ^~~~~~~~~~~
analysis\backtest.py:525: error: Argument "initial_capital" to "run" of
"Backtester" has incompatible type "float | None"; expected "float"  [arg-type]
                            initial_capital=initial_capital,
                                            ^~~~~~~~~~~~~~~
analysis\backtest.py:568: error: "ModelConfig" has no attribute
"backtest_trade_horizon"  [attr-defined]
                    CONFIG.model.backtest_trade_horizon = old_trade_horizo...
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\backtest.py:575: error: "RiskConfig" has no attribute
"backtest_max_volume_participation"  [attr-defined]
                    CONFIG.risk.backtest_max_volume_participation = old_pa...
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\backtest.py:670: error: Returning Any from function declared to return
"list[str]"  [no-any-return]
                return CONFIG.STOCK_POOL[:5]
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
analysis\backtest.py:1313: error: Incompatible types in assignment (expression
has type "ndarray[tuple[int, ...], dtype[Any]]", variable has type
"list[float]")  [assignment]
            equity = np.array(equity[1:])
                     ^~~~~~~~~~~~~~~~~~~~
analysis\backtest.py:1359: error: Incompatible types in assignment (expression
has type "int", variable has type "float64")  [assignment]
                max_dd = max_dd_pct = 0
                ^
analysis\backtest.py:1389: error: Incompatible types in assignment (expression
has type "int", variable has type "floating[Any]")  [assignment]
                win_rate = profit_factor = avg_win = avg_holding = 0
                                                                   ^
analysis\backtest.py:1410: error: Argument "avg_win" to "BacktestResult" has
incompatible type "floating[Any] | int"; expected "float"  [arg-type]
                avg_win=avg_win,
                        ^~~~~~~
analysis\backtest.py:1411: error: Argument "avg_loss" to "BacktestResult" has
incompatible type "floating[Any] | int"; expected "float"  [arg-type]
                avg_loss=avg_loss,
                         ^~~~~~~~
analysis\backtest.py:1412: error: Argument "avg_holding_days" to
"BacktestResult" has incompatible type "floating[Any]"; expected "float" 
[arg-type]
                avg_holding_days=avg_holding,
                                 ^~~~~~~~~~~
analysis\backtest.py:1414: error: Argument "avg_fold_accuracy" to
"BacktestResult" has incompatible type "floating[Any] | int"; expected "float" 
[arg-type]
                avg_fold_accuracy=np.mean(fold_accuracies) if fold_accurac...
                                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
analysis\backtest.py:1416: error: "list[float]" has no attribute "tolist" 
[attr-defined]
                equity_curve=equity.tolist(),
                             ^~~~~~~~~~~~~
ui\auto_learn_dialog.py:46: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def __init__(self, parent=None, seed_stock_codes: list[str] | None...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
ui\auto_learn_dialog.py:810: error: Unsupported operand types for < ("int" and
"object")  [operator]
                if env.is_vpn_active and config["max_stocks"] > 3000:
                                         ^
ui\auto_learn_dialog.py:1387: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
        def closeEvent(self, event) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\auto_learn_dialog.py:1421: error: Function is missing a return type
annotation  [no-untyped-def]
    def show_auto_learn_dialog(parent=None, seed_stock_codes: list[str] | ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
ui\auto_learn_dialog.py:1421: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def show_auto_learn_dialog(parent=None, seed_stock_codes: list[str] | ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
ui\dialogs.py:44: error: Function is missing a return type annotation 
[no-untyped-def]
    def _get_cancellation_token():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:49: error: Function is missing a return type annotation 
[no-untyped-def]
    def _get_cancelled_exception():
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:167: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def __init__(self, parent=None) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:216: error: Item "None" of "QListWidgetItem | None" has no
attribute "setSelected"  [union-attr]
                self.stocks_list.item(i).setSelected(True)
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:288: error: Item "None" of "QPushButton | None" has no attribute
"clicked"  [union-attr]
            self.start_btn.clicked.connect(self.start_training)
            ^~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:289: error: Item "None" of "QPushButton | None" has no attribute
"clicked"  [union-attr]
            self.stop_btn.clicked.connect(self.stop_training)
            ^~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:290: error: Item "None" of "QPushButton | None" has no attribute
"clicked"  [union-attr]
            self.close_btn.clicked.connect(self.close)
            ^~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:292: error: Item "None" of "QPushButton | None" has no attribute
"setEnabled"  [union-attr]
            self.stop_btn.setEnabled(False)
            ^~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:323: error: Item "None" of "QListWidgetItem | None" has no
attribute "text"  [union-attr]
                if self.stocks_list.item(i).text().strip() == code:
                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:365: error: Item "None" of "QPushButton | None" has no attribute
"setEnabled"  [union-attr]
            self.start_btn.setEnabled(False)
            ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:366: error: Item "None" of "QPushButton | None" has no attribute
"setEnabled"  [union-attr]
            self.stop_btn.setEnabled(True)
            ^~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:367: error: Item "None" of "QPushButton | None" has no attribute
"setEnabled"  [union-attr]
            self.close_btn.setEnabled(False)
            ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:384: error: Item "None" of "QPushButton | None" has no attribute
"setEnabled"  [union-attr]
                self.stop_btn.setEnabled(False)
                ^~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:490: error: Item "None" of "QPushButton | None" has no attribute
"setEnabled"  [union-attr]
            self.start_btn.setEnabled(True)
            ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:491: error: Item "None" of "QPushButton | None" has no attribute
"setEnabled"  [union-attr]
            self.stop_btn.setEnabled(False)
            ^~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:492: error: Item "None" of "QPushButton | None" has no attribute
"setEnabled"  [union-attr]
            self.close_btn.setEnabled(True)
            ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:502: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def closeEvent(self, event) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:528: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def __init__(
        ^~~~~~~~~~~~~
ui\dialogs.py:640: error: Function is missing a return type annotation 
[no-untyped-def]
            def _sort_key(code: str):
            ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:796: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def closeEvent(self, event) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:819: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def __init__(self, parent=None) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:904: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def _on_done(self, result) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:927: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def closeEvent(self, event) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:939: error: Function is missing a type annotation for one or more
arguments  [no-untyped-def]
        def __init__(self, parent=None) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:1014: error: Function is missing a type annotation for one or
more arguments  [no-untyped-def]
        def __init__(self, parent=None) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:1088: error: "Config" has no attribute "MAX_POSITION_PCT" 
[attr-defined]
                CONFIG.MAX_POSITION_PCT = float(self.max_pos_pct.value())
                ^~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:1093: error: "Config" has no attribute "MAX_DAILY_LOSS_PCT" 
[attr-defined]
                CONFIG.MAX_DAILY_LOSS_PCT = float(self.max_daily_loss.valu...
                ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:1098: error: "Config" has no attribute "RISK_PER_TRADE" 
[attr-defined]
                CONFIG.RISK_PER_TRADE = float(self.risk_per_trade.value())
                ^~~~~~~~~~~~~~~~~~~~~
ui\dialogs.py:1103: error: "Config" has no attribute "MAX_POSITIONS" 
[attr-defined]
                CONFIG.MAX_POSITIONS = int(self.max_positions.value())
                ^~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:75: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_backtest_optimize_returns_best_and_restores_confidence(monkey...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_backtest_optimize.py:80: error: Function is missing a type
annotation  [no-untyped-def]
        def fake_run(
        ^~~~~~~~~~~~~
tests\test_backtest_optimize.py:120: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_backtest_optimize_extended_parameters_and_restore(monkeypatch...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_backtest_optimize.py:131: error: Function is missing a type
annotation  [no-untyped-def]
        def fake_run(
        ^~~~~~~~~~~~~
tests\test_backtest_optimize.py:192: error: "ModelConfig" has no attribute
"backtest_trade_horizon"  [attr-defined]
            assert int(CONFIG.model.backtest_trade_horizon) == old_h
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:196: error: "RiskConfig" has no attribute
"backtest_max_volume_participation"  [attr-defined]
            assert abs(float(CONFIG.risk.backtest_max_volume_participation...
                             ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:213: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_backtest_fold_uses_configurable_backtest_epochs(monkeypatch) ...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_backtest_optimize.py:217: error: Function is missing a return type
annotation  [no-untyped-def]
            def get_feature_columns(self):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:220: error: Function is missing a type
annotation  [no-untyped-def]
            def create_features(self, df):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:224: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def fit_scaler(self, _arr) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:227: error: Function is missing a type
annotation  [no-untyped-def]
            def create_labels(self, df, horizon=None):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:233: error: Function is missing a type
annotation  [no-untyped-def]
            def prepare_sequences(self, df, feature_cols, fit_scaler=False...
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_backtest_optimize.py:245: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def __init__(self, input_size, model_names=None) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:248: error: Function is missing a type
annotation  [no-untyped-def]
            def train(self, X_train, y_train, X_val, y_val, epochs=None):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:249: error: Incompatible types in assignment
(expression has type "int", target has type "None")  [assignment]
                train_calls["epochs"] = int(epochs)
                                        ^~~~~~~~~~~
tests\test_backtest_optimize.py:252: error: Function is missing a type
annotation  [no-untyped-def]
            def predict_batch(self, X):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:258: error: Incompatible types in assignment
(expression has type "_DummyFeatureEngine", variable has type "FeatureEngine") 
[assignment]
        bt.feature_engine = _DummyFeatureEngine()
                            ^~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:278: error: "ModelConfig" has no attribute
"backtest_epochs"  [attr-defined]
            CONFIG.model.backtest_epochs = 3
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:296: error: "ModelConfig" has no attribute
"backtest_epochs"  [attr-defined]
                CONFIG.model.backtest_epochs = old_backtest_epochs
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:299: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_backtest_run_fails_fast_when_train_window_cannot_build_sequen...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_backtest_optimize.py:339: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _run_fold_unexpected(*args, **kwargs) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:358: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_backtest_fold_skips_when_train_sequences_too_small(monkeypatc...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_backtest_optimize.py:362: error: Function is missing a return type
annotation  [no-untyped-def]
            def get_feature_columns(self):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:365: error: Function is missing a type
annotation  [no-untyped-def]
            def create_features(self, df):
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:369: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
            def fit_scaler(self, _arr) -> None:
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:372: error: Function is missing a type
annotation  [no-untyped-def]
            def create_labels(self, df, horizon=None):  # noqa: ARG002
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:378: error: Function is missing a type
annotation  [no-untyped-def]
            def prepare_sequences(
            ^~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:394: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _unexpected_model(*args, **kwargs) -> NoReturn:  # noqa: ARG00...
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_optimize.py:397: error: Incompatible types in assignment
(expression has type "_DummyFeatureEngine", variable has type "FeatureEngine") 
[assignment]
        bt.feature_engine = _DummyFeatureEngine()
                            ^~~~~~~~~~~~~~~~~~~~~
tests\test_backtest_metrics.py:8: error: Function is missing a return type
annotation  [no-untyped-def]
    def _build_dates(n: int):
    ^~~~~~~~~~~~~~~~~~~~~~~~~
analysis\__init__.py:6: error: Incompatible types in assignment (expression has
type "None", variable has type "type[TechnicalAnalyzer]")  [assignment]
        TechnicalAnalyzer = None
                            ^~~~
analysis\__init__.py:11: error: Incompatible types in assignment (expression
has type "None", variable has type "type[SentimentAnalyzer]")  [assignment]
        SentimentAnalyzer = None
                            ^~~~
analysis\__init__.py:12: error: Incompatible types in assignment (expression
has type "None", variable has type "type[NewsScraper]")  [assignment]
        NewsScraper = None
                      ^~~~
analysis\__init__.py:17: error: Incompatible types in assignment (expression
has type "None", variable has type "type[Backtester]")  [assignment]
        Backtester = None
                     ^~~~
analysis\__init__.py:18: error: Incompatible types in assignment (expression
has type "None", variable has type "type[BacktestResult]")  [assignment]
        BacktestResult = None
                         ^~~~
analysis\__init__.py:23: error: Incompatible types in assignment (expression
has type "None", variable has type "type[MarketReplay]")  [assignment]
        MarketReplay = None
                       ^~~~
analysis\__init__.py:24: error: Incompatible types in assignment (expression
has type "None", variable has type "type[ReplayBar]")  [assignment]
        ReplayBar = None
                    ^~~~
analysis\__init__.py:29: error: Incompatible types in assignment (expression
has type "None", variable has type "type[StrategyScriptEngine]")  [assignment]
        StrategyScriptEngine = None
                               ^~~~
analysis\__init__.py:30: error: Incompatible types in assignment (expression
has type "None", variable has type "type[StrategySignal]")  [assignment]
        StrategySignal = None
                         ^~~~
analysis\__init__.py:35: error: Incompatible types in assignment (expression
has type "None", variable has type "type[StrategyMarketplace]")  [assignment]
        StrategyMarketplace = None
                              ^~~~
ui\app_training_ops.py:27: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
    def _get_trained_stock_codes(self) -> list[str]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:39: error: Returning Any from function declared to
return "list[str]"  [no-any-return]
                return cache_val
                ^~~~~~~~~~~~~~~~
ui\app_training_ops.py:60: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
    def _invalidate_trained_stock_cache(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:68: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
    def _sync_trained_stock_last_train_from_model(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:95: error: Function is missing a type annotation for one
or more arguments  [no-untyped-def]
    def _get_trained_stock_set(self) -> set[str]:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:109: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _is_trained_stock(self, symbol: str) -> bool:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:116: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _persist_session_bar(
    ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:160: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _submit_session_cache_write(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:201: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _on_session_cache_write_done(self, future: Future[object]) -> None...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:212: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _shutdown_session_cache_writer(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:236: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _filter_trained_stocks_ui(self, text: str) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:243: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _pin_watchlist_symbol(self, code: str) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:279: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _on_trained_stock_activated(self, item: QListWidgetItem) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:282: error: Statement is unreachable  [unreachable]
            return
            ^~~~~~
ui\app_training_ops.py:319: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _refresh_trained_stock_list(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:371: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _update_trained_stocks_ui(self, codes: list[str] | None = None) ->...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
ui\app_training_ops.py:396: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _focus_trained_stocks_tab(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:403: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _get_infor_trained_stocks(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:467: error: No overload variant of "dict" matches
argument type "object"  [call-overload]
            report = dict(res or {})
                     ^~~~~~~~~~~~~~~
ui\app_training_ops.py:467: note: Possible overload variants:
ui\app_training_ops.py:467: note:     def [_KT, _VT] __init__(self) -> dict[_KT, _VT]
ui\app_training_ops.py:467: note:     def [_KT, _VT] __init__(self, **kwargs: _VT) -> dict[str, _VT]
ui\app_training_ops.py:467: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[_KT, _VT], /) -> dict[_KT, _VT]
ui\app_training_ops.py:467: note:     def [_KT, _VT] __init__(self, SupportsKeysAndGetItem[str, _VT], /, **kwargs: _VT) -> dict[str, _VT]
ui\app_training_ops.py:467: note:     def [_KT, _VT] __init__(self, Iterable[tuple[_KT, _VT]], /) -> dict[_KT, _VT]
ui\app_training_ops.py:467: note:     def [_KT, _VT] __init__(self, Iterable[tuple[str, _VT]], /, **kwargs: _VT) -> dict[str, _VT]
ui\app_training_ops.py:467: note:     def [_KT, _VT] __init__(self, Iterable[list[str]], /) -> dict[str, str]
ui\app_training_ops.py:467: note:     def [_KT, _VT] __init__(self, Iterable[list[bytes]], /) -> dict[bytes, bytes]
ui\app_training_ops.py:516: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _train_trained_stocks(self) -> None:
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app_training_ops.py:632: error: Function is missing a type annotation for
one or more arguments  [no-untyped-def]
    def _handle_training_drift_alarm(
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:318: error: "MainApp" has no attribute "_on_bar_ui"  [attr-defined]
            self.bar_received.connect(self._on_bar_ui)
                                      ^~~~~~~~~~~~~~~
ui\app.py:323: error: "MainApp" has no attribute "_update_watchlist" 
[attr-defined]
                self._update_watchlist()
                ^~~~~~~~~~~~~~~~~~~~~~
ui\app.py:348: error: Item "None" of "QMenuBar | None" has no attribute
"addMenu"  [union-attr]
            file_menu = menubar.addMenu("&File")
                        ^~~~~~~~~~~~~~~
ui\app.py:352: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            file_menu.addAction(new_action)
            ^~~~~~~~~~~~~~~~~~~
ui\app.py:354: error: Item "None" of "QMenu | Any | None" has no attribute
"addSeparator"  [union-attr]
            file_menu.addSeparator()
            ^~~~~~~~~~~~~~~~~~~~~~
ui\app.py:359: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            file_menu.addAction(exit_action)
            ^~~~~~~~~~~~~~~~~~~
ui\app.py:361: error: Item "None" of "QMenuBar | None" has no attribute
"addMenu"  [union-attr]
            trading_menu = menubar.addMenu("&Trading")
                           ^~~~~~~~~~~~~~~
ui\app.py:365: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            trading_menu.addAction(connect_action)
            ^~~~~~~~~~~~~~~~~~~~~~
ui\app.py:367: error: Item "None" of "QMenu | Any | None" has no attribute
"addSeparator"  [union-attr]
            trading_menu.addSeparator()
            ^~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:385: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            trading_menu.addAction(self.paper_action)
            ^~~~~~~~~~~~~~~~~~~~~~
ui\app.py:386: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            trading_menu.addAction(self.live_action)
            ^~~~~~~~~~~~~~~~~~~~~~
ui\app.py:388: error: Item "None" of "QMenuBar | None" has no attribute
"addMenu"  [union-attr]
            ai_menu = menubar.addMenu("&AI Model")
                      ^~~~~~~~~~~~~~~
ui\app.py:393: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            ai_menu.addAction(train_action)
            ^~~~~~~~~~~~~~~~~
ui\app.py:397: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            ai_menu.addAction(auto_learn_action)
            ^~~~~~~~~~~~~~~~~
ui\app.py:401: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            ai_menu.addAction(strategy_market_action)
            ^~~~~~~~~~~~~~~~~
ui\app.py:403: error: Item "None" of "QMenu | Any | None" has no attribute
"addSeparator"  [union-attr]
            ai_menu.addSeparator()
            ^~~~~~~~~~~~~~~~~~~~
ui\app.py:407: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            ai_menu.addAction(backtest_action)
            ^~~~~~~~~~~~~~~~~
ui\app.py:409: error: Item "None" of "QMenuBar | None" has no attribute
"addMenu"  [union-attr]
            view_menu = menubar.addMenu("&View")
                        ^~~~~~~~~~~~~~~
ui\app.py:414: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            view_menu.addAction(refresh_action)
            ^~~~~~~~~~~~~~~~~~~
ui\app.py:416: error: Item "None" of "QMenuBar | None" has no attribute
"addMenu"  [union-attr]
            help_menu = menubar.addMenu("&Help")
                        ^~~~~~~~~~~~~~~
ui\app.py:420: error: Item "None" of "QMenu | Any | None" has no attribute
"addAction"  [union-attr]
            help_menu.addAction(about_action)
            ^~~~~~~~~~~~~~~~~~~
ui\app.py:430: error: "MainApp" has no attribute "_analyze_stock" 
[attr-defined]
            self.analyze_action.triggered.connect(self._analyze_stock)
                                                  ^~~~~~~~~~~~~~~~~~~
ui\app.py:444: error: "MainApp" has no attribute "_scan_stocks"  [attr-defined]
            scan_action.triggered.connect(self._scan_stocks)
                                          ^~~~~~~~~~~~~~~~~
ui\app.py:489: error: "MainApp" has no attribute "_analyze_stock" 
[attr-defined]
            self.stock_input.returnPressed.connect(self._analyze_stock)
                                                   ^~~~~~~~~~~~~~~~~~~
ui\app.py:552: error: Item "None" of "QHeaderView | None" has no attribute
"setSectionResizeMode"  [union-attr]
            table.horizontalHeader().setSectionResizeMode(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:555: error: Item "None" of "QHeaderView | None" has no attribute
"setVisible"  [union-attr]
            table.verticalHeader().setVisible(False)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:618: error: Incompatible types in assignment (expression has type
"QLabel", variable has type "SignalPanel")  [assignment]
                self.signal_panel = QLabel("Signal Panel")
                                    ^~~~~~~~~~~~~~~~~~~~~~
ui\app.py:638: error: Incompatible types in assignment (expression has type
"QLabel", variable has type "StockChart")  [assignment]
                self.chart = QLabel("Chart (charts module not found)")
                             ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:640: error: "StockChart" has no attribute "setAlignment" 
[attr-defined]
                self.chart.setAlignment(Qt.AlignmentFlag.AlignCenter)
                ^~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:789: error: "MainApp" has no attribute "_update_watchlist" 
[attr-defined]
            self.watchlist_timer.timeout.connect(self._update_watchlist)
                                                 ^~~~~~~~~~~~~~~~~~~~~~
ui\app.py:824: error: "MainApp" has no attribute "interval_combo" 
[attr-defined]
                self.interval_combo.blockSignals(True)
                ^~~~~~~~~~~~~~~~~~~
ui\app.py:826: error: "MainApp" has no attribute "interval_combo" 
[attr-defined]
                    self.interval_combo.setCurrentText(interval)
                    ^~~~~~~~~~~~~~~~~~~
ui\app.py:828: error: "MainApp" has no attribute "interval_combo" 
[attr-defined]
                    self.interval_combo.blockSignals(False)
                    ^~~~~~~~~~~~~~~~~~~
ui\app.py:830: error: "MainApp" has no attribute "forecast_spin" 
[attr-defined]
                self.forecast_spin.setValue(int(self.GUESS_FORECAST_BARS))
                ^~~~~~~~~~~~~~~~~~
ui\app.py:831: error: "MainApp" has no attribute "lookback_spin" 
[attr-defined]
                self.lookback_spin.setValue(self._recommended_lookback(int...
                ^~~~~~~~~~~~~~~~~~
ui\app.py:831: error: "MainApp" has no attribute "_recommended_lookback" 
[attr-defined]
                self.lookback_spin.setValue(self._recommended_lookback(int...
                                            ^~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:832: error: "MainApp" has no attribute "forecast_spin" 
[attr-defined]
                horizon = int(self.forecast_spin.value())
                              ^~~~~~~~~~~~~~~~~~
ui\app.py:835: error: "MainApp" has no attribute "capital_spin"  [attr-defined]
                    capital=self.capital_spin.value(),
                            ^~~~~~~~~~~~~~~~~
ui\app.py:840: error: "None" has no attribute "ensemble"  [attr-defined]
                if self.predictor.ensemble:
                   ^~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:841: error: "None" has no attribute "ensemble"  [attr-defined]
                    num_models = len(self.predictor.ensemble.models)
                                     ^~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:842: error: "MainApp" has no attribute "model_status"  [attr-defined]
                    self.model_status.setText(
                    ^~~~~~~~~~~~~~~~~
ui\app.py:845: error: "MainApp" has no attribute "model_status"  [attr-defined]
                    self.model_status.setStyleSheet(
                    ^~~~~~~~~~~~~~~~~
ui\app.py:851: error: "MainApp" has no attribute "_sync_ui_to_loaded_model" 
[attr-defined]
                    self._sync_ui_to_loaded_model(
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:856: error: "MainApp" has no attribute "_log_model_alignment_debug" 
[attr-defined]
                    self._log_model_alignment_debug(
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:861: error: "MainApp" has no attribute "_update_trained_stocks_ui" 
[attr-defined]
                    self._update_trained_stocks_ui()
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:864: error: "MainApp" has no attribute "model_status"  [attr-defined]
                    self.model_status.setText("Model: Not trained")
                    ^~~~~~~~~~~~~~~~~
ui\app.py:865: error: "MainApp" has no attribute "model_status"  [attr-defined]
                    self.model_status.setStyleSheet(
                    ^~~~~~~~~~~~~~~~~
ui\app.py:871: error: "MainApp" has no attribute "model_info"  [attr-defined]
                    self.model_info.setText(
                    ^~~~~~~~~~~~~~~
ui\app.py:874: error: "MainApp" has no attribute "_update_trained_stocks_ui" 
[attr-defined]
                    self._update_trained_stocks_ui([])
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:883: error: "MainApp" has no attribute "model_status"  [attr-defined]
                self.model_status.setText("Model: Error")
                ^~~~~~~~~~~~~~~~~
ui\app.py:884: error: "MainApp" has no attribute "model_status"  [attr-defined]
                self.model_status.setStyleSheet(
                ^~~~~~~~~~~~~~~~~
ui\app.py:890: error: "MainApp" has no attribute "_update_trained_stocks_ui" 
[attr-defined]
                self._update_trained_stocks_ui([])
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:896: error: Right operand of "and" is never evaluated  [unreachable]
            if self.predictor is not None and self.predictor.ensemble is n...
                                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~...
ui\app.py:897: error: Statement is unreachable  [unreachable]
                try:
                ^~~~
ui\app.py:972: error: "MainApp" has no attribute "forecast_spin" 
[attr-defined]
            horizon = self.forecast_spin.value()
                      ^~~~~~~~~~~~~~~~~~
ui\app.py:973: error: "MainApp" has no attribute "model_info"  [attr-defined]
            self.model_info.setText(f"Interval: {interval}, Horizon: {hori...
            ^~~~~~~~~~~~~~~
ui\app.py:974: error: "MainApp" has no attribute "_update_trained_stocks_ui" 
[attr-defined]
            self._update_trained_stocks_ui([])
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:976: error: "MainApp" has no attribute "lookback_spin" 
[attr-defined]
            self.lookback_spin.setValue(self._recommended_lookback(interva...
            ^~~~~~~~~~~~~~~~~~
ui\app.py:976: error: "MainApp" has no attribute "_recommended_lookback" 
[attr-defined]
            self.lookback_spin.setValue(self._recommended_lookback(interva...
                                        ^~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:980: error: "MainApp" has no attribute "_queue_history_refresh" 
[attr-defined]
            self._queue_history_refresh(self.stock_input.text(), interval)
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:994: error: Statement is unreachable  [unreachable]
                try:
                ^~~~
ui\app.py:1048: error: Right operand of "and" is never evaluated  [unreachable]
                self.executor
                ^~~~~~~~~~~~~
ui\app.py:1052: error: Statement is unreachable  [unreachable]
                self.executor.auto_trader.update_predictor(self.predictor)
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:1058: error: Right operand of "and" is never evaluated  [unreachable]
                and self.predictor.ensemble is not None
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:1060: error: Statement is unreachable  [unreachable]
                self.stock_input.setText(selected)
                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:1114: error: Returning Any from function declared to return
"list[dict[str, Any]]"  [no-any-return]
            return _load_chart_history_bars_impl(
            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:1300: error: "MainApp" has no attribute "_market_hours_text" 
[attr-defined]
            hours_text = self._market_hours_text()
                         ^~~~~~~~~~~~~~~~~~~~~~~
ui\app.py:1301: error: "MainApp" has no attribute "_shanghai_now" 
[attr-defined]
            now_sh = self._shanghai_now()
                     ^~~~~~~~~~~~~~~~~~
ui\app.py:1314: error: "MainApp" has no attribute "_next_market_open" 
[attr-defined]
                next_open = self._next_market_open(now_sh)
                            ^~~~~~~~~~~~~~~~~~~~~~
ui\__init__.py:6: error: Incompatible types in assignment (expression has type
"None", variable has type "type[MainApp]")  [assignment]
        MainApp = None
                  ^~~~
ui\__init__.py:7: error: Incompatible types in assignment (expression has type
"None", variable has type "Callable[[], None]")  [assignment]
        run_app = None
                  ^~~~
ui\__init__.py:12: error: Incompatible types in assignment (expression has type
"None", variable has type "type[StockChart]")  [assignment]
        StockChart = None
                     ^~~~
ui\__init__.py:17: error: Incompatible types in assignment (expression has type
"None", variable has type "type[AutoLearnDialog]")  [assignment]
        AutoLearnDialog = None
                          ^~~~
ui\__init__.py:18: error: Incompatible types in assignment (expression has type
"None", variable has type "Callable[[Any, list[str] | None], Any]") 
[assignment]
        show_auto_learn_dialog = None
                                 ^~~~
ui\__init__.py:23: error: Incompatible types in assignment (expression has type
"None", variable has type "type[SignalPanel]")  [assignment]
        SignalPanel = None
                      ^~~~
ui\__init__.py:24: error: Incompatible types in assignment (expression has type
"None", variable has type "type[PositionTable]")  [assignment]
        PositionTable = None
                        ^~~~
ui\__init__.py:25: error: Incompatible types in assignment (expression has type
"None", variable has type "type[LogWidget]")  [assignment]
        LogWidget = None
                    ^~~~
ui\__init__.py:30: error: Incompatible types in assignment (expression has type
"None", variable has type "type[TrainingDialog]")  [assignment]
        TrainingDialog = None
                         ^~~~
ui\__init__.py:31: error: Incompatible types in assignment (expression has type
"None", variable has type "type[BacktestDialog]")  [assignment]
        BacktestDialog = None
                         ^~~~
ui\__init__.py:36: error: Incompatible types in assignment (expression has type
"None", variable has type "type[NewsPanel]")  [assignment]
        NewsPanel = None
                    ^~~~
ui\__init__.py:41: error: Incompatible types in assignment (expression has type
"None", variable has type "type[StrategyMarketplaceDialog]")  [assignment]
        StrategyMarketplaceDialog = None
                                    ^~~~
tests\test_ui_session_cache_interval_guard.py:10: error: Function is missing a
type annotation for one or more arguments  [no-untyped-def]
        def append_bar(self, symbol, interval, bar) -> bool:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_session_cache_interval_guard.py:16: error: "type[MainApp]" has no
attribute "_persist_session_bar"  [attr-defined]
        _persist_session_bar = MainApp._persist_session_bar
                               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:29: error: "type[MainApp]" has no
attribute "_on_bar_ui"  [attr-defined]
        _on_bar_ui = MainApp._on_bar_ui
                     ^~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:32: error: "type[MainApp]" has no
attribute "_interval_token_from_seconds"  [attr-defined]
        _interval_token_from_seconds = MainApp._interval_token_from_second...
                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:33: error: "type[MainApp]" has no
attribute "_interval_seconds"  [attr-defined]
        _interval_seconds = MainApp._interval_seconds
                            ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:34: error: "type[MainApp]" has no
attribute "_bar_bucket_epoch"  [attr-defined]
        _bar_bucket_epoch = MainApp._bar_bucket_epoch
                            ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:35: error: "type[MainApp]" has no
attribute "_ts_to_epoch"  [attr-defined]
        _ts_to_epoch = MainApp._ts_to_epoch
                       ^~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:36: error: "type[MainApp]" has no
attribute "_epoch_to_iso"  [attr-defined]
        _epoch_to_iso = MainApp._epoch_to_iso
                        ^~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:37: error: "type[MainApp]" has no
attribute "_bar_safety_caps"  [attr-defined]
        _bar_safety_caps = MainApp._bar_safety_caps
                           ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:38: error: "type[MainApp]" has no
attribute "_sanitize_ohlc"  [attr-defined]
        _sanitize_ohlc = MainApp._sanitize_ohlc
                         ^~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:39: error: "type[MainApp]" has no
attribute "_is_intraday_day_boundary"  [attr-defined]
        _is_intraday_day_boundary = MainApp._is_intraday_day_boundary
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:40: error: "type[MainApp]" has no
attribute "_bar_trading_date"  [attr-defined]
        _bar_trading_date = MainApp._bar_trading_date
                            ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:41: error: "type[MainApp]" has no
attribute "_is_outlier_tick"  [attr-defined]
        _is_outlier_tick = MainApp._is_outlier_tick
                           ^~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:53: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _is_market_session_timestamp(_ts_raw, _interval: str) -> bool:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:61: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
        def _debug_console(*_args, **_kwargs) -> None:
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:65: error: Function is missing a type
annotation  [no-untyped-def]
        def _resolve_chart_prediction_series(*_args, **_kwargs):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_ui_bar_liquidity_fields.py:69: error: Function is missing a type
annotation  [no-untyped-def]
        def _render_chart_state(**kwargs):
        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_main_dependencies.py:8: error: Function is missing a type annotation
for one or more arguments  [no-untyped-def]
    def test_check_dependencies_gui_mode_skips_ml_stack(monkeypatch) -> No...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_main_dependencies.py:11: error: Function is missing a type
annotation  [no-untyped-def]
        def fake_find_spec(name):
        ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_main_dependencies.py:27: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_check_dependencies_ml_mode_requires_ml_stack(monkeypatch, cap...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_main_dependencies.py:28: error: Function is missing a type
annotation  [no-untyped-def]
        def fake_find_spec(name):
        ^~~~~~~~~~~~~~~~~~~~~~~~~
tests\test_main_dependencies.py:41: error: Function is missing a type
annotation for one or more arguments  [no-untyped-def]
    def test_check_dependencies_live_mode_requires_easytrader(monkeypatch,...
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~...
tests\test_main_dependencies.py:42: error: Function is missing a type
annotation  [no-untyped-def]
        def fake_find_spec(name):
        ^~~~~~~~~~~~~~~~~~~~~~~~~
